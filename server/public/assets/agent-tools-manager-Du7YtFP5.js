import{r,u as Z,j as e,an as E,ao as F,ap as D,aq as k,bM as I,I as p,Y as A,_ as $,$ as L,a0 as P,a1 as g,B as c,ag as q,Q as ee,p as M,C as se,a as ae,b as te,f as Q,d as le,c as ne,X as m,D as re,S as z,q as ie,W as oe}from"./index-B8YngC3q.js";import{W as f}from"./wrench-BbxwkvrI.js";import{P as ce}from"./play-DCfOixJ6.js";import{S as de}from"./square-pen-DC-d-6u8.js";import{T as he}from"./trash-2-CGUzT0Wa.js";function ge({agentId:n,isOpen:d,onClose:B}){const[h,O]=r.useState([]),[U,y]=r.useState(!1),[v,w]=r.useState(!1),[a,l]=r.useState(null),[x,V]=r.useState(""),[j,W]=r.useState(""),[N,C]=r.useState(null),{toast:i}=Z();r.useEffect(()=>{d&&n&&u()},[d,n]);const u=async()=>{y(!0);try{const s=await fetch(`/api/agents/management/${n}/tools`);if(!s.ok)throw new Error("Failed to load tools");const t=await s.json();O(t.tools||[])}catch{i({title:"Error",description:"Failed to load agent tools",variant:"destructive"})}finally{y(!1)}},H=async s=>{w(!0);try{const t=!h.find(K=>K.id===s.id),o=t?`/api/agents/management/${n}/tools`:`/api/agents/management/${n}/tools/${s.id}`;if(!(await fetch(o,{method:t?"POST":"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})).ok)throw new Error("Failed to save tool");await u(),l(null),i({title:"Success",description:`Tool ${t?"created":"updated"} successfully`})}catch{i({title:"Error",description:"Failed to save tool",variant:"destructive"})}finally{w(!1)}},J=async s=>{try{if(!(await fetch(`/api/agents/management/${n}/tools/${s}`,{method:"DELETE"})).ok)throw new Error("Failed to delete tool");await u(),i({title:"Success",description:"Tool deleted successfully"})}catch{i({title:"Error",description:"Failed to delete tool",variant:"destructive"})}},_=async(s,t={})=>{C(s);try{const o=await fetch(`/api/agents/management/${n}/tools/${s}/execute`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({parameters:t})});if(!o.ok)throw new Error("Failed to execute tool");const b=await o.json();return i({title:"Tool Executed",description:"Tool executed successfully"}),await u(),b}catch{i({title:"Execution Failed",description:"Failed to execute tool",variant:"destructive"})}finally{C(null)}},T=()=>{const s={id:`tool_${Date.now()}`,name:"",description:"",type:"function",category:"general",parameters:{},enabled:!0};l(s)},S=h.filter(s=>{const t=!x||s.name.toLowerCase().includes(x.toLowerCase())||s.description.toLowerCase().includes(x.toLowerCase()),o=!j||s.category===j;return t&&o}),R=Array.from(new Set(h.map(s=>s.category))),X=[{value:"api",label:"API Call"},{value:"function",label:"Function"},{value:"query",label:"Query"},{value:"analysis",label:"Analysis"}],Y=s=>{switch(s){case"api":return e.jsx(oe,{className:"h-4 w-4"});case"function":return e.jsx(f,{className:"h-4 w-4"});case"query":return e.jsx(z,{className:"h-4 w-4"});case"analysis":return e.jsx(ie,{className:"h-4 w-4"});default:return e.jsx(z,{className:"h-4 w-4"})}},G=s=>s?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800";return d?e.jsx(E,{open:d,onOpenChange:B,children:e.jsxs(F,{className:"max-w-6xl max-h-[90vh] overflow-hidden",children:[e.jsxs(D,{children:[e.jsxs(k,{className:"flex items-center gap-2",children:[e.jsx(f,{className:"h-5 w-5"}),"Agent Tools Manager - ",n]}),e.jsx(I,{children:"Manage tools and capabilities for this agent"})]}),e.jsxs("div",{className:"flex flex-col h-full max-h-[calc(90vh-140px)]",children:[e.jsxs("div",{className:"flex gap-4 p-4 border-b",children:[e.jsx("div",{className:"flex-1",children:e.jsx(p,{placeholder:"Search tools...",value:x,onChange:s=>V(s.target.value)})}),e.jsxs(A,{value:j,onValueChange:W,children:[e.jsx($,{className:"w-48",children:e.jsx(L,{placeholder:"Filter by category"})}),e.jsxs(P,{children:[e.jsx(g,{value:"",children:"All Categories"}),R.map(s=>e.jsx(g,{value:s,children:s},s))]})]}),e.jsxs(c,{onClick:T,children:[e.jsx(q,{className:"h-4 w-4 mr-2"}),"Add Tool"]})]}),e.jsx(ee,{className:"flex-1 p-4",children:U?e.jsxs("div",{className:"flex items-center justify-center h-32",children:[e.jsx(M,{className:"h-6 w-6 animate-spin mr-2"}),"Loading tools..."]}):S.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(f,{className:"h-12 w-12 mx-auto text-gray-400 mb-4"}),e.jsx("p",{className:"text-gray-600",children:"No tools found"}),e.jsxs(c,{onClick:T,className:"mt-4",children:[e.jsx(q,{className:"h-4 w-4 mr-2"}),"Add First Tool"]})]}):e.jsx("div",{className:"grid gap-4",children:S.map(s=>e.jsxs(se,{children:[e.jsx(ae,{className:"pb-3",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[Y(s.type),e.jsx(te,{className:"text-lg",children:s.name}),e.jsx(Q,{className:G(s.enabled),children:s.enabled?"Enabled":"Disabled"}),e.jsx(Q,{variant:"outline",children:s.type})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(c,{variant:"outline",size:"sm",onClick:()=>_(s.id),disabled:!s.enabled||N===s.id,children:N===s.id?e.jsx(M,{className:"h-4 w-4 animate-spin"}):e.jsx(ce,{className:"h-4 w-4"})}),e.jsx(c,{variant:"outline",size:"sm",onClick:()=>l(s),children:e.jsx(de,{className:"h-4 w-4"})}),e.jsx(c,{variant:"outline",size:"sm",onClick:()=>J(s.id),children:e.jsx(he,{className:"h-4 w-4"})})]})]})}),e.jsxs(le,{children:[e.jsx(ne,{className:"mb-2",children:s.description}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[e.jsxs("span",{children:["Category: ",s.category]}),s.executionCount&&e.jsxs("span",{children:["Executions: ",s.executionCount]}),s.lastUsed&&e.jsxs("span",{children:["Last used: ",new Date(s.lastUsed).toLocaleDateString()]})]})]})]},s.id))})})]}),a&&e.jsx(E,{open:!0,onOpenChange:()=>l(null),children:e.jsxs(F,{className:"max-w-2xl",children:[e.jsx(D,{children:e.jsx(k,{children:h.find(s=>s.id===a.id)?"Edit Tool":"Add New Tool"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(m,{htmlFor:"name",children:"Tool Name"}),e.jsx(p,{id:"name",value:a.name,onChange:s=>l({...a,name:s.target.value}),placeholder:"Enter tool name"})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"type",children:"Tool Type"}),e.jsxs(A,{value:a.type,onValueChange:s=>l({...a,type:s}),children:[e.jsx($,{children:e.jsx(L,{})}),e.jsx(P,{children:X.map(s=>e.jsx(g,{value:s.value,children:s.label},s.value))})]})]})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"description",children:"Description"}),e.jsx(re,{id:"description",value:a.description,onChange:s=>l({...a,description:s.target.value}),placeholder:"Describe what this tool does",rows:3})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"category",children:"Category"}),e.jsx(p,{id:"category",value:a.category,onChange:s=>l({...a,category:s.target.value}),placeholder:"Enter category"})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(c,{variant:"outline",onClick:()=>l(null),children:"Cancel"}),e.jsx(c,{onClick:()=>H(a),disabled:v||!a.name,children:v?"Saving...":"Save Tool"})]})]})]})})]})}):null}export{ge as AgentToolsManager,ge as default};
