import{a4 as ie,r as n,u as le,j as e,an as V,ao as q,ap as _,aq as $,a3 as re,bM as ne,C as ce,d as de,X as r,o as oe,I as v,Y as p,_ as w,$ as N,a0 as y,a1 as c,B as m,ag as xe,f as C,D as H}from"./index-B8YngC3q.js";import{T as he,a as ue,b as P,c as x,d as me,e as h}from"./table-C1ejwt0U.js";import{S as U}from"./save-DK9PuBoI.js";import{S as je}from"./square-pen-DC-d-6u8.js";import{T as ge}from"./trash-2-CGUzT0Wa.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=ie("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);function Ce({agentType:d,isOpen:j,onClose:z}){var B,L,T;const[t,b]=n.useState(null),[M,Q]=n.useState(!1),[F,D]=n.useState(!1),[a,l]=n.useState(null),[o,R]=n.useState(""),[g,W]=n.useState(""),[f,J]=n.useState(""),[K,S]=n.useState(!1),{toast:k}=le();n.useEffect(()=>{j&&d&&X()},[j,d]);const X=async()=>{Q(!0);try{const s=await fetch(`/api/baseline-testing/baseline/${d}`);if(!s.ok)throw new Error("Failed to load baseline data");const i=await s.json();b(i)}catch{k({title:"Error",description:"Failed to load baseline data",variant:"destructive"})}finally{Q(!1)}},Y=async()=>{if(t){D(!0);try{if(!(await fetch(`/api/baseline-testing/baseline/${d}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).ok)throw new Error("Failed to save baseline data");k({title:"Success",description:"Baseline data saved successfully"}),S(!1)}catch{k({title:"Error",description:"Failed to save baseline data",variant:"destructive"})}finally{D(!1)}}},G=s=>{l({...s})},O=()=>{if(!a||!t)return;const s=t.questions.map(i=>i.id===a.id?a:i);b({...t,questions:s}),l(null),S(!0)},Z=()=>{const s={id:`new_${Date.now()}`,question:"",expectedAnswer:"",category:"general",difficulty:"basic",maxScore:10,keywords:[],tags:[]};l(s)},ee=s=>{if(!t)return;const i=t.questions.filter(u=>u.id!==s);b({...t,questions:i}),S(!0)},se=s=>{switch(s){case"basic":return"bg-green-100 text-green-800";case"intermediate":return"bg-yellow-100 text-yellow-800";case"advanced":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},A=((B=t==null?void 0:t.questions)==null?void 0:B.filter(s=>{var I;const i=!o||s.question.toLowerCase().includes(o.toLowerCase())||((I=s.expectedAnswer)==null?void 0:I.toLowerCase().includes(o.toLowerCase()))||s.id.toLowerCase().includes(o.toLowerCase()),u=!g||s.category===g,te=!f||s.difficulty===f;return i&&u&&te}))||[],E=Array.from(new Set(((L=t==null?void 0:t.questions)==null?void 0:L.map(s=>s.category))||[])),ae=["basic","intermediate","advanced"];return j?e.jsx(V,{open:j,onOpenChange:z,children:e.jsxs(q,{className:"max-w-7xl max-h-[90vh] overflow-hidden",children:[e.jsxs(_,{children:[e.jsxs($,{className:"flex items-center gap-2",children:[e.jsx(re,{className:"h-5 w-5"}),"Baseline Editor - ",d==null?void 0:d.replace("-agent","").toUpperCase()]}),e.jsx(ne,{children:"View and edit baseline questions for comprehensive agent testing"})]}),M?e.jsx("div",{className:"flex justify-center py-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Loading baseline data..."})]})}):t?e.jsxs("div",{className:"space-y-6 overflow-hidden",children:[e.jsx(ce,{children:e.jsxs(de,{className:"pt-6",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx(r,{className:"font-medium",children:"Agent Type"}),e.jsx("p",{className:"text-muted-foreground",children:t.agentType})]}),e.jsxs("div",{children:[e.jsx(r,{className:"font-medium",children:"Version"}),e.jsx("p",{className:"text-muted-foreground",children:t.version})]}),e.jsxs("div",{children:[e.jsx(r,{className:"font-medium",children:"Total Questions"}),e.jsx("p",{className:"text-muted-foreground",children:t.questions.length})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx(r,{className:"font-medium",children:"Description"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:t.description})]})]})}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(oe,{className:"h-4 w-4"}),e.jsx(v,{placeholder:"Search questions...",value:o,onChange:s=>R(s.target.value),className:"w-64"})]}),e.jsxs(p,{value:g,onValueChange:W,children:[e.jsxs(w,{className:"w-40",children:[e.jsx(fe,{className:"h-4 w-4 mr-2"}),e.jsx(N,{placeholder:"Category"})]}),e.jsxs(y,{children:[e.jsx(c,{value:"",children:"All Categories"}),E.map(s=>e.jsx(c,{value:s,children:s},s))]})]}),e.jsxs(p,{value:f,onValueChange:J,children:[e.jsx(w,{className:"w-40",children:e.jsx(N,{placeholder:"Difficulty"})}),e.jsxs(y,{children:[e.jsx(c,{value:"",children:"All Levels"}),ae.map(s=>e.jsx(c,{value:s,children:s.charAt(0).toUpperCase()+s.slice(1)},s))]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(m,{onClick:Z,variant:"outline",className:"gap-2",children:[e.jsx(xe,{className:"h-4 w-4"}),"Add Question"]}),K&&e.jsxs(m,{onClick:Y,disabled:F,className:"gap-2",children:[e.jsx(U,{className:"h-4 w-4"}),F?"Saving...":"Save Changes"]})]})]}),e.jsx("div",{className:"border rounded-lg overflow-hidden",children:e.jsx("div",{className:"max-h-96 overflow-y-auto",children:e.jsxs(he,{children:[e.jsx(ue,{className:"sticky top-0 bg-background",children:e.jsxs(P,{children:[e.jsx(x,{className:"w-20",children:"ID"}),e.jsx(x,{children:"Question"}),e.jsx(x,{className:"w-32",children:"Category"}),e.jsx(x,{className:"w-28",children:"Difficulty"}),e.jsx(x,{className:"w-20",children:"Score"}),e.jsx(x,{className:"w-32",children:"Actions"})]})}),e.jsx(me,{children:A.map(s=>e.jsxs(P,{children:[e.jsx(h,{className:"font-mono text-xs",children:s.id}),e.jsx(h,{children:e.jsxs("div",{className:"max-w-md",children:[e.jsx("p",{className:"text-sm line-clamp-2",children:s.question}),s.keywords&&s.keywords.length>0&&e.jsxs("div",{className:"flex gap-1 mt-1",children:[s.keywords.slice(0,3).map((i,u)=>e.jsx(C,{variant:"secondary",className:"text-xs",children:i},u)),s.keywords.length>3&&e.jsxs(C,{variant:"outline",className:"text-xs",children:["+",s.keywords.length-3]})]})]})}),e.jsx(h,{children:e.jsx(C,{variant:"outline",children:s.category})}),e.jsx(h,{children:e.jsx(C,{className:se(s.difficulty),children:s.difficulty})}),e.jsx(h,{children:s.maxScore}),e.jsx(h,{children:e.jsxs("div",{className:"flex gap-1",children:[e.jsx(m,{size:"sm",variant:"outline",onClick:()=>G(s),children:e.jsx(je,{className:"h-3 w-3"})}),e.jsx(m,{size:"sm",variant:"outline",onClick:()=>ee(s.id),children:e.jsx(ge,{className:"h-3 w-3"})})]})})]},s.id))})]})})}),A.length===0&&e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:o||g||f?"No questions match the current filters":"No questions found"})]}):e.jsx("div",{className:"text-center py-12 text-muted-foreground",children:"Failed to load baseline data"}),a&&e.jsx(V,{open:!!a,onOpenChange:()=>l(null),children:e.jsxs(q,{className:"max-w-2xl",children:[e.jsx(_,{children:e.jsx($,{children:a.id.startsWith("new_")?"Add New Question":"Edit Question"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(r,{htmlFor:"question-id",children:"Question ID"}),e.jsx(v,{id:"question-id",value:a.id,onChange:s=>l({...a,id:s.target.value}),disabled:!a.id.startsWith("new_")})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"question-text",children:"Question"}),e.jsx(H,{id:"question-text",value:a.question,onChange:s=>l({...a,question:s.target.value}),rows:3})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"expected-answer",children:"Expected Answer"}),e.jsx(H,{id:"expected-answer",value:a.expectedAnswer||"",onChange:s=>l({...a,expectedAnswer:s.target.value}),rows:4})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(r,{htmlFor:"category",children:"Category"}),e.jsxs(p,{value:a.category,onValueChange:s=>l({...a,category:s}),children:[e.jsx(w,{children:e.jsx(N,{})}),e.jsxs(y,{children:[E.map(s=>e.jsx(c,{value:s,children:s},s)),e.jsx(c,{value:"new-category",children:"+ Add New Category"})]})]})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"difficulty",children:"Difficulty"}),e.jsxs(p,{value:a.difficulty,onValueChange:s=>l({...a,difficulty:s}),children:[e.jsx(w,{children:e.jsx(N,{})}),e.jsxs(y,{children:[e.jsx(c,{value:"basic",children:"Basic"}),e.jsx(c,{value:"intermediate",children:"Intermediate"}),e.jsx(c,{value:"advanced",children:"Advanced"})]})]})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"max-score",children:"Max Score"}),e.jsx(v,{id:"max-score",type:"number",value:a.maxScore,onChange:s=>l({...a,maxScore:parseInt(s.target.value)||10})})]})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"keywords",children:"Keywords (comma-separated)"}),e.jsx(v,{id:"keywords",value:((T=a.keywords)==null?void 0:T.join(", "))||"",onChange:s=>l({...a,keywords:s.target.value.split(",").map(i=>i.trim()).filter(i=>i)})})]}),e.jsxs(m,{onClick:O,className:"w-full",children:[e.jsx(U,{className:"h-4 w-4 mr-2"}),"Save Question"]})]})]})})]})}):null}export{Ce as BaselineEditor};
