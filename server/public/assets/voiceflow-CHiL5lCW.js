import{aE as ie,cW as On,cX as Rt,cY as wt,cZ as vt,c_ as rr,ai as ir,r as z,j as E}from"./index-B8YngC3q.js";import{i as St}from"./value-DBNvDwBg.js";import{u as ar}from"./with-selector-BCKMo6pg.js";function cr(e){let t;for(;t=e.sourceEvent;)e=t;return e}function ae(e,t){if(e=cr(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var o=n.createSVGPoint();return o.x=e.clientX,o.y=e.clientY,o=o.matrixTransform(t.getScreenCTM().inverse()),[o.x,o.y]}if(t.getBoundingClientRect){var s=t.getBoundingClientRect();return[e.clientX-s.left-t.clientLeft,e.clientY-s.top-t.clientTop]}}return[e.pageX,e.pageY]}const lr={passive:!1},Re={capture:!0,passive:!1};function Et(e){e.stopImmediatePropagation()}function Ce(e){e.preventDefault(),e.stopImmediatePropagation()}function Yn(e){var t=e.document.documentElement,n=ie(e).on("dragstart.drag",Ce,Re);"onselectstart"in t?n.on("selectstart.drag",Ce,Re):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function Xn(e,t){var n=e.document.documentElement,o=ie(e).on("dragstart.drag",null);t&&(o.on("click.drag",Ce,Re),setTimeout(function(){o.on("click.drag",null)},0)),"onselectstart"in n?o.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const Ke=e=>()=>e;function Pt(e,{sourceEvent:t,subject:n,target:o,identifier:s,active:r,x:i,y:a,dx:l,dy:g,dispatch:u}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:o,enumerable:!0,configurable:!0},identifier:{value:s,enumerable:!0,configurable:!0},active:{value:r,enumerable:!0,configurable:!0},x:{value:i,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:g,enumerable:!0,configurable:!0},_:{value:u}})}Pt.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function ur(e){return!e.ctrlKey&&!e.button}function dr(){return this.parentNode}function fr(e,t){return t??{x:e.x,y:e.y}}function hr(){return navigator.maxTouchPoints||"ontouchstart"in this}function Gn(){var e=ur,t=dr,n=fr,o=hr,s={},r=On("start","drag","end"),i=0,a,l,g,u,d=0;function c(b){b.on("mousedown.drag",h).filter(o).on("touchstart.drag",w).on("touchmove.drag",p,lr).on("touchend.drag touchcancel.drag",N).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function h(b,v){if(!(u||!e.call(this,b,v))){var I=f(this,t.call(this,b,v),b,v,"mouse");I&&(ie(b.view).on("mousemove.drag",y,Re).on("mouseup.drag",m,Re),Yn(b.view),Et(b),g=!1,a=b.clientX,l=b.clientY,I("start",b))}}function y(b){if(Ce(b),!g){var v=b.clientX-a,I=b.clientY-l;g=v*v+I*I>d}s.mouse("drag",b)}function m(b){ie(b.view).on("mousemove.drag mouseup.drag",null),Xn(b.view,g),Ce(b),s.mouse("end",b)}function w(b,v){if(e.call(this,b,v)){var I=b.changedTouches,_=t.call(this,b,v),P=I.length,j,D;for(j=0;j<P;++j)(D=f(this,_,b,v,I[j].identifier,I[j]))&&(Et(b),D("start",b,I[j]))}}function p(b){var v=b.changedTouches,I=v.length,_,P;for(_=0;_<I;++_)(P=s[v[_].identifier])&&(Ce(b),P("drag",b,v[_]))}function N(b){var v=b.changedTouches,I=v.length,_,P;for(u&&clearTimeout(u),u=setTimeout(function(){u=null},500),_=0;_<I;++_)(P=s[v[_].identifier])&&(Et(b),P("end",b,v[_]))}function f(b,v,I,_,P,j){var D=r.copy(),$=ae(j||I,v),H,R,x;if((x=n.call(b,new Pt("beforestart",{sourceEvent:I,target:c,identifier:P,active:i,x:$[0],y:$[1],dx:0,dy:0,dispatch:D}),_))!=null)return H=x.x-$[0]||0,R=x.y-$[1]||0,function C(S,M,A){var k=$,T;switch(S){case"start":s[P]=C,T=i++;break;case"end":delete s[P],--i;case"drag":$=ae(A||M,v),T=i;break}D.call(S,b,new Pt(S,{sourceEvent:M,subject:x,target:c,identifier:P,active:T,x:$[0]+H,y:$[1]+R,dx:$[0]-k[0],dy:$[1]-k[1],dispatch:D}),_)}}return c.filter=function(b){return arguments.length?(e=typeof b=="function"?b:Ke(!!b),c):e},c.container=function(b){return arguments.length?(t=typeof b=="function"?b:Ke(b),c):t},c.subject=function(b){return arguments.length?(n=typeof b=="function"?b:Ke(b),c):n},c.touchable=function(b){return arguments.length?(o=typeof b=="function"?b:Ke(!!b),c):o},c.on=function(){var b=r.on.apply(r,arguments);return b===r?c:b},c.clickDistance=function(b){return arguments.length?(d=(b=+b)*b,c):Math.sqrt(d)},c}var gr=1e-12;function nn(e){return((e=Math.exp(e))+1/e)/2}function pr(e){return((e=Math.exp(e))-1/e)/2}function mr(e){return((e=Math.exp(2*e))-1)/(e+1)}const ot=function e(t,n,o){function s(r,i){var a=r[0],l=r[1],g=r[2],u=i[0],d=i[1],c=i[2],h=u-a,y=d-l,m=h*h+y*y,w,p;if(m<gr)p=Math.log(c/g)/t,w=function(_){return[a+_*h,l+_*y,g*Math.exp(t*_*p)]};else{var N=Math.sqrt(m),f=(c*c-g*g+o*m)/(2*g*n*N),b=(c*c-g*g-o*m)/(2*c*n*N),v=Math.log(Math.sqrt(f*f+1)-f),I=Math.log(Math.sqrt(b*b+1)-b);p=(I-v)/t,w=function(_){var P=_*p,j=nn(v),D=g/(n*N)*(j*mr(t*P+v)-pr(v));return[a+D*h,l+D*y,g*j/nn(t*P+v)]}}return w.duration=p*1e3*t/Math.SQRT2,w}return s.rho=function(r){var i=Math.max(.001,+r),a=i*i,l=a*a;return e(i,a,l)},s}(Math.SQRT2,2,4),Qe=e=>()=>e;function xr(e,{sourceEvent:t,target:n,transform:o,dispatch:s}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:o,enumerable:!0,configurable:!0},_:{value:s}})}function Nt(e){e.stopImmediatePropagation()}function je(e){e.preventDefault(),e.stopImmediatePropagation()}function yr(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function br(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function on(){return this.__zoom||Rt}function wr(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function vr(){return navigator.maxTouchPoints||"ontouchstart"in this}function Sr(e,t,n){var o=e.invertX(t[0][0])-n[0][0],s=e.invertX(t[1][0])-n[1][0],r=e.invertY(t[0][1])-n[0][1],i=e.invertY(t[1][1])-n[1][1];return e.translate(s>o?(o+s)/2:Math.min(0,o)||Math.max(0,s),i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i))}function Un(){var e=yr,t=br,n=Sr,o=wr,s=vr,r=[0,1/0],i=[[-1/0,-1/0],[1/0,1/0]],a=250,l=ot,g=On("start","zoom","end"),u,d,c,h=500,y=150,m=0,w=10;function p(x){x.property("__zoom",on).on("wheel.zoom",P,{passive:!1}).on("mousedown.zoom",j).on("dblclick.zoom",D).filter(s).on("touchstart.zoom",$).on("touchmove.zoom",H).on("touchend.zoom touchcancel.zoom",R).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}p.transform=function(x,C,S,M){var A=x.selection?x.selection():x;A.property("__zoom",on),x!==A?v(x,C,S,M):A.interrupt().each(function(){I(this,arguments).event(M).start().zoom(null,typeof C=="function"?C.apply(this,arguments):C).end()})},p.scaleBy=function(x,C,S,M){p.scaleTo(x,function(){var A=this.__zoom.k,k=typeof C=="function"?C.apply(this,arguments):C;return A*k},S,M)},p.scaleTo=function(x,C,S,M){p.transform(x,function(){var A=t.apply(this,arguments),k=this.__zoom,T=S==null?b(A):typeof S=="function"?S.apply(this,arguments):S,L=k.invert(T),B=typeof C=="function"?C.apply(this,arguments):C;return n(f(N(k,B),T,L),A,i)},S,M)},p.translateBy=function(x,C,S,M){p.transform(x,function(){return n(this.__zoom.translate(typeof C=="function"?C.apply(this,arguments):C,typeof S=="function"?S.apply(this,arguments):S),t.apply(this,arguments),i)},null,M)},p.translateTo=function(x,C,S,M,A){p.transform(x,function(){var k=t.apply(this,arguments),T=this.__zoom,L=M==null?b(k):typeof M=="function"?M.apply(this,arguments):M;return n(Rt.translate(L[0],L[1]).scale(T.k).translate(typeof C=="function"?-C.apply(this,arguments):-C,typeof S=="function"?-S.apply(this,arguments):-S),k,i)},M,A)};function N(x,C){return C=Math.max(r[0],Math.min(r[1],C)),C===x.k?x:new wt(C,x.x,x.y)}function f(x,C,S){var M=C[0]-S[0]*x.k,A=C[1]-S[1]*x.k;return M===x.x&&A===x.y?x:new wt(x.k,M,A)}function b(x){return[(+x[0][0]+ +x[1][0])/2,(+x[0][1]+ +x[1][1])/2]}function v(x,C,S,M){x.on("start.zoom",function(){I(this,arguments).event(M).start()}).on("interrupt.zoom end.zoom",function(){I(this,arguments).event(M).end()}).tween("zoom",function(){var A=this,k=arguments,T=I(A,k).event(M),L=t.apply(A,k),B=S==null?b(L):typeof S=="function"?S.apply(A,k):S,W=Math.max(L[1][0]-L[0][0],L[1][1]-L[0][1]),V=A.__zoom,X=typeof C=="function"?C.apply(A,k):C,G=l(V.invert(B).concat(W/V.k),X.invert(B).concat(W/X.k));return function(Y){if(Y===1)Y=X;else{var F=G(Y),U=W/F[2];Y=new wt(U,B[0]-F[0]*U,B[1]-F[1]*U)}T.zoom(null,Y)}})}function I(x,C,S){return!S&&x.__zooming||new _(x,C)}function _(x,C){this.that=x,this.args=C,this.active=0,this.sourceEvent=null,this.extent=t.apply(x,C),this.taps=0}_.prototype={event:function(x){return x&&(this.sourceEvent=x),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(x,C){return this.mouse&&x!=="mouse"&&(this.mouse[1]=C.invert(this.mouse[0])),this.touch0&&x!=="touch"&&(this.touch0[1]=C.invert(this.touch0[0])),this.touch1&&x!=="touch"&&(this.touch1[1]=C.invert(this.touch1[0])),this.that.__zoom=C,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(x){var C=ie(this.that).datum();g.call(x,this.that,new xr(x,{sourceEvent:this.sourceEvent,target:p,type:x,transform:this.that.__zoom,dispatch:g}),C)}};function P(x,...C){if(!e.apply(this,arguments))return;var S=I(this,C).event(x),M=this.__zoom,A=Math.max(r[0],Math.min(r[1],M.k*Math.pow(2,o.apply(this,arguments)))),k=ae(x);if(S.wheel)(S.mouse[0][0]!==k[0]||S.mouse[0][1]!==k[1])&&(S.mouse[1]=M.invert(S.mouse[0]=k)),clearTimeout(S.wheel);else{if(M.k===A)return;S.mouse=[k,M.invert(k)],vt(this),S.start()}je(x),S.wheel=setTimeout(T,y),S.zoom("mouse",n(f(N(M,A),S.mouse[0],S.mouse[1]),S.extent,i));function T(){S.wheel=null,S.end()}}function j(x,...C){if(c||!e.apply(this,arguments))return;var S=x.currentTarget,M=I(this,C,!0).event(x),A=ie(x.view).on("mousemove.zoom",B,!0).on("mouseup.zoom",W,!0),k=ae(x,S),T=x.clientX,L=x.clientY;Yn(x.view),Nt(x),M.mouse=[k,this.__zoom.invert(k)],vt(this),M.start();function B(V){if(je(V),!M.moved){var X=V.clientX-T,G=V.clientY-L;M.moved=X*X+G*G>m}M.event(V).zoom("mouse",n(f(M.that.__zoom,M.mouse[0]=ae(V,S),M.mouse[1]),M.extent,i))}function W(V){A.on("mousemove.zoom mouseup.zoom",null),Xn(V.view,M.moved),je(V),M.event(V).end()}}function D(x,...C){if(e.apply(this,arguments)){var S=this.__zoom,M=ae(x.changedTouches?x.changedTouches[0]:x,this),A=S.invert(M),k=S.k*(x.shiftKey?.5:2),T=n(f(N(S,k),M,A),t.apply(this,C),i);je(x),a>0?ie(this).transition().duration(a).call(v,T,M,x):ie(this).call(p.transform,T,M,x)}}function $(x,...C){if(e.apply(this,arguments)){var S=x.touches,M=S.length,A=I(this,C,x.changedTouches.length===M).event(x),k,T,L,B;for(Nt(x),T=0;T<M;++T)L=S[T],B=ae(L,this),B=[B,this.__zoom.invert(B),L.identifier],A.touch0?!A.touch1&&A.touch0[2]!==B[2]&&(A.touch1=B,A.taps=0):(A.touch0=B,k=!0,A.taps=1+!!u);u&&(u=clearTimeout(u)),k&&(A.taps<2&&(d=B[0],u=setTimeout(function(){u=null},h)),vt(this),A.start())}}function H(x,...C){if(this.__zooming){var S=I(this,C).event(x),M=x.changedTouches,A=M.length,k,T,L,B;for(je(x),k=0;k<A;++k)T=M[k],L=ae(T,this),S.touch0&&S.touch0[2]===T.identifier?S.touch0[0]=L:S.touch1&&S.touch1[2]===T.identifier&&(S.touch1[0]=L);if(T=S.that.__zoom,S.touch1){var W=S.touch0[0],V=S.touch0[1],X=S.touch1[0],G=S.touch1[1],Y=(Y=X[0]-W[0])*Y+(Y=X[1]-W[1])*Y,F=(F=G[0]-V[0])*F+(F=G[1]-V[1])*F;T=N(T,Math.sqrt(Y/F)),L=[(W[0]+X[0])/2,(W[1]+X[1])/2],B=[(V[0]+G[0])/2,(V[1]+G[1])/2]}else if(S.touch0)L=S.touch0[0],B=S.touch0[1];else return;S.zoom("touch",n(f(T,L,B),S.extent,i))}}function R(x,...C){if(this.__zooming){var S=I(this,C).event(x),M=x.changedTouches,A=M.length,k,T;for(Nt(x),c&&clearTimeout(c),c=setTimeout(function(){c=null},h),k=0;k<A;++k)T=M[k],S.touch0&&S.touch0[2]===T.identifier?delete S.touch0:S.touch1&&S.touch1[2]===T.identifier&&delete S.touch1;if(S.touch1&&!S.touch0&&(S.touch0=S.touch1,delete S.touch1),S.touch0)S.touch0[1]=this.__zoom.invert(S.touch0[0]);else if(S.end(),S.taps===2&&(T=ae(T,this),Math.hypot(d[0]-T[0],d[1]-T[1])<w)){var L=ie(this).on("dblclick.zoom");L&&L.apply(this,arguments)}}}return p.wheelDelta=function(x){return arguments.length?(o=typeof x=="function"?x:Qe(+x),p):o},p.filter=function(x){return arguments.length?(e=typeof x=="function"?x:Qe(!!x),p):e},p.touchable=function(x){return arguments.length?(s=typeof x=="function"?x:Qe(!!x),p):s},p.extent=function(x){return arguments.length?(t=typeof x=="function"?x:Qe([[+x[0][0],+x[0][1]],[+x[1][0],+x[1][1]]]),p):t},p.scaleExtent=function(x){return arguments.length?(r[0]=+x[0],r[1]=+x[1],p):[r[0],r[1]]},p.translateExtent=function(x){return arguments.length?(i[0][0]=+x[0][0],i[1][0]=+x[1][0],i[0][1]=+x[0][1],i[1][1]=+x[1][1],p):[[i[0][0],i[0][1]],[i[1][0],i[1][1]]]},p.constrain=function(x){return arguments.length?(n=x,p):n},p.duration=function(x){return arguments.length?(a=+x,p):a},p.interpolate=function(x){return arguments.length?(l=x,p):l},p.on=function(){var x=g.on.apply(g,arguments);return x===g?p:x},p.clickDistance=function(x){return arguments.length?(m=(x=+x)*x,p):Math.sqrt(m)},p.tapDistance=function(x){return arguments.length?(w=+x,p):w},p}function re(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,o;n<e.length;n++)(o=re(e[n]))!==""&&(t+=(t&&" ")+o);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}const ue={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,{id:t,sourceHandle:n,targetHandle:o})=>`Couldn't create edge for ${e} handle id: "${e==="source"?n:o}", edge id: ${t}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(e="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${e}/dist/style.css' or base.css to make sure everything is working properly.`,error014:()=>"useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID.",error015:()=>"It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs."},Le=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],qn=["Enter"," ","Escape"],Zn={"node.a11yDescription.default":"Press enter or space to select a node. Press delete to remove it and escape to cancel.","node.a11yDescription.keyboardDisabled":"Press enter or space to select a node. You can then use the arrow keys to move the node around. Press delete to remove it and escape to cancel.","node.a11yDescription.ariaLiveMessage":({direction:e,x:t,y:n})=>`Moved selected node ${e}. New position, x: ${t}, y: ${n}`,"edge.a11yDescription.default":"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel.","controls.ariaLabel":"Control Panel","controls.zoomIn.ariaLabel":"Zoom In","controls.zoomOut.ariaLabel":"Zoom Out","controls.fitView.ariaLabel":"Fit View","controls.interactive.ariaLabel":"Toggle Interactivity","minimap.ariaLabel":"Mini Map","handle.ariaLabel":"Handle"};var Me;(function(e){e.Strict="strict",e.Loose="loose"})(Me||(Me={}));var ye;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(ye||(ye={}));var De;(function(e){e.Partial="partial",e.Full="full"})(De||(De={}));const Kn={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null};var pe;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(pe||(pe={}));var st;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(st||(st={}));var O;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(O||(O={}));const sn={[O.Left]:O.Right,[O.Right]:O.Left,[O.Top]:O.Bottom,[O.Bottom]:O.Top};function Qn(e){return e===null?null:e?"valid":"invalid"}const Jn=e=>"id"in e&&"source"in e&&"target"in e,Er=e=>"id"in e&&"position"in e&&!("source"in e)&&!("target"in e),Lt=e=>"id"in e&&"internals"in e&&!("source"in e)&&!("target"in e),We=(e,t=[0,0])=>{const{width:n,height:o}=fe(e),s=e.origin??t,r=n*s[0],i=o*s[1];return{x:e.position.x-r,y:e.position.y-i}},Nr=(e,t={nodeOrigin:[0,0]})=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((o,s)=>{const r=typeof s=="string";let i=!t.nodeLookup&&!r?s:void 0;t.nodeLookup&&(i=r?t.nodeLookup.get(s):Lt(s)?s:t.nodeLookup.get(s.id));const a=i?rt(i,t.nodeOrigin):{x:0,y:0,x2:0,y2:0};return lt(o,a)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return ut(n)},Oe=(e,t={})=>{if(e.size===0)return{x:0,y:0,width:0,height:0};let n={x:1/0,y:1/0,x2:-1/0,y2:-1/0};return e.forEach(o=>{if(t.filter===void 0||t.filter(o)){const s=rt(o);n=lt(n,s)}}),ut(n)},Dt=(e,t,[n,o,s]=[0,0,1],r=!1,i=!1)=>{const a={...Ye(t,[n,o,s]),width:t.width/s,height:t.height/s},l=[];for(const g of e.values()){const{measured:u,selectable:d=!0,hidden:c=!1}=g;if(i&&!d||c)continue;const h=u.width??g.width??g.initialWidth??null,y=u.height??g.height??g.initialHeight??null,m=Be(a,Ie(g)),w=(h??0)*(y??0),p=r&&m>0;(!g.internals.handleBounds||p||m>=w||g.dragging)&&l.push(g)}return l},Cr=(e,t)=>{const n=new Set;return e.forEach(o=>{n.add(o.id)}),t.filter(o=>n.has(o.source)||n.has(o.target))};function Mr(e,t){const n=new Map,o=t!=null&&t.nodes?new Set(t.nodes.map(s=>s.id)):null;return e.forEach(s=>{s.measured.width&&s.measured.height&&((t==null?void 0:t.includeHiddenNodes)||!s.hidden)&&(!o||o.has(s.id))&&n.set(s.id,s)}),n}async function kr({nodes:e,width:t,height:n,panZoom:o,minZoom:s,maxZoom:r},i){if(e.size===0)return Promise.resolve(!0);const a=Mr(e,i),l=Oe(a),g=Bt(l,t,n,(i==null?void 0:i.minZoom)??s,(i==null?void 0:i.maxZoom)??r,(i==null?void 0:i.padding)??.1);return await o.setViewport(g,{duration:i==null?void 0:i.duration,ease:i==null?void 0:i.ease,interpolate:i==null?void 0:i.interpolate}),Promise.resolve(!0)}function eo({nodeId:e,nextPosition:t,nodeLookup:n,nodeOrigin:o=[0,0],nodeExtent:s,onError:r}){const i=n.get(e),a=i.parentId?n.get(i.parentId):void 0,{x:l,y:g}=a?a.internals.positionAbsolute:{x:0,y:0},u=i.origin??o;let d=i.extent||s;if(i.extent==="parent"&&!i.expandParent)if(!a)r==null||r("005",ue.error005());else{const h=a.measured.width,y=a.measured.height;h&&y&&(d=[[l,g],[l+h,g+y]])}else a&&_e(i.extent)&&(d=[[i.extent[0][0]+l,i.extent[0][1]+g],[i.extent[1][0]+l,i.extent[1][1]+g]]);const c=_e(d)?be(t,d,i.measured):t;return(i.measured.width===void 0||i.measured.height===void 0)&&(r==null||r("015",ue.error015())),{position:{x:c.x-l+(i.measured.width??0)*u[0],y:c.y-g+(i.measured.height??0)*u[1]},positionAbsolute:c}}async function Ir({nodesToRemove:e=[],edgesToRemove:t=[],nodes:n,edges:o,onBeforeDelete:s}){const r=new Set(e.map(c=>c.id)),i=[];for(const c of n){if(c.deletable===!1)continue;const h=r.has(c.id),y=!h&&c.parentId&&i.find(m=>m.id===c.parentId);(h||y)&&i.push(c)}const a=new Set(t.map(c=>c.id)),l=o.filter(c=>c.deletable!==!1),u=Cr(i,l);for(const c of l)a.has(c.id)&&!u.find(y=>y.id===c.id)&&u.push(c);if(!s)return{edges:u,nodes:i};const d=await s({nodes:i,edges:u});return typeof d=="boolean"?d?{edges:u,nodes:i}:{edges:[],nodes:[]}:d}const ke=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),be=(e={x:0,y:0},t,n)=>({x:ke(e.x,t[0][0],t[1][0]-((n==null?void 0:n.width)??0)),y:ke(e.y,t[0][1],t[1][1]-((n==null?void 0:n.height)??0))});function to(e,t,n){const{width:o,height:s}=fe(n),{x:r,y:i}=n.internals.positionAbsolute;return be(e,[[r,i],[r+o,i+s]],t)}const rn=(e,t,n)=>e<t?ke(Math.abs(e-t),1,t)/t:e>n?-ke(Math.abs(e-n),1,t)/t:0,no=(e,t,n=15,o=40)=>{const s=rn(e.x,o,t.width-o)*n,r=rn(e.y,o,t.height-o)*n;return[s,r]},lt=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),zt=({x:e,y:t,width:n,height:o})=>({x:e,y:t,x2:e+n,y2:t+o}),ut=({x:e,y:t,x2:n,y2:o})=>({x:e,y:t,width:n-e,height:o-t}),Ie=(e,t=[0,0])=>{var s,r;const{x:n,y:o}=Lt(e)?e.internals.positionAbsolute:We(e,t);return{x:n,y:o,width:((s=e.measured)==null?void 0:s.width)??e.width??e.initialWidth??0,height:((r=e.measured)==null?void 0:r.height)??e.height??e.initialHeight??0}},rt=(e,t=[0,0])=>{var s,r;const{x:n,y:o}=Lt(e)?e.internals.positionAbsolute:We(e,t);return{x:n,y:o,x2:n+(((s=e.measured)==null?void 0:s.width)??e.width??e.initialWidth??0),y2:o+(((r=e.measured)==null?void 0:r.height)??e.height??e.initialHeight??0)}},oo=(e,t)=>ut(lt(zt(e),zt(t))),Be=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),o=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*o)},an=e=>ce(e.width)&&ce(e.height)&&ce(e.x)&&ce(e.y),ce=e=>!isNaN(e)&&isFinite(e),_r=(e,t)=>{},dt=(e,t=[1,1])=>({x:t[0]*Math.round(e.x/t[0]),y:t[1]*Math.round(e.y/t[1])}),Ye=({x:e,y:t},[n,o,s],r=!1,i=[1,1])=>{const a={x:(e-n)/s,y:(t-o)/s};return r?dt(a,i):a},it=({x:e,y:t},[n,o,s])=>({x:e*s+n,y:t*s+o});function Se(e,t){if(typeof e=="number")return Math.floor((t-t/(1+e))*.5);if(typeof e=="string"&&e.endsWith("px")){const n=parseFloat(e);if(!Number.isNaN(n))return Math.floor(n)}if(typeof e=="string"&&e.endsWith("%")){const n=parseFloat(e);if(!Number.isNaN(n))return Math.floor(t*n*.01)}return console.error(`[React Flow] The padding value "${e}" is invalid. Please provide a number or a string with a valid unit (px or %).`),0}function Pr(e,t,n){if(typeof e=="string"||typeof e=="number"){const o=Se(e,n),s=Se(e,t);return{top:o,right:s,bottom:o,left:s,x:s*2,y:o*2}}if(typeof e=="object"){const o=Se(e.top??e.y??0,n),s=Se(e.bottom??e.y??0,n),r=Se(e.left??e.x??0,t),i=Se(e.right??e.x??0,t);return{top:o,right:i,bottom:s,left:r,x:r+i,y:o+s}}return{top:0,right:0,bottom:0,left:0,x:0,y:0}}function zr(e,t,n,o,s,r){const{x:i,y:a}=it(e,[t,n,o]),{x:l,y:g}=it({x:e.x+e.width,y:e.y+e.height},[t,n,o]),u=s-l,d=r-g;return{left:Math.floor(i),top:Math.floor(a),right:Math.floor(u),bottom:Math.floor(d)}}const Bt=(e,t,n,o,s,r)=>{const i=Pr(r,t,n),a=(t-i.x)/e.width,l=(n-i.y)/e.height,g=Math.min(a,l),u=ke(g,o,s),d=e.x+e.width/2,c=e.y+e.height/2,h=t/2-d*u,y=n/2-c*u,m=zr(e,h,y,u,t,n),w={left:Math.min(m.left-i.left,0),top:Math.min(m.top-i.top,0),right:Math.min(m.right-i.right,0),bottom:Math.min(m.bottom-i.bottom,0)};return{x:h-w.left+w.right,y:y-w.top+w.bottom,zoom:u}},at=()=>{var e;return typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0};function _e(e){return e!==void 0&&e!=="parent"}function fe(e){var t,n;return{width:((t=e.measured)==null?void 0:t.width)??e.width??e.initialWidth??0,height:((n=e.measured)==null?void 0:n.height)??e.height??e.initialHeight??0}}function so(e){var t,n;return(((t=e.measured)==null?void 0:t.width)??e.width??e.initialWidth)!==void 0&&(((n=e.measured)==null?void 0:n.height)??e.height??e.initialHeight)!==void 0}function ro(e,t={width:0,height:0},n,o,s){const r={...e},i=o.get(n);if(i){const a=i.origin||s;r.x+=i.internals.positionAbsolute.x-(t.width??0)*a[0],r.y+=i.internals.positionAbsolute.y-(t.height??0)*a[1]}return r}function cn(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function $r(){let e,t;return{promise:new Promise((o,s)=>{e=o,t=s}),resolve:e,reject:t}}function Ar(e){return{...Zn,...e||{}}}function He(e,{snapGrid:t=[0,0],snapToGrid:n=!1,transform:o,containerBounds:s}){const{x:r,y:i}=le(e),a=Ye({x:r-((s==null?void 0:s.left)??0),y:i-((s==null?void 0:s.top)??0)},o),{x:l,y:g}=n?dt(a,t):a;return{xSnapped:l,ySnapped:g,...a}}const Vt=e=>({width:e.offsetWidth,height:e.offsetHeight}),io=e=>{var t;return((t=e==null?void 0:e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},Tr=["INPUT","SELECT","TEXTAREA"];function ao(e){var o,s;const t=((s=(o=e.composedPath)==null?void 0:o.call(e))==null?void 0:s[0])||e.target;return(t==null?void 0:t.nodeType)!==1?!1:Tr.includes(t.nodeName)||t.hasAttribute("contenteditable")||!!t.closest(".nokey")}const co=e=>"clientX"in e,le=(e,t)=>{var r,i;const n=co(e),o=n?e.clientX:(r=e.touches)==null?void 0:r[0].clientX,s=n?e.clientY:(i=e.touches)==null?void 0:i[0].clientY;return{x:o-((t==null?void 0:t.left)??0),y:s-((t==null?void 0:t.top)??0)}},ln=(e,t,n,o,s)=>{const r=t.querySelectorAll(`.${e}`);return!r||!r.length?null:Array.from(r).map(i=>{const a=i.getBoundingClientRect();return{id:i.getAttribute("data-handleid"),type:e,nodeId:s,position:i.getAttribute("data-handlepos"),x:(a.left-n.left)/o,y:(a.top-n.top)/o,...Vt(i)}})};function lo({sourceX:e,sourceY:t,targetX:n,targetY:o,sourceControlX:s,sourceControlY:r,targetControlX:i,targetControlY:a}){const l=e*.125+s*.375+i*.375+n*.125,g=t*.125+r*.375+a*.375+o*.125,u=Math.abs(l-e),d=Math.abs(g-t);return[l,g,u,d]}function Je(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function un({pos:e,x1:t,y1:n,x2:o,y2:s,c:r}){switch(e){case O.Left:return[t-Je(t-o,r),n];case O.Right:return[t+Je(o-t,r),n];case O.Top:return[t,n-Je(n-s,r)];case O.Bottom:return[t,n+Je(s-n,r)]}}function uo({sourceX:e,sourceY:t,sourcePosition:n=O.Bottom,targetX:o,targetY:s,targetPosition:r=O.Top,curvature:i=.25}){const[a,l]=un({pos:n,x1:e,y1:t,x2:o,y2:s,c:i}),[g,u]=un({pos:r,x1:o,y1:s,x2:e,y2:t,c:i}),[d,c,h,y]=lo({sourceX:e,sourceY:t,targetX:o,targetY:s,sourceControlX:a,sourceControlY:l,targetControlX:g,targetControlY:u});return[`M${e},${t} C${a},${l} ${g},${u} ${o},${s}`,d,c,h,y]}function fo({sourceX:e,sourceY:t,targetX:n,targetY:o}){const s=Math.abs(n-e)/2,r=n<e?n+s:n-s,i=Math.abs(o-t)/2,a=o<t?o+i:o-i;return[r,a,s,i]}function jr({sourceNode:e,targetNode:t,selected:n=!1,zIndex:o,elevateOnSelect:s=!1}){if(o!==void 0)return o;const r=s&&n?1e3:0,i=Math.max(e.parentId?e.internals.z:0,t.parentId?t.internals.z:0);return r+i}function Hr({sourceNode:e,targetNode:t,width:n,height:o,transform:s}){const r=lt(rt(e),rt(t));r.x===r.x2&&(r.x2+=1),r.y===r.y2&&(r.y2+=1);const i={x:-s[0]/s[2],y:-s[1]/s[2],width:n/s[2],height:o/s[2]};return Be(i,ut(r))>0}const Rr=({source:e,sourceHandle:t,target:n,targetHandle:o})=>`xy-edge__${e}${t||""}-${n}${o||""}`,Lr=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),Dr=(e,t)=>{if(!e.source||!e.target)return t;let n;return Jn(e)?n={...e}:n={...e,id:Rr(e)},Lr(n,t)?t:(n.sourceHandle===null&&delete n.sourceHandle,n.targetHandle===null&&delete n.targetHandle,t.concat(n))};function ho({sourceX:e,sourceY:t,targetX:n,targetY:o}){const[s,r,i,a]=fo({sourceX:e,sourceY:t,targetX:n,targetY:o});return[`M ${e},${t}L ${n},${o}`,s,r,i,a]}const dn={[O.Left]:{x:-1,y:0},[O.Right]:{x:1,y:0},[O.Top]:{x:0,y:-1},[O.Bottom]:{x:0,y:1}},Br=({source:e,sourcePosition:t=O.Bottom,target:n})=>t===O.Left||t===O.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},fn=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function Vr({source:e,sourcePosition:t=O.Bottom,target:n,targetPosition:o=O.Top,center:s,offset:r,stepPosition:i}){const a=dn[t],l=dn[o],g={x:e.x+a.x*r,y:e.y+a.y*r},u={x:n.x+l.x*r,y:n.y+l.y*r},d=Br({source:g,sourcePosition:t,target:u}),c=d.x!==0?"x":"y",h=d[c];let y=[],m,w;const p={x:0,y:0},N={x:0,y:0},[,,f,b]=fo({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(a[c]*l[c]===-1){c==="x"?(m=s.x??g.x+(u.x-g.x)*i,w=s.y??(g.y+u.y)/2):(m=s.x??(g.x+u.x)/2,w=s.y??g.y+(u.y-g.y)*i);const I=[{x:m,y:g.y},{x:m,y:u.y}],_=[{x:g.x,y:w},{x:u.x,y:w}];a[c]===h?y=c==="x"?I:_:y=c==="x"?_:I}else{const I=[{x:g.x,y:u.y}],_=[{x:u.x,y:g.y}];if(c==="x"?y=a.x===h?_:I:y=a.y===h?I:_,t===o){const H=Math.abs(e[c]-n[c]);if(H<=r){const R=Math.min(r-1,r-H);a[c]===h?p[c]=(g[c]>e[c]?-1:1)*R:N[c]=(u[c]>n[c]?-1:1)*R}}if(t!==o){const H=c==="x"?"y":"x",R=a[c]===l[H],x=g[H]>u[H],C=g[H]<u[H];(a[c]===1&&(!R&&x||R&&C)||a[c]!==1&&(!R&&C||R&&x))&&(y=c==="x"?I:_)}const P={x:g.x+p.x,y:g.y+p.y},j={x:u.x+N.x,y:u.y+N.y},D=Math.max(Math.abs(P.x-y[0].x),Math.abs(j.x-y[0].x)),$=Math.max(Math.abs(P.y-y[0].y),Math.abs(j.y-y[0].y));D>=$?(m=(P.x+j.x)/2,w=y[0].y):(m=y[0].x,w=(P.y+j.y)/2)}return[[e,{x:g.x+p.x,y:g.y+p.y},...y,{x:u.x+N.x,y:u.y+N.y},n],m,w,f,b]}function Fr(e,t,n,o){const s=Math.min(fn(e,t)/2,fn(t,n)/2,o),{x:r,y:i}=t;if(e.x===r&&r===n.x||e.y===i&&i===n.y)return`L${r} ${i}`;if(e.y===i){const g=e.x<n.x?-1:1,u=e.y<n.y?1:-1;return`L ${r+s*g},${i}Q ${r},${i} ${r},${i+s*u}`}const a=e.x<n.x?1:-1,l=e.y<n.y?-1:1;return`L ${r},${i+s*l}Q ${r},${i} ${r+s*a},${i}`}function $t({sourceX:e,sourceY:t,sourcePosition:n=O.Bottom,targetX:o,targetY:s,targetPosition:r=O.Top,borderRadius:i=5,centerX:a,centerY:l,offset:g=20,stepPosition:u=.5}){const[d,c,h,y,m]=Vr({source:{x:e,y:t},sourcePosition:n,target:{x:o,y:s},targetPosition:r,center:{x:a,y:l},offset:g,stepPosition:u});return[d.reduce((p,N,f)=>{let b="";return f>0&&f<d.length-1?b=Fr(d[f-1],N,d[f+1],i):b=`${f===0?"M":"L"}${N.x} ${N.y}`,p+=b,p},""),c,h,y,m]}function hn(e){var t;return e&&!!(e.internals.handleBounds||(t=e.handles)!=null&&t.length)&&!!(e.measured.width||e.width||e.initialWidth)}function Wr(e){var d;const{sourceNode:t,targetNode:n}=e;if(!hn(t)||!hn(n))return null;const o=t.internals.handleBounds||gn(t.handles),s=n.internals.handleBounds||gn(n.handles),r=pn((o==null?void 0:o.source)??[],e.sourceHandle),i=pn(e.connectionMode===Me.Strict?(s==null?void 0:s.target)??[]:((s==null?void 0:s.target)??[]).concat((s==null?void 0:s.source)??[]),e.targetHandle);if(!r||!i)return(d=e.onError)==null||d.call(e,"008",ue.error008(r?"target":"source",{id:e.id,sourceHandle:e.sourceHandle,targetHandle:e.targetHandle})),null;const a=(r==null?void 0:r.position)||O.Bottom,l=(i==null?void 0:i.position)||O.Top,g=Ve(t,r,a),u=Ve(n,i,l);return{sourceX:g.x,sourceY:g.y,targetX:u.x,targetY:u.y,sourcePosition:a,targetPosition:l}}function gn(e){if(!e)return null;const t=[],n=[];for(const o of e)o.width=o.width??1,o.height=o.height??1,o.type==="source"?t.push(o):o.type==="target"&&n.push(o);return{source:t,target:n}}function Ve(e,t,n=O.Left,o=!1){const s=((t==null?void 0:t.x)??0)+e.internals.positionAbsolute.x,r=((t==null?void 0:t.y)??0)+e.internals.positionAbsolute.y,{width:i,height:a}=t??fe(e);if(o)return{x:s+i/2,y:r+a/2};switch((t==null?void 0:t.position)??n){case O.Top:return{x:s+i/2,y:r};case O.Right:return{x:s+i,y:r+a/2};case O.Bottom:return{x:s+i/2,y:r+a};case O.Left:return{x:s,y:r+a/2}}}function pn(e,t){return e&&(t?e.find(n=>n.id===t):e[0])||null}function At(e,t){return e?typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(o=>`${o}=${e[o]}`).join("&")}`:""}function Or(e,{id:t,defaultColor:n,defaultMarkerStart:o,defaultMarkerEnd:s}){const r=new Set;return e.reduce((i,a)=>([a.markerStart||o,a.markerEnd||s].forEach(l=>{if(l&&typeof l=="object"){const g=At(l,t);r.has(g)||(i.push({id:g,color:l.color||n,...l}),r.add(g))}}),i),[]).sort((i,a)=>i.id.localeCompare(a.id))}const Ft={nodeOrigin:[0,0],nodeExtent:Le,elevateNodesOnSelect:!0,defaults:{}},Yr={...Ft,checkEquality:!0};function Wt(e,t){const n={...e};for(const o in t)t[o]!==void 0&&(n[o]=t[o]);return n}function Xr(e,t,n){const o=Wt(Ft,n);for(const s of e.values())if(s.parentId)Ot(s,e,t,o);else{const r=We(s,o.nodeOrigin),i=_e(s.extent)?s.extent:o.nodeExtent,a=be(r,i,fe(s));s.internals.positionAbsolute=a}}function Tt(e,t,n,o){var l,g;const s=Wt(Yr,o);let r=e.length>0;const i=new Map(t),a=s!=null&&s.elevateNodesOnSelect?1e3:0;t.clear(),n.clear();for(const u of e){let d=i.get(u.id);if(s.checkEquality&&u===(d==null?void 0:d.internals.userNode))t.set(u.id,d);else{const c=We(u,s.nodeOrigin),h=_e(u.extent)?u.extent:s.nodeExtent,y=be(c,h,fe(u));d={...s.defaults,...u,measured:{width:(l=u.measured)==null?void 0:l.width,height:(g=u.measured)==null?void 0:g.height},internals:{positionAbsolute:y,handleBounds:u.measured?d==null?void 0:d.internals.handleBounds:void 0,z:go(u,a),userNode:u}},t.set(u.id,d)}(d.measured===void 0||d.measured.width===void 0||d.measured.height===void 0)&&!d.hidden&&(r=!1),u.parentId&&Ot(d,t,n,o)}return r}function Gr(e,t){if(!e.parentId)return;const n=t.get(e.parentId);n?n.set(e.id,e):t.set(e.parentId,new Map([[e.id,e]]))}function Ot(e,t,n,o){const{elevateNodesOnSelect:s,nodeOrigin:r,nodeExtent:i}=Wt(Ft,o),a=e.parentId,l=t.get(a);if(!l){console.warn(`Parent node ${a} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}Gr(e,n);const g=s?1e3:0,{x:u,y:d,z:c}=Ur(e,l,r,i,g),{positionAbsolute:h}=e.internals,y=u!==h.x||d!==h.y;(y||c!==e.internals.z)&&t.set(e.id,{...e,internals:{...e.internals,positionAbsolute:y?{x:u,y:d}:h,z:c}})}function go(e,t){return(ce(e.zIndex)?e.zIndex:0)+(e.selected?t:0)}function Ur(e,t,n,o,s){const{x:r,y:i}=t.internals.positionAbsolute,a=fe(e),l=We(e,n),g=_e(e.extent)?be(l,e.extent,a):l;let u=be({x:r+g.x,y:i+g.y},o,a);e.extent==="parent"&&(u=to(u,a,t));const d=go(e,s),c=t.internals.z??0;return{x:u.x,y:u.y,z:c>=d?c+1:d}}function Yt(e,t,n,o=[0,0]){var i;const s=[],r=new Map;for(const a of e){const l=t.get(a.parentId);if(!l)continue;const g=((i=r.get(a.parentId))==null?void 0:i.expandedRect)??Ie(l),u=oo(g,a.rect);r.set(a.parentId,{expandedRect:u,parent:l})}return r.size>0&&r.forEach(({expandedRect:a,parent:l},g)=>{var f;const u=l.internals.positionAbsolute,d=fe(l),c=l.origin??o,h=a.x<u.x?Math.round(Math.abs(u.x-a.x)):0,y=a.y<u.y?Math.round(Math.abs(u.y-a.y)):0,m=Math.max(d.width,Math.round(a.width)),w=Math.max(d.height,Math.round(a.height)),p=(m-d.width)*c[0],N=(w-d.height)*c[1];(h>0||y>0||p||N)&&(s.push({id:g,type:"position",position:{x:l.position.x-h+p,y:l.position.y-y+N}}),(f=n.get(g))==null||f.forEach(b=>{e.some(v=>v.id===b.id)||s.push({id:b.id,type:"position",position:{x:b.position.x+h,y:b.position.y+y}})})),(d.width<a.width||d.height<a.height||h||y)&&s.push({id:g,type:"dimensions",setAttributes:!0,dimensions:{width:m+(h?c[0]*h-p:0),height:w+(y?c[1]*y-N:0)}})}),s}function qr(e,t,n,o,s,r){const i=o==null?void 0:o.querySelector(".xyflow__viewport");let a=!1;if(!i)return{changes:[],updatedInternals:a};const l=[],g=window.getComputedStyle(i),{m22:u}=new window.DOMMatrixReadOnly(g.transform),d=[];for(const c of e.values()){const h=t.get(c.id);if(!h)continue;if(h.hidden){t.set(h.id,{...h,internals:{...h.internals,handleBounds:void 0}}),a=!0;continue}const y=Vt(c.nodeElement),m=h.measured.width!==y.width||h.measured.height!==y.height;if(!!(y.width&&y.height&&(m||!h.internals.handleBounds||c.force))){const p=c.nodeElement.getBoundingClientRect(),N=_e(h.extent)?h.extent:r;let{positionAbsolute:f}=h.internals;h.parentId&&h.extent==="parent"?f=to(f,y,t.get(h.parentId)):N&&(f=be(f,N,y));const b={...h,measured:y,internals:{...h.internals,positionAbsolute:f,handleBounds:{source:ln("source",c.nodeElement,p,u,h.id),target:ln("target",c.nodeElement,p,u,h.id)}}};t.set(h.id,b),h.parentId&&Ot(b,t,n,{nodeOrigin:s}),a=!0,m&&(l.push({id:h.id,type:"dimensions",dimensions:y}),h.expandParent&&h.parentId&&d.push({id:h.id,parentId:h.parentId,rect:Ie(b,s)}))}}if(d.length>0){const c=Yt(d,t,n,s);l.push(...c)}return{changes:l,updatedInternals:a}}async function Zr({delta:e,panZoom:t,transform:n,translateExtent:o,width:s,height:r}){if(!t||!e.x&&!e.y)return Promise.resolve(!1);const i=await t.setViewportConstrained({x:n[0]+e.x,y:n[1]+e.y,zoom:n[2]},[[0,0],[s,r]],o),a=!!i&&(i.x!==n[0]||i.y!==n[1]||i.k!==n[2]);return Promise.resolve(a)}function mn(e,t,n,o,s,r){let i=s;const a=o.get(i)||new Map;o.set(i,a.set(n,t)),i=`${s}-${e}`;const l=o.get(i)||new Map;if(o.set(i,l.set(n,t)),r){i=`${s}-${e}-${r}`;const g=o.get(i)||new Map;o.set(i,g.set(n,t))}}function po(e,t,n){e.clear(),t.clear();for(const o of n){const{source:s,target:r,sourceHandle:i=null,targetHandle:a=null}=o,l={edgeId:o.id,source:s,target:r,sourceHandle:i,targetHandle:a},g=`${s}-${i}--${r}-${a}`,u=`${r}-${a}--${s}-${i}`;mn("source",l,u,e,s,i),mn("target",l,g,e,r,a),t.set(o.id,o)}}function mo(e,t){if(!e.parentId)return!1;const n=t.get(e.parentId);return n?n.selected?!0:mo(n,t):!1}function xn(e,t,n){var s;let o=e;do{if((s=o==null?void 0:o.matches)!=null&&s.call(o,t))return!0;if(o===n)return!1;o=o==null?void 0:o.parentElement}while(o);return!1}function Kr(e,t,n,o){const s=new Map;for(const[r,i]of e)if((i.selected||i.id===o)&&(!i.parentId||!mo(i,e))&&(i.draggable||t&&typeof i.draggable>"u")){const a=e.get(r);a&&s.set(r,{id:r,position:a.position||{x:0,y:0},distance:{x:n.x-a.internals.positionAbsolute.x,y:n.y-a.internals.positionAbsolute.y},extent:a.extent,parentId:a.parentId,origin:a.origin,expandParent:a.expandParent,internals:{positionAbsolute:a.internals.positionAbsolute||{x:0,y:0}},measured:{width:a.measured.width??0,height:a.measured.height??0}})}return s}function Ct({nodeId:e,dragItems:t,nodeLookup:n,dragging:o=!0}){var i,a,l;const s=[];for(const[g,u]of t){const d=(i=n.get(g))==null?void 0:i.internals.userNode;d&&s.push({...d,position:u.position,dragging:o})}if(!e)return[s[0],s];const r=(a=n.get(e))==null?void 0:a.internals.userNode;return[r?{...r,position:((l=t.get(e))==null?void 0:l.position)||r.position,dragging:o}:s[0],s]}function Qr({onNodeMouseDown:e,getStoreItems:t,onDragStart:n,onDrag:o,onDragStop:s}){let r={x:null,y:null},i=0,a=new Map,l=!1,g={x:0,y:0},u=null,d=!1,c=null,h=!1,y=!1;function m({noDragClassName:p,handleSelector:N,domNode:f,isSelectable:b,nodeId:v,nodeClickDistance:I=0}){c=ie(f);function _({x:$,y:H},R){const{nodeLookup:x,nodeExtent:C,snapGrid:S,snapToGrid:M,nodeOrigin:A,onNodeDrag:k,onSelectionDrag:T,onError:L,updateNodePositions:B}=t();r={x:$,y:H};let W=!1,V={x:0,y:0,x2:0,y2:0};if(a.size>1&&C){const X=Oe(a);V=zt(X)}for(const[X,G]of a){if(!x.has(X))continue;let Y={x:$-G.distance.x,y:H-G.distance.y};M&&(Y=dt(Y,S));let F=[[C[0][0],C[0][1]],[C[1][0],C[1][1]]];if(a.size>1&&C&&!G.extent){const{positionAbsolute:Q}=G.internals,q=Q.x-V.x+C[0][0],K=Q.x+G.measured.width-V.x2+C[1][0],Z=Q.y-V.y+C[0][1],te=Q.y+G.measured.height-V.y2+C[1][1];F=[[q,Z],[K,te]]}const{position:U,positionAbsolute:ee}=eo({nodeId:X,nextPosition:Y,nodeLookup:x,nodeExtent:F,nodeOrigin:A,onError:L});W=W||G.position.x!==U.x||G.position.y!==U.y,G.position=U,G.internals.positionAbsolute=ee}if(y=y||W,!!W&&(B(a,!0),R&&(o||k||!v&&T))){const[X,G]=Ct({nodeId:v,dragItems:a,nodeLookup:x});o==null||o(R,a,X,G),k==null||k(R,X,G),v||T==null||T(R,G)}}async function P(){if(!u)return;const{transform:$,panBy:H,autoPanSpeed:R,autoPanOnNodeDrag:x}=t();if(!x){l=!1,cancelAnimationFrame(i);return}const[C,S]=no(g,u,R);(C!==0||S!==0)&&(r.x=(r.x??0)-C/$[2],r.y=(r.y??0)-S/$[2],await H({x:C,y:S})&&_(r,null)),i=requestAnimationFrame(P)}function j($){var W;const{nodeLookup:H,multiSelectionActive:R,nodesDraggable:x,transform:C,snapGrid:S,snapToGrid:M,selectNodesOnDrag:A,onNodeDragStart:k,onSelectionDragStart:T,unselectNodesAndEdges:L}=t();d=!0,(!A||!b)&&!R&&v&&((W=H.get(v))!=null&&W.selected||L()),b&&A&&v&&(e==null||e(v));const B=He($.sourceEvent,{transform:C,snapGrid:S,snapToGrid:M,containerBounds:u});if(r=B,a=Kr(H,x,B,v),a.size>0&&(n||k||!v&&T)){const[V,X]=Ct({nodeId:v,dragItems:a,nodeLookup:H});n==null||n($.sourceEvent,a,V,X),k==null||k($.sourceEvent,V,X),v||T==null||T($.sourceEvent,X)}}const D=Gn().clickDistance(I).on("start",$=>{const{domNode:H,nodeDragThreshold:R,transform:x,snapGrid:C,snapToGrid:S}=t();u=(H==null?void 0:H.getBoundingClientRect())||null,h=!1,y=!1,R===0&&j($),r=He($.sourceEvent,{transform:x,snapGrid:C,snapToGrid:S,containerBounds:u}),g=le($.sourceEvent,u)}).on("drag",$=>{const{autoPanOnNodeDrag:H,transform:R,snapGrid:x,snapToGrid:C,nodeDragThreshold:S,nodeLookup:M}=t(),A=He($.sourceEvent,{transform:R,snapGrid:x,snapToGrid:C,containerBounds:u});if(($.sourceEvent.type==="touchmove"&&$.sourceEvent.touches.length>1||v&&!M.has(v))&&(h=!0),!h){if(!l&&H&&d&&(l=!0,P()),!d){const k=A.xSnapped-(r.x??0),T=A.ySnapped-(r.y??0);Math.sqrt(k*k+T*T)>S&&j($)}(r.x!==A.xSnapped||r.y!==A.ySnapped)&&a&&d&&(g=le($.sourceEvent,u),_(A,$.sourceEvent))}}).on("end",$=>{if(!(!d||h)&&(l=!1,d=!1,cancelAnimationFrame(i),a.size>0)){const{nodeLookup:H,updateNodePositions:R,onNodeDragStop:x,onSelectionDragStop:C}=t();if(y&&(R(a,!1),y=!1),s||x||!v&&C){const[S,M]=Ct({nodeId:v,dragItems:a,nodeLookup:H,dragging:!1});s==null||s($.sourceEvent,a,S,M),x==null||x($.sourceEvent,S,M),v||C==null||C($.sourceEvent,M)}}}).filter($=>{const H=$.target;return!$.button&&(!p||!xn(H,`.${p}`,f))&&(!N||xn(H,N,f))});c.call(D)}function w(){c==null||c.on(".drag",null)}return{update:m,destroy:w}}function Jr(e,t,n){const o=[],s={x:e.x-n,y:e.y-n,width:n*2,height:n*2};for(const r of t.values())Be(s,Ie(r))>0&&o.push(r);return o}const ei=250;function ti(e,t,n,o){var a,l;let s=[],r=1/0;const i=Jr(e,n,t+ei);for(const g of i){const u=[...((a=g.internals.handleBounds)==null?void 0:a.source)??[],...((l=g.internals.handleBounds)==null?void 0:l.target)??[]];for(const d of u){if(o.nodeId===d.nodeId&&o.type===d.type&&o.id===d.id)continue;const{x:c,y:h}=Ve(g,d,d.position,!0),y=Math.sqrt(Math.pow(c-e.x,2)+Math.pow(h-e.y,2));y>t||(y<r?(s=[{...d,x:c,y:h}],r=y):y===r&&s.push({...d,x:c,y:h}))}}if(!s.length)return null;if(s.length>1){const g=o.type==="source"?"target":"source";return s.find(u=>u.type===g)??s[0]}return s[0]}function xo(e,t,n,o,s,r=!1){var g,u,d;const i=o.get(e);if(!i)return null;const a=s==="strict"?(g=i.internals.handleBounds)==null?void 0:g[t]:[...((u=i.internals.handleBounds)==null?void 0:u.source)??[],...((d=i.internals.handleBounds)==null?void 0:d.target)??[]],l=(n?a==null?void 0:a.find(c=>c.id===n):a==null?void 0:a[0])??null;return l&&r?{...l,...Ve(i,l,l.position,!0)}:l}function yo(e,t){return e||(t!=null&&t.classList.contains("target")?"target":t!=null&&t.classList.contains("source")?"source":null)}function ni(e,t){let n=null;return t?n=!0:e&&!t&&(n=!1),n}const bo=()=>!0;function oi(e,{connectionMode:t,connectionRadius:n,handleId:o,nodeId:s,edgeUpdaterType:r,isTarget:i,domNode:a,nodeLookup:l,lib:g,autoPanOnConnect:u,flowId:d,panBy:c,cancelConnection:h,onConnectStart:y,onConnect:m,onConnectEnd:w,isValidConnection:p=bo,onReconnectEnd:N,updateConnection:f,getTransform:b,getFromHandle:v,autoPanSpeed:I,dragThreshold:_=1}){const P=io(e.target);let j=0,D;const{x:$,y:H}=le(e),R=P==null?void 0:P.elementFromPoint($,H),x=yo(r,R),C=a==null?void 0:a.getBoundingClientRect();let S=!1;if(!C||!x)return;const M=xo(s,x,o,l,t);if(!M)return;let A=le(e,C),k=!1,T=null,L=!1,B=null;function W(){if(!u||!C)return;const[Q,q]=no(A,C,I);c({x:Q,y:q}),j=requestAnimationFrame(W)}const V={...M,nodeId:s,type:x,position:M.position},X=l.get(s);let Y={inProgress:!0,isValid:null,from:Ve(X,V,O.Left,!0),fromHandle:V,fromPosition:V.position,fromNode:X,to:A,toHandle:null,toPosition:sn[V.position],toNode:null};function F(){S=!0,f(Y),y==null||y(e,{nodeId:s,handleId:o,handleType:x})}_===0&&F();function U(Q){if(!S){const{x:te,y:se}=le(Q),de=te-$,we=se-H;if(!(de*de+we*we>_*_))return;F()}if(!v()||!V){ee(Q);return}const q=b();A=le(Q,C),D=ti(Ye(A,q,!1,[1,1]),n,l,V),k||(W(),k=!0);const K=wo(Q,{handle:D,connectionMode:t,fromNodeId:s,fromHandleId:o,fromType:i?"target":"source",isValidConnection:p,doc:P,lib:g,flowId:d,nodeLookup:l});B=K.handleDomNode,T=K.connection,L=ni(!!D,K.isValid);const Z={...Y,isValid:L,to:K.toHandle&&L?it({x:K.toHandle.x,y:K.toHandle.y},q):A,toHandle:K.toHandle,toPosition:L&&K.toHandle?K.toHandle.position:sn[V.position],toNode:K.toHandle?l.get(K.toHandle.nodeId):null};L&&D&&Y.toHandle&&Z.toHandle&&Y.toHandle.type===Z.toHandle.type&&Y.toHandle.nodeId===Z.toHandle.nodeId&&Y.toHandle.id===Z.toHandle.id&&Y.to.x===Z.to.x&&Y.to.y===Z.to.y||(f(Z),Y=Z)}function ee(Q){if(S){(D||B)&&T&&L&&(m==null||m(T));const{inProgress:q,...K}=Y,Z={...K,toPosition:Y.toHandle?Y.toPosition:null};w==null||w(Q,Z),r&&(N==null||N(Q,Z))}h(),cancelAnimationFrame(j),k=!1,L=!1,T=null,B=null,P.removeEventListener("mousemove",U),P.removeEventListener("mouseup",ee),P.removeEventListener("touchmove",U),P.removeEventListener("touchend",ee)}P.addEventListener("mousemove",U),P.addEventListener("mouseup",ee),P.addEventListener("touchmove",U),P.addEventListener("touchend",ee)}function wo(e,{handle:t,connectionMode:n,fromNodeId:o,fromHandleId:s,fromType:r,doc:i,lib:a,flowId:l,isValidConnection:g=bo,nodeLookup:u}){const d=r==="target",c=t?i.querySelector(`.${a}-flow__handle[data-id="${l}-${t==null?void 0:t.nodeId}-${t==null?void 0:t.id}-${t==null?void 0:t.type}"]`):null,{x:h,y}=le(e),m=i.elementFromPoint(h,y),w=m!=null&&m.classList.contains(`${a}-flow__handle`)?m:c,p={handleDomNode:w,isValid:!1,connection:null,toHandle:null};if(w){const N=yo(void 0,w),f=w.getAttribute("data-nodeid"),b=w.getAttribute("data-handleid"),v=w.classList.contains("connectable"),I=w.classList.contains("connectableend");if(!f||!N)return p;const _={source:d?f:o,sourceHandle:d?b:s,target:d?o:f,targetHandle:d?s:b};p.connection=_;const j=v&&I&&(n===Me.Strict?d&&N==="source"||!d&&N==="target":f!==o||b!==s);p.isValid=j&&g(_),p.toHandle=xo(f,N,b,u,n,!0)}return p}const jt={onPointerDown:oi,isValid:wo};function si({domNode:e,panZoom:t,getTransform:n,getViewScale:o}){const s=ie(e);function r({translateExtent:a,width:l,height:g,zoomStep:u=10,pannable:d=!0,zoomable:c=!0,inversePan:h=!1}){const y=f=>{const b=n();if(f.sourceEvent.type!=="wheel"||!t)return;const v=-f.sourceEvent.deltaY*(f.sourceEvent.deltaMode===1?.05:f.sourceEvent.deltaMode?1:.002)*u,I=b[2]*Math.pow(2,v);t.scaleTo(I)};let m=[0,0];const w=f=>{(f.sourceEvent.type==="mousedown"||f.sourceEvent.type==="touchstart")&&(m=[f.sourceEvent.clientX??f.sourceEvent.touches[0].clientX,f.sourceEvent.clientY??f.sourceEvent.touches[0].clientY])},p=f=>{const b=n();if(f.sourceEvent.type!=="mousemove"&&f.sourceEvent.type!=="touchmove"||!t)return;const v=[f.sourceEvent.clientX??f.sourceEvent.touches[0].clientX,f.sourceEvent.clientY??f.sourceEvent.touches[0].clientY],I=[v[0]-m[0],v[1]-m[1]];m=v;const _=o()*Math.max(b[2],Math.log(b[2]))*(h?-1:1),P={x:b[0]-I[0]*_,y:b[1]-I[1]*_},j=[[0,0],[l,g]];t.setViewportConstrained({x:P.x,y:P.y,zoom:b[2]},j,a)},N=Un().on("start",w).on("zoom",d?p:null).on("zoom.wheel",c?y:null);s.call(N,{})}function i(){s.on("zoom",null)}return{update:r,destroy:i,pointer:ae}}const ri=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,ft=e=>({x:e.x,y:e.y,zoom:e.k}),Mt=({x:e,y:t,zoom:n})=>Rt.translate(e,t).scale(n),Ee=(e,t)=>e.target.closest(`.${t}`),vo=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),ii=e=>((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2,kt=(e,t=0,n=ii,o=()=>{})=>{const s=typeof t=="number"&&t>0;return s||o(),s?e.transition().duration(t).ease(n).on("end",o):e},So=e=>{const t=e.ctrlKey&&at()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t};function ai({zoomPanValues:e,noWheelClassName:t,d3Selection:n,d3Zoom:o,panOnScrollMode:s,panOnScrollSpeed:r,zoomOnPinch:i,onPanZoomStart:a,onPanZoom:l,onPanZoomEnd:g}){return u=>{if(Ee(u,t))return!1;u.preventDefault(),u.stopImmediatePropagation();const d=n.property("__zoom").k||1;if(u.ctrlKey&&i){const w=ae(u),p=So(u),N=d*Math.pow(2,p);o.scaleTo(n,N,w,u);return}const c=u.deltaMode===1?20:1;let h=s===ye.Vertical?0:u.deltaX*c,y=s===ye.Horizontal?0:u.deltaY*c;!at()&&u.shiftKey&&s!==ye.Vertical&&(h=u.deltaY*c,y=0),o.translateBy(n,-(h/d)*r,-(y/d)*r,{internal:!0});const m=ft(n.property("__zoom"));clearTimeout(e.panScrollTimeout),e.isPanScrolling||(e.isPanScrolling=!0,a==null||a(u,m)),e.isPanScrolling&&(l==null||l(u,m),e.panScrollTimeout=setTimeout(()=>{g==null||g(u,m),e.isPanScrolling=!1},150))}}function ci({noWheelClassName:e,preventScrolling:t,d3ZoomHandler:n}){return function(o,s){const r=o.type==="wheel",i=!t&&r&&!o.ctrlKey,a=Ee(o,e);if(o.ctrlKey&&r&&a&&o.preventDefault(),i||a)return null;o.preventDefault(),n.call(this,o,s)}}function li({zoomPanValues:e,onDraggingChange:t,onPanZoomStart:n}){return o=>{var r,i,a;if((r=o.sourceEvent)!=null&&r.internal)return;const s=ft(o.transform);e.mouseButton=((i=o.sourceEvent)==null?void 0:i.button)||0,e.isZoomingOrPanning=!0,e.prevViewport=s,((a=o.sourceEvent)==null?void 0:a.type)==="mousedown"&&t(!0),n&&(n==null||n(o.sourceEvent,s))}}function ui({zoomPanValues:e,panOnDrag:t,onPaneContextMenu:n,onTransformChange:o,onPanZoom:s}){return r=>{var i,a;e.usedRightMouseButton=!!(n&&vo(t,e.mouseButton??0)),(i=r.sourceEvent)!=null&&i.sync||o([r.transform.x,r.transform.y,r.transform.k]),s&&!((a=r.sourceEvent)!=null&&a.internal)&&(s==null||s(r.sourceEvent,ft(r.transform)))}}function di({zoomPanValues:e,panOnDrag:t,panOnScroll:n,onDraggingChange:o,onPanZoomEnd:s,onPaneContextMenu:r}){return i=>{var a;if(!((a=i.sourceEvent)!=null&&a.internal)&&(e.isZoomingOrPanning=!1,r&&vo(t,e.mouseButton??0)&&!e.usedRightMouseButton&&i.sourceEvent&&r(i.sourceEvent),e.usedRightMouseButton=!1,o(!1),s&&ri(e.prevViewport,i.transform))){const l=ft(i.transform);e.prevViewport=l,clearTimeout(e.timerId),e.timerId=setTimeout(()=>{s==null||s(i.sourceEvent,l)},n?150:0)}}}function fi({zoomActivationKeyPressed:e,zoomOnScroll:t,zoomOnPinch:n,panOnDrag:o,panOnScroll:s,zoomOnDoubleClick:r,userSelectionActive:i,noWheelClassName:a,noPanClassName:l,lib:g}){return u=>{var y;const d=e||t,c=n&&u.ctrlKey;if(u.button===1&&u.type==="mousedown"&&(Ee(u,`${g}-flow__node`)||Ee(u,`${g}-flow__edge`)))return!0;if(!o&&!d&&!s&&!r&&!n||i||Ee(u,a)&&u.type==="wheel"||Ee(u,l)&&(u.type!=="wheel"||s&&u.type==="wheel"&&!e)||!n&&u.ctrlKey&&u.type==="wheel")return!1;if(!n&&u.type==="touchstart"&&((y=u.touches)==null?void 0:y.length)>1)return u.preventDefault(),!1;if(!d&&!s&&!c&&u.type==="wheel"||!o&&(u.type==="mousedown"||u.type==="touchstart")||Array.isArray(o)&&!o.includes(u.button)&&u.type==="mousedown")return!1;const h=Array.isArray(o)&&o.includes(u.button)||!u.button||u.button<=1;return(!u.ctrlKey||u.type==="wheel")&&h}}function hi({domNode:e,minZoom:t,maxZoom:n,paneClickDistance:o,translateExtent:s,viewport:r,onPanZoom:i,onPanZoomStart:a,onPanZoomEnd:l,onDraggingChange:g}){const u={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{x:0,y:0,zoom:0},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},d=e.getBoundingClientRect(),c=Un().clickDistance(!ce(o)||o<0?0:o).scaleExtent([t,n]).translateExtent(s),h=ie(e).call(c);f({x:r.x,y:r.y,zoom:ke(r.zoom,t,n)},[[0,0],[d.width,d.height]],s);const y=h.on("wheel.zoom"),m=h.on("dblclick.zoom");c.wheelDelta(So);function w(H,R){return h?new Promise(x=>{c==null||c.interpolate((R==null?void 0:R.interpolate)==="linear"?St:ot).transform(kt(h,R==null?void 0:R.duration,R==null?void 0:R.ease,()=>x(!0)),H)}):Promise.resolve(!1)}function p({noWheelClassName:H,noPanClassName:R,onPaneContextMenu:x,userSelectionActive:C,panOnScroll:S,panOnDrag:M,panOnScrollMode:A,panOnScrollSpeed:k,preventScrolling:T,zoomOnPinch:L,zoomOnScroll:B,zoomOnDoubleClick:W,zoomActivationKeyPressed:V,lib:X,onTransformChange:G}){C&&!u.isZoomingOrPanning&&N();const F=S&&!V&&!C?ai({zoomPanValues:u,noWheelClassName:H,d3Selection:h,d3Zoom:c,panOnScrollMode:A,panOnScrollSpeed:k,zoomOnPinch:L,onPanZoomStart:a,onPanZoom:i,onPanZoomEnd:l}):ci({noWheelClassName:H,preventScrolling:T,d3ZoomHandler:y});if(h.on("wheel.zoom",F,{passive:!1}),!C){const ee=li({zoomPanValues:u,onDraggingChange:g,onPanZoomStart:a});c.on("start",ee);const Q=ui({zoomPanValues:u,panOnDrag:M,onPaneContextMenu:!!x,onPanZoom:i,onTransformChange:G});c.on("zoom",Q);const q=di({zoomPanValues:u,panOnDrag:M,panOnScroll:S,onPaneContextMenu:x,onPanZoomEnd:l,onDraggingChange:g});c.on("end",q)}const U=fi({zoomActivationKeyPressed:V,panOnDrag:M,zoomOnScroll:B,panOnScroll:S,zoomOnDoubleClick:W,zoomOnPinch:L,userSelectionActive:C,noPanClassName:R,noWheelClassName:H,lib:X});c.filter(U),W?h.on("dblclick.zoom",m):h.on("dblclick.zoom",null)}function N(){c.on("zoom",null)}async function f(H,R,x){const C=Mt(H),S=c==null?void 0:c.constrain()(C,R,x);return S&&await w(S),new Promise(M=>M(S))}async function b(H,R){const x=Mt(H);return await w(x,R),new Promise(C=>C(x))}function v(H){if(h){const R=Mt(H),x=h.property("__zoom");(x.k!==H.zoom||x.x!==H.x||x.y!==H.y)&&(c==null||c.transform(h,R,null,{sync:!0}))}}function I(){const H=h?rr(h.node()):{x:0,y:0,k:1};return{x:H.x,y:H.y,zoom:H.k}}function _(H,R){return h?new Promise(x=>{c==null||c.interpolate((R==null?void 0:R.interpolate)==="linear"?St:ot).scaleTo(kt(h,R==null?void 0:R.duration,R==null?void 0:R.ease,()=>x(!0)),H)}):Promise.resolve(!1)}function P(H,R){return h?new Promise(x=>{c==null||c.interpolate((R==null?void 0:R.interpolate)==="linear"?St:ot).scaleBy(kt(h,R==null?void 0:R.duration,R==null?void 0:R.ease,()=>x(!0)),H)}):Promise.resolve(!1)}function j(H){c==null||c.scaleExtent(H)}function D(H){c==null||c.translateExtent(H)}function $(H){const R=!ce(H)||H<0?0:H;c==null||c.clickDistance(R)}return{update:p,destroy:N,setViewport:b,setViewportConstrained:f,getViewport:I,scaleTo:_,scaleBy:P,setScaleExtent:j,setTranslateExtent:D,syncViewport:v,setClickDistance:$}}var Pe;(function(e){e.Line="line",e.Handle="handle"})(Pe||(Pe={}));function gi({width:e,prevWidth:t,height:n,prevHeight:o,affectsX:s,affectsY:r}){const i=e-t,a=n-o,l=[i>0?1:i<0?-1:0,a>0?1:a<0?-1:0];return i&&s&&(l[0]=l[0]*-1),a&&r&&(l[1]=l[1]*-1),l}function pi(e){const t=e.includes("right")||e.includes("left"),n=e.includes("bottom")||e.includes("top"),o=e.includes("left"),s=e.includes("top");return{isHorizontal:t,isVertical:n,affectsX:o,affectsY:s}}function he(e,t){return Math.max(0,t-e)}function ge(e,t){return Math.max(0,e-t)}function et(e,t,n){return Math.max(0,t-e,e-n)}function yn(e,t){return e?!t:t}function mi(e,t,n,o,s,r,i,a){let{affectsX:l,affectsY:g}=t;const{isHorizontal:u,isVertical:d}=t,c=u&&d,{xSnapped:h,ySnapped:y}=n,{minWidth:m,maxWidth:w,minHeight:p,maxHeight:N}=o,{x:f,y:b,width:v,height:I,aspectRatio:_}=e;let P=Math.floor(u?h-e.pointerX:0),j=Math.floor(d?y-e.pointerY:0);const D=v+(l?-P:P),$=I+(g?-j:j),H=-r[0]*v,R=-r[1]*I;let x=et(D,m,w),C=et($,p,N);if(i){let A=0,k=0;l&&P<0?A=he(f+P+H,i[0][0]):!l&&P>0&&(A=ge(f+D+H,i[1][0])),g&&j<0?k=he(b+j+R,i[0][1]):!g&&j>0&&(k=ge(b+$+R,i[1][1])),x=Math.max(x,A),C=Math.max(C,k)}if(a){let A=0,k=0;l&&P>0?A=ge(f+P,a[0][0]):!l&&P<0&&(A=he(f+D,a[1][0])),g&&j>0?k=ge(b+j,a[0][1]):!g&&j<0&&(k=he(b+$,a[1][1])),x=Math.max(x,A),C=Math.max(C,k)}if(s){if(u){const A=et(D/_,p,N)*_;if(x=Math.max(x,A),i){let k=0;!l&&!g||l&&!g&&c?k=ge(b+R+D/_,i[1][1])*_:k=he(b+R+(l?P:-P)/_,i[0][1])*_,x=Math.max(x,k)}if(a){let k=0;!l&&!g||l&&!g&&c?k=he(b+D/_,a[1][1])*_:k=ge(b+(l?P:-P)/_,a[0][1])*_,x=Math.max(x,k)}}if(d){const A=et($*_,m,w)/_;if(C=Math.max(C,A),i){let k=0;!l&&!g||g&&!l&&c?k=ge(f+$*_+H,i[1][0])/_:k=he(f+(g?j:-j)*_+H,i[0][0])/_,C=Math.max(C,k)}if(a){let k=0;!l&&!g||g&&!l&&c?k=he(f+$*_,a[1][0])/_:k=ge(f+(g?j:-j)*_,a[0][0])/_,C=Math.max(C,k)}}}j=j+(j<0?C:-C),P=P+(P<0?x:-x),s&&(c?D>$*_?j=(yn(l,g)?-P:P)/_:P=(yn(l,g)?-j:j)*_:u?(j=P/_,g=l):(P=j*_,l=g));const S=l?f+P:f,M=g?b+j:b;return{width:v+(l?-P:P),height:I+(g?-j:j),x:r[0]*P*(l?-1:1)+S,y:r[1]*j*(g?-1:1)+M}}const Eo={width:0,height:0,x:0,y:0},xi={...Eo,pointerX:0,pointerY:0,aspectRatio:1};function yi(e){return[[0,0],[e.measured.width,e.measured.height]]}function bi(e,t,n){const o=t.position.x+e.position.x,s=t.position.y+e.position.y,r=e.measured.width??0,i=e.measured.height??0,a=n[0]*r,l=n[1]*i;return[[o-a,s-l],[o+r-a,s+i-l]]}function wi({domNode:e,nodeId:t,getStoreItems:n,onChange:o,onEnd:s}){const r=ie(e);function i({controlPosition:l,boundaries:g,keepAspectRatio:u,resizeDirection:d,onResizeStart:c,onResize:h,onResizeEnd:y,shouldResize:m}){let w={...Eo},p={...xi};const N=pi(l);let f,b=null,v=[],I,_,P;const j=Gn().on("start",D=>{const{nodeLookup:$,transform:H,snapGrid:R,snapToGrid:x,nodeOrigin:C,paneDomNode:S}=n();if(f=$.get(t),!f)return;b=(S==null?void 0:S.getBoundingClientRect())??null;const{xSnapped:M,ySnapped:A}=He(D.sourceEvent,{transform:H,snapGrid:R,snapToGrid:x,containerBounds:b});w={width:f.measured.width??0,height:f.measured.height??0,x:f.position.x??0,y:f.position.y??0},p={...w,pointerX:M,pointerY:A,aspectRatio:w.width/w.height},I=void 0,f.parentId&&(f.extent==="parent"||f.expandParent)&&(I=$.get(f.parentId),_=I&&f.extent==="parent"?yi(I):void 0),v=[],P=void 0;for(const[k,T]of $)if(T.parentId===t&&(v.push({id:k,position:{...T.position},extent:T.extent}),T.extent==="parent"||T.expandParent)){const L=bi(T,f,T.origin??C);P?P=[[Math.min(L[0][0],P[0][0]),Math.min(L[0][1],P[0][1])],[Math.max(L[1][0],P[1][0]),Math.max(L[1][1],P[1][1])]]:P=L}c==null||c(D,{...w})}).on("drag",D=>{const{transform:$,snapGrid:H,snapToGrid:R,nodeOrigin:x}=n(),C=He(D.sourceEvent,{transform:$,snapGrid:H,snapToGrid:R,containerBounds:b}),S=[];if(!f)return;const{x:M,y:A,width:k,height:T}=w,L={},B=f.origin??x,{width:W,height:V,x:X,y:G}=mi(p,N,C,g,u,B,_,P),Y=W!==k,F=V!==T,U=X!==M&&Y,ee=G!==A&&F;if(!U&&!ee&&!Y&&!F)return;if((U||ee||B[0]===1||B[1]===1)&&(L.x=U?X:w.x,L.y=ee?G:w.y,w.x=L.x,w.y=L.y,v.length>0)){const Z=X-M,te=G-A;for(const se of v)se.position={x:se.position.x-Z+B[0]*(W-k),y:se.position.y-te+B[1]*(V-T)},S.push(se)}if((Y||F)&&(L.width=Y&&(!d||d==="horizontal")?W:w.width,L.height=F&&(!d||d==="vertical")?V:w.height,w.width=L.width,w.height=L.height),I&&f.expandParent){const Z=B[0]*(L.width??0);L.x&&L.x<Z&&(w.x=Z,p.x=p.x-(L.x-Z));const te=B[1]*(L.height??0);L.y&&L.y<te&&(w.y=te,p.y=p.y-(L.y-te))}const Q=gi({width:w.width,prevWidth:k,height:w.height,prevHeight:T,affectsX:N.affectsX,affectsY:N.affectsY}),q={...w,direction:Q};(m==null?void 0:m(D,q))!==!1&&(h==null||h(D,q),o(L,S))}).on("end",D=>{y==null||y(D,{...w}),s==null||s({...w})});r.call(j)}function a(){r.on(".drag",null)}return{update:i,destroy:a}}const vi={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1},bn=e=>{let t;const n=new Set,o=(u,d)=>{const c=typeof u=="function"?u(t):u;if(!Object.is(c,t)){const h=t;t=d??(typeof c!="object"||c===null)?c:Object.assign({},t,c),n.forEach(y=>y(t,h))}},s=()=>t,l={setState:o,getState:s,getInitialState:()=>g,subscribe:u=>(n.add(u),()=>n.delete(u)),destroy:()=>{(vi?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},g=t=e(o,s,l);return l},Si=e=>e?bn(e):bn,{useDebugValue:Ei}=ir,{useSyncExternalStoreWithSelector:Ni}=ar,Ci=e=>e;function No(e,t=Ci,n){const o=Ni(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return Ei(o),o}const wn=(e,t)=>{const n=Si(e),o=(s,r=t)=>No(n,s,r);return Object.assign(o,n),o},Mi=(e,t)=>e?wn(e,t):wn;function oe(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[o,s]of e)if(!Object.is(s,t.get(o)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const o of e)if(!t.has(o))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const o of n)if(!Object.prototype.hasOwnProperty.call(t,o)||!Object.is(e[o],t[o]))return!1;return!0}const ht=z.createContext(null),ki=ht.Provider,Co=ue.error001();function J(e,t){const n=z.useContext(ht);if(n===null)throw new Error(Co);return No(n,e,t)}function ne(){const e=z.useContext(ht);if(e===null)throw new Error(Co);return z.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe}),[e])}const vn={display:"none"},Ii={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},Mo="react-flow__node-desc",ko="react-flow__edge-desc",_i="react-flow__aria-live",Pi=e=>e.ariaLiveMessage,zi=e=>e.ariaLabelConfig;function $i({rfId:e}){const t=J(Pi);return E.jsx("div",{id:`${_i}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:Ii,children:t})}function Ai({rfId:e,disableKeyboardA11y:t}){const n=J(zi);return E.jsxs(E.Fragment,{children:[E.jsx("div",{id:`${Mo}-${e}`,style:vn,children:t?n["node.a11yDescription.default"]:n["node.a11yDescription.keyboardDisabled"]}),E.jsx("div",{id:`${ko}-${e}`,style:vn,children:n["edge.a11yDescription.default"]}),!t&&E.jsx($i,{rfId:e})]})}const gt=z.forwardRef(({position:e="top-left",children:t,className:n,style:o,...s},r)=>{const i=`${e}`.split("-");return E.jsx("div",{className:re(["react-flow__panel",n,...i]),style:o,ref:r,...s,children:t})});gt.displayName="Panel";function Ti({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:E.jsx(gt,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:E.jsx("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}const ji=e=>{const t=[],n=[];for(const[,o]of e.nodeLookup)o.selected&&t.push(o.internals.userNode);for(const[,o]of e.edgeLookup)o.selected&&n.push(o);return{selectedNodes:t,selectedEdges:n}},tt=e=>e.id;function Hi(e,t){return oe(e.selectedNodes.map(tt),t.selectedNodes.map(tt))&&oe(e.selectedEdges.map(tt),t.selectedEdges.map(tt))}function Ri({onSelectionChange:e}){const t=ne(),{selectedNodes:n,selectedEdges:o}=J(ji,Hi);return z.useEffect(()=>{const s={nodes:n,edges:o};e==null||e(s),t.getState().onSelectionChangeHandlers.forEach(r=>r(s))},[n,o,e]),null}const Li=e=>!!e.onSelectionChangeHandlers;function Di({onSelectionChange:e}){const t=J(Li);return e||t?E.jsx(Ri,{onSelectionChange:e}):null}const Io=[0,0],Bi={x:0,y:0,zoom:1},Vi=["nodes","edges","defaultNodes","defaultEdges","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","nodesDraggable","autoPanOnNodeFocus","nodesConnectable","nodesFocusable","edgesFocusable","edgesReconnectable","elevateNodesOnSelect","elevateEdgesOnSelect","minZoom","maxZoom","nodeExtent","onNodesChange","onEdgesChange","elementsSelectable","connectionMode","snapGrid","snapToGrid","translateExtent","connectOnClick","defaultEdgeOptions","fitView","fitViewOptions","onNodesDelete","onEdgesDelete","onDelete","onNodeDrag","onNodeDragStart","onNodeDragStop","onSelectionDrag","onSelectionDragStart","onSelectionDragStop","onMoveStart","onMove","onMoveEnd","noPanClassName","nodeOrigin","autoPanOnConnect","autoPanOnNodeDrag","onError","connectionRadius","isValidConnection","selectNodesOnDrag","nodeDragThreshold","connectionDragThreshold","onBeforeDelete","debug","autoPanSpeed","paneClickDistance","ariaLabelConfig"],Sn=[...Vi,"rfId"],Fi=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setPaneClickDistance:e.setPaneClickDistance}),En={translateExtent:Le,nodeOrigin:Io,minZoom:.5,maxZoom:2,elementsSelectable:!0,noPanClassName:"nopan",rfId:"1",paneClickDistance:0};function Wi(e){const{setNodes:t,setEdges:n,setMinZoom:o,setMaxZoom:s,setTranslateExtent:r,setNodeExtent:i,reset:a,setDefaultNodesAndEdges:l,setPaneClickDistance:g}=J(Fi,oe),u=ne();z.useEffect(()=>(l(e.defaultNodes,e.defaultEdges),()=>{d.current=En,a()}),[]);const d=z.useRef(En);return z.useEffect(()=>{for(const c of Sn){const h=e[c],y=d.current[c];h!==y&&(typeof e[c]>"u"||(c==="nodes"?t(h):c==="edges"?n(h):c==="minZoom"?o(h):c==="maxZoom"?s(h):c==="translateExtent"?r(h):c==="nodeExtent"?i(h):c==="paneClickDistance"?g(h):c==="ariaLabelConfig"?u.setState({ariaLabelConfig:Ar(h)}):c==="fitView"?u.setState({fitViewQueued:h}):c==="fitViewOptions"?u.setState({fitViewOptions:h}):u.setState({[c]:h})))}d.current=e},Sn.map(c=>e[c])),null}function Nn(){return typeof window>"u"||!window.matchMedia?null:window.matchMedia("(prefers-color-scheme: dark)")}function Oi(e){var o;const[t,n]=z.useState(e==="system"?null:e);return z.useEffect(()=>{if(e!=="system"){n(e);return}const s=Nn(),r=()=>n(s!=null&&s.matches?"dark":"light");return r(),s==null||s.addEventListener("change",r),()=>{s==null||s.removeEventListener("change",r)}},[e]),t!==null?t:(o=Nn())!=null&&o.matches?"dark":"light"}const Cn=typeof document<"u"?document:null;function Fe(e=null,t={target:Cn,actInsideInputWithModifier:!0}){const[n,o]=z.useState(!1),s=z.useRef(!1),r=z.useRef(new Set([])),[i,a]=z.useMemo(()=>{if(e!==null){const g=(Array.isArray(e)?e:[e]).filter(d=>typeof d=="string").map(d=>d.replace("+",`
`).replace(`

`,`
+`).split(`
`)),u=g.reduce((d,c)=>d.concat(...c),[]);return[g,u]}return[[],[]]},[e]);return z.useEffect(()=>{const l=(t==null?void 0:t.target)??Cn,g=(t==null?void 0:t.actInsideInputWithModifier)??!0;if(e!==null){const u=h=>{var w,p;if(s.current=h.ctrlKey||h.metaKey||h.shiftKey||h.altKey,(!s.current||s.current&&!g)&&ao(h))return!1;const m=kn(h.code,a);if(r.current.add(h[m]),Mn(i,r.current,!1)){const N=((p=(w=h.composedPath)==null?void 0:w.call(h))==null?void 0:p[0])||h.target,f=(N==null?void 0:N.nodeName)==="BUTTON"||(N==null?void 0:N.nodeName)==="A";t.preventDefault!==!1&&(s.current||!f)&&h.preventDefault(),o(!0)}},d=h=>{const y=kn(h.code,a);Mn(i,r.current,!0)?(o(!1),r.current.clear()):r.current.delete(h[y]),h.key==="Meta"&&r.current.clear(),s.current=!1},c=()=>{r.current.clear(),o(!1)};return l==null||l.addEventListener("keydown",u),l==null||l.addEventListener("keyup",d),window.addEventListener("blur",c),window.addEventListener("contextmenu",c),()=>{l==null||l.removeEventListener("keydown",u),l==null||l.removeEventListener("keyup",d),window.removeEventListener("blur",c),window.removeEventListener("contextmenu",c)}}},[e,o]),n}function Mn(e,t,n){return e.filter(o=>n||o.length===t.size).some(o=>o.every(s=>t.has(s)))}function kn(e,t){return t.includes(e)?"code":"key"}const Yi=()=>{const e=ne();return z.useMemo(()=>({zoomIn:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1.2,{duration:t==null?void 0:t.duration}):Promise.resolve(!1)},zoomOut:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1/1.2,{duration:t==null?void 0:t.duration}):Promise.resolve(!1)},zoomTo:(t,n)=>{const{panZoom:o}=e.getState();return o?o.scaleTo(t,{duration:n==null?void 0:n.duration}):Promise.resolve(!1)},getZoom:()=>e.getState().transform[2],setViewport:async(t,n)=>{const{transform:[o,s,r],panZoom:i}=e.getState();return i?(await i.setViewport({x:t.x??o,y:t.y??s,zoom:t.zoom??r},n),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>{const[t,n,o]=e.getState().transform;return{x:t,y:n,zoom:o}},setCenter:async(t,n,o)=>e.getState().setCenter(t,n,o),fitBounds:async(t,n)=>{const{width:o,height:s,minZoom:r,maxZoom:i,panZoom:a}=e.getState(),l=Bt(t,o,s,r,i,(n==null?void 0:n.padding)??.1);return a?(await a.setViewport(l,{duration:n==null?void 0:n.duration,ease:n==null?void 0:n.ease,interpolate:n==null?void 0:n.interpolate}),Promise.resolve(!0)):Promise.resolve(!1)},screenToFlowPosition:(t,n={})=>{const{transform:o,snapGrid:s,snapToGrid:r,domNode:i}=e.getState();if(!i)return t;const{x:a,y:l}=i.getBoundingClientRect(),g={x:t.x-a,y:t.y-l},u=n.snapGrid??s,d=n.snapToGrid??r;return Ye(g,o,d,u)},flowToScreenPosition:t=>{const{transform:n,domNode:o}=e.getState();if(!o)return t;const{x:s,y:r}=o.getBoundingClientRect(),i=it(t,n);return{x:i.x+s,y:i.y+r}}}),[])};function _o(e,t){const n=[],o=new Map,s=[];for(const r of e)if(r.type==="add"){s.push(r);continue}else if(r.type==="remove"||r.type==="replace")o.set(r.id,[r]);else{const i=o.get(r.id);i?i.push(r):o.set(r.id,[r])}for(const r of t){const i=o.get(r.id);if(!i){n.push(r);continue}if(i[0].type==="remove")continue;if(i[0].type==="replace"){n.push({...i[0].item});continue}const a={...r};for(const l of i)Xi(l,a);n.push(a)}return s.length&&s.forEach(r=>{r.index!==void 0?n.splice(r.index,0,{...r.item}):n.push({...r.item})}),n}function Xi(e,t){switch(e.type){case"select":{t.selected=e.selected;break}case"position":{typeof e.position<"u"&&(t.position=e.position),typeof e.dragging<"u"&&(t.dragging=e.dragging);break}case"dimensions":{typeof e.dimensions<"u"&&(t.measured??(t.measured={}),t.measured.width=e.dimensions.width,t.measured.height=e.dimensions.height,e.setAttributes&&((e.setAttributes===!0||e.setAttributes==="width")&&(t.width=e.dimensions.width),(e.setAttributes===!0||e.setAttributes==="height")&&(t.height=e.dimensions.height))),typeof e.resizing=="boolean"&&(t.resizing=e.resizing);break}}}function Gi(e,t){return _o(e,t)}function Ui(e,t){return _o(e,t)}function xe(e,t){return{id:e,type:"select",selected:t}}function Ne(e,t=new Set,n=!1){const o=[];for(const[s,r]of e){const i=t.has(s);!(r.selected===void 0&&!i)&&r.selected!==i&&(n&&(r.selected=i),o.push(xe(r.id,i)))}return o}function In({items:e=[],lookup:t}){var s;const n=[],o=new Map(e.map(r=>[r.id,r]));for(const[r,i]of e.entries()){const a=t.get(i.id),l=((s=a==null?void 0:a.internals)==null?void 0:s.userNode)??a;l!==void 0&&l!==i&&n.push({id:i.id,item:i,type:"replace"}),l===void 0&&n.push({item:i,type:"add",index:r})}for(const[r]of t)o.get(r)===void 0&&n.push({id:r,type:"remove"});return n}function _n(e){return{id:e.id,type:"remove"}}const Pn=e=>Er(e),qi=e=>Jn(e);function Po(e){return z.forwardRef(e)}const Zi=typeof window<"u"?z.useLayoutEffect:z.useEffect;function zn(e){const[t,n]=z.useState(BigInt(0)),[o]=z.useState(()=>Ki(()=>n(s=>s+BigInt(1))));return Zi(()=>{const s=o.get();s.length&&(e(s),o.reset())},[t]),o}function Ki(e){let t=[];return{get:()=>t,reset:()=>{t=[]},push:n=>{t.push(n),e()}}}const zo=z.createContext(null);function Qi({children:e}){const t=ne(),n=z.useCallback(a=>{const{nodes:l=[],setNodes:g,hasDefaultNodes:u,onNodesChange:d,nodeLookup:c,fitViewQueued:h}=t.getState();let y=l;for(const w of a)y=typeof w=="function"?w(y):w;const m=In({items:y,lookup:c});u&&g(y),m.length>0?d==null||d(m):h&&window.requestAnimationFrame(()=>{const{fitViewQueued:w,nodes:p,setNodes:N}=t.getState();w&&N(p)})},[]),o=zn(n),s=z.useCallback(a=>{const{edges:l=[],setEdges:g,hasDefaultEdges:u,onEdgesChange:d,edgeLookup:c}=t.getState();let h=l;for(const y of a)h=typeof y=="function"?y(h):y;u?g(h):d&&d(In({items:h,lookup:c}))},[]),r=zn(s),i=z.useMemo(()=>({nodeQueue:o,edgeQueue:r}),[]);return E.jsx(zo.Provider,{value:i,children:e})}function Ji(){const e=z.useContext(zo);if(!e)throw new Error("useBatchContext must be used within a BatchProvider");return e}const ea=e=>!!e.panZoom;function Xt(){const e=Yi(),t=ne(),n=Ji(),o=J(ea),s=z.useMemo(()=>{const r=d=>t.getState().nodeLookup.get(d),i=d=>{n.nodeQueue.push(d)},a=d=>{n.edgeQueue.push(d)},l=d=>{var p,N;const{nodeLookup:c,nodeOrigin:h}=t.getState(),y=Pn(d)?d:c.get(d.id),m=y.parentId?ro(y.position,y.measured,y.parentId,c,h):y.position,w={...y,position:m,width:((p=y.measured)==null?void 0:p.width)??y.width,height:((N=y.measured)==null?void 0:N.height)??y.height};return Ie(w)},g=(d,c,h={replace:!1})=>{i(y=>y.map(m=>{if(m.id===d){const w=typeof c=="function"?c(m):c;return h.replace&&Pn(w)?w:{...m,...w}}return m}))},u=(d,c,h={replace:!1})=>{a(y=>y.map(m=>{if(m.id===d){const w=typeof c=="function"?c(m):c;return h.replace&&qi(w)?w:{...m,...w}}return m}))};return{getNodes:()=>t.getState().nodes.map(d=>({...d})),getNode:d=>{var c;return(c=r(d))==null?void 0:c.internals.userNode},getInternalNode:r,getEdges:()=>{const{edges:d=[]}=t.getState();return d.map(c=>({...c}))},getEdge:d=>t.getState().edgeLookup.get(d),setNodes:i,setEdges:a,addNodes:d=>{const c=Array.isArray(d)?d:[d];n.nodeQueue.push(h=>[...h,...c])},addEdges:d=>{const c=Array.isArray(d)?d:[d];n.edgeQueue.push(h=>[...h,...c])},toObject:()=>{const{nodes:d=[],edges:c=[],transform:h}=t.getState(),[y,m,w]=h;return{nodes:d.map(p=>({...p})),edges:c.map(p=>({...p})),viewport:{x:y,y:m,zoom:w}}},deleteElements:async({nodes:d=[],edges:c=[]})=>{const{nodes:h,edges:y,onNodesDelete:m,onEdgesDelete:w,triggerNodeChanges:p,triggerEdgeChanges:N,onDelete:f,onBeforeDelete:b}=t.getState(),{nodes:v,edges:I}=await Ir({nodesToRemove:d,edgesToRemove:c,nodes:h,edges:y,onBeforeDelete:b}),_=I.length>0,P=v.length>0;if(_){const j=I.map(_n);w==null||w(I),N(j)}if(P){const j=v.map(_n);m==null||m(v),p(j)}return(P||_)&&(f==null||f({nodes:v,edges:I})),{deletedNodes:v,deletedEdges:I}},getIntersectingNodes:(d,c=!0,h)=>{const y=an(d),m=y?d:l(d),w=h!==void 0;return m?(h||t.getState().nodes).filter(p=>{const N=t.getState().nodeLookup.get(p.id);if(N&&!y&&(p.id===d.id||!N.internals.positionAbsolute))return!1;const f=Ie(w?p:N),b=Be(f,m);return c&&b>0||b>=f.width*f.height||b>=m.width*m.height}):[]},isNodeIntersecting:(d,c,h=!0)=>{const m=an(d)?d:l(d);if(!m)return!1;const w=Be(m,c);return h&&w>0||w>=m.width*m.height},updateNode:g,updateNodeData:(d,c,h={replace:!1})=>{g(d,y=>{const m=typeof c=="function"?c(y):c;return h.replace?{...y,data:m}:{...y,data:{...y.data,...m}}},h)},updateEdge:u,updateEdgeData:(d,c,h={replace:!1})=>{u(d,y=>{const m=typeof c=="function"?c(y):c;return h.replace?{...y,data:m}:{...y,data:{...y.data,...m}}},h)},getNodesBounds:d=>{const{nodeLookup:c,nodeOrigin:h}=t.getState();return Nr(d,{nodeLookup:c,nodeOrigin:h})},getHandleConnections:({type:d,id:c,nodeId:h})=>{var y;return Array.from(((y=t.getState().connectionLookup.get(`${h}-${d}${c?`-${c}`:""}`))==null?void 0:y.values())??[])},getNodeConnections:({type:d,handleId:c,nodeId:h})=>{var y;return Array.from(((y=t.getState().connectionLookup.get(`${h}${d?c?`-${d}-${c}`:`-${d}`:""}`))==null?void 0:y.values())??[])},fitView:async d=>{const c=t.getState().fitViewResolver??$r();return t.setState({fitViewQueued:!0,fitViewOptions:d,fitViewResolver:c}),n.nodeQueue.push(h=>[...h]),c.promise}}},[]);return z.useMemo(()=>({...s,...e,viewportInitialized:o}),[o])}const $n=e=>e.selected,ta=typeof window<"u"?window:void 0;function na({deleteKeyCode:e,multiSelectionKeyCode:t}){const n=ne(),{deleteElements:o}=Xt(),s=Fe(e,{actInsideInputWithModifier:!1}),r=Fe(t,{target:ta});z.useEffect(()=>{if(s){const{edges:i,nodes:a}=n.getState();o({nodes:a.filter($n),edges:i.filter($n)}),n.setState({nodesSelectionActive:!1})}},[s]),z.useEffect(()=>{n.setState({multiSelectionActive:r})},[r])}function oa(e){const t=ne();z.useEffect(()=>{const n=()=>{var s,r;if(!e.current)return!1;const o=Vt(e.current);(o.height===0||o.width===0)&&((r=(s=t.getState()).onError)==null||r.call(s,"004",ue.error004())),t.setState({width:o.width||500,height:o.height||500})};if(e.current){n(),window.addEventListener("resize",n);const o=new ResizeObserver(()=>n());return o.observe(e.current),()=>{window.removeEventListener("resize",n),o&&e.current&&o.unobserve(e.current)}}},[])}const pt={position:"absolute",width:"100%",height:"100%",top:0,left:0},sa=e=>({userSelectionActive:e.userSelectionActive,lib:e.lib});function ra({onPaneContextMenu:e,zoomOnScroll:t=!0,zoomOnPinch:n=!0,panOnScroll:o=!1,panOnScrollSpeed:s=.5,panOnScrollMode:r=ye.Free,zoomOnDoubleClick:i=!0,panOnDrag:a=!0,defaultViewport:l,translateExtent:g,minZoom:u,maxZoom:d,zoomActivationKeyCode:c,preventScrolling:h=!0,children:y,noWheelClassName:m,noPanClassName:w,onViewportChange:p,isControlledViewport:N,paneClickDistance:f}){const b=ne(),v=z.useRef(null),{userSelectionActive:I,lib:_}=J(sa,oe),P=Fe(c),j=z.useRef();oa(v);const D=z.useCallback($=>{p==null||p({x:$[0],y:$[1],zoom:$[2]}),N||b.setState({transform:$})},[p,N]);return z.useEffect(()=>{if(v.current){j.current=hi({domNode:v.current,minZoom:u,maxZoom:d,translateExtent:g,viewport:l,paneClickDistance:f,onDraggingChange:x=>b.setState({paneDragging:x}),onPanZoomStart:(x,C)=>{const{onViewportChangeStart:S,onMoveStart:M}=b.getState();M==null||M(x,C),S==null||S(C)},onPanZoom:(x,C)=>{const{onViewportChange:S,onMove:M}=b.getState();M==null||M(x,C),S==null||S(C)},onPanZoomEnd:(x,C)=>{const{onViewportChangeEnd:S,onMoveEnd:M}=b.getState();M==null||M(x,C),S==null||S(C)}});const{x:$,y:H,zoom:R}=j.current.getViewport();return b.setState({panZoom:j.current,transform:[$,H,R],domNode:v.current.closest(".react-flow")}),()=>{var x;(x=j.current)==null||x.destroy()}}},[]),z.useEffect(()=>{var $;($=j.current)==null||$.update({onPaneContextMenu:e,zoomOnScroll:t,zoomOnPinch:n,panOnScroll:o,panOnScrollSpeed:s,panOnScrollMode:r,zoomOnDoubleClick:i,panOnDrag:a,zoomActivationKeyPressed:P,preventScrolling:h,noPanClassName:w,userSelectionActive:I,noWheelClassName:m,lib:_,onTransformChange:D})},[e,t,n,o,s,r,i,a,P,h,w,I,m,_,D]),E.jsx("div",{className:"react-flow__renderer",ref:v,style:pt,children:y})}const ia=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function aa(){const{userSelectionActive:e,userSelectionRect:t}=J(ia,oe);return e&&t?E.jsx("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}const It=(e,t)=>n=>{n.target===t.current&&(e==null||e(n))},ca=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,connectionInProgress:e.connection.inProgress,dragging:e.paneDragging});function la({isSelecting:e,selectionKeyPressed:t,selectionMode:n=De.Full,panOnDrag:o,selectionOnDrag:s,onSelectionStart:r,onSelectionEnd:i,onPaneClick:a,onPaneContextMenu:l,onPaneScroll:g,onPaneMouseEnter:u,onPaneMouseMove:d,onPaneMouseLeave:c,children:h}){const y=ne(),{userSelectionActive:m,elementsSelectable:w,dragging:p,connectionInProgress:N}=J(ca,oe),f=w&&(e||m),b=z.useRef(null),v=z.useRef(),I=z.useRef(new Set),_=z.useRef(new Set),P=z.useRef(!1),j=z.useRef(!1),D=M=>{if(P.current||N){P.current=!1;return}a==null||a(M),y.getState().resetSelectedElements(),y.setState({nodesSelectionActive:!1})},$=M=>{if(Array.isArray(o)&&(o!=null&&o.includes(2))){M.preventDefault();return}l==null||l(M)},H=g?M=>g(M):void 0,R=M=>{var B,W;const{resetSelectedElements:A,domNode:k}=y.getState();if(v.current=k==null?void 0:k.getBoundingClientRect(),!w||!e||M.button!==0||M.target!==b.current||!v.current)return;(W=(B=M.target)==null?void 0:B.setPointerCapture)==null||W.call(B,M.pointerId),j.current=!0,P.current=!1;const{x:T,y:L}=le(M.nativeEvent,v.current);A(),y.setState({userSelectionRect:{width:0,height:0,startX:T,startY:L,x:T,y:L}}),r==null||r(M)},x=M=>{const{userSelectionRect:A,transform:k,nodeLookup:T,edgeLookup:L,connectionLookup:B,triggerNodeChanges:W,triggerEdgeChanges:V,defaultEdgeOptions:X}=y.getState();if(!v.current||!A)return;P.current=!0;const{x:G,y:Y}=le(M.nativeEvent,v.current),{startX:F,startY:U}=A,ee={startX:F,startY:U,x:G<F?G:F,y:Y<U?Y:U,width:Math.abs(G-F),height:Math.abs(Y-U)},Q=I.current,q=_.current;I.current=new Set(Dt(T,ee,k,n===De.Partial,!0).map(Z=>Z.id)),_.current=new Set;const K=(X==null?void 0:X.selectable)??!0;for(const Z of I.current){const te=B.get(Z);if(te)for(const{edgeId:se}of te.values()){const de=L.get(se);de&&(de.selectable??K)&&_.current.add(se)}}if(!cn(Q,I.current)){const Z=Ne(T,I.current,!0);W(Z)}if(!cn(q,_.current)){const Z=Ne(L,_.current);V(Z)}y.setState({userSelectionRect:ee,userSelectionActive:!0,nodesSelectionActive:!1})},C=M=>{var k,T;if(M.button!==0||!j.current)return;(T=(k=M.target)==null?void 0:k.releasePointerCapture)==null||T.call(k,M.pointerId);const{userSelectionRect:A}=y.getState();!m&&A&&M.target===b.current&&(D==null||D(M)),y.setState({userSelectionActive:!1,userSelectionRect:null,nodesSelectionActive:I.current.size>0}),i==null||i(M),(t||s)&&(P.current=!1),j.current=!1},S=o===!0||Array.isArray(o)&&o.includes(0);return E.jsxs("div",{className:re(["react-flow__pane",{draggable:S,dragging:p,selection:e}]),onClick:f?void 0:It(D,b),onContextMenu:It($,b),onWheel:It(H,b),onPointerEnter:f?void 0:u,onPointerDown:f?R:d,onPointerMove:f?x:d,onPointerUp:f?C:void 0,onPointerLeave:c,ref:b,style:pt,children:[h,E.jsx(aa,{})]})}function Ht({id:e,store:t,unselect:n=!1,nodeRef:o}){const{addSelectedNodes:s,unselectNodesAndEdges:r,multiSelectionActive:i,nodeLookup:a,onError:l}=t.getState(),g=a.get(e);if(!g){l==null||l("012",ue.error012(e));return}t.setState({nodesSelectionActive:!1}),g.selected?(n||g.selected&&i)&&(r({nodes:[g],edges:[]}),requestAnimationFrame(()=>{var u;return(u=o==null?void 0:o.current)==null?void 0:u.blur()})):s([e])}function $o({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:o,nodeId:s,isSelectable:r,nodeClickDistance:i}){const a=ne(),[l,g]=z.useState(!1),u=z.useRef();return z.useEffect(()=>{u.current=Qr({getStoreItems:()=>a.getState(),onNodeMouseDown:d=>{Ht({id:d,store:a,nodeRef:e})},onDragStart:()=>{g(!0)},onDragStop:()=>{g(!1)}})},[]),z.useEffect(()=>{var d,c;if(t)(d=u.current)==null||d.destroy();else if(e.current)return(c=u.current)==null||c.update({noDragClassName:n,handleSelector:o,domNode:e.current,isSelectable:r,nodeId:s,nodeClickDistance:i}),()=>{var h;(h=u.current)==null||h.destroy()}},[n,o,t,r,e,s]),l}const ua=e=>t=>t.selected&&(t.draggable||e&&typeof t.draggable>"u");function Ao(){const e=ne();return z.useCallback(n=>{const{nodeExtent:o,snapToGrid:s,snapGrid:r,nodesDraggable:i,onError:a,updateNodePositions:l,nodeLookup:g,nodeOrigin:u}=e.getState(),d=new Map,c=ua(i),h=s?r[0]:5,y=s?r[1]:5,m=n.direction.x*h*n.factor,w=n.direction.y*y*n.factor;for(const[,p]of g){if(!c(p))continue;let N={x:p.internals.positionAbsolute.x+m,y:p.internals.positionAbsolute.y+w};s&&(N=dt(N,r));const{position:f,positionAbsolute:b}=eo({nodeId:p.id,nextPosition:N,nodeLookup:g,nodeExtent:o,nodeOrigin:u,onError:a});p.position=f,p.internals.positionAbsolute=b,d.set(p.id,p)}l(d)},[])}const Gt=z.createContext(null),da=Gt.Provider;Gt.Consumer;const To=()=>z.useContext(Gt),fa=e=>({connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName,rfId:e.rfId}),ha=(e,t,n)=>o=>{const{connectionClickStartHandle:s,connectionMode:r,connection:i}=o,{fromHandle:a,toHandle:l,isValid:g}=i,u=(l==null?void 0:l.nodeId)===e&&(l==null?void 0:l.id)===t&&(l==null?void 0:l.type)===n;return{connectingFrom:(a==null?void 0:a.nodeId)===e&&(a==null?void 0:a.id)===t&&(a==null?void 0:a.type)===n,connectingTo:u,clickConnecting:(s==null?void 0:s.nodeId)===e&&(s==null?void 0:s.id)===t&&(s==null?void 0:s.type)===n,isPossibleEndHandle:r===Me.Strict?(a==null?void 0:a.type)!==n:e!==(a==null?void 0:a.nodeId)||t!==(a==null?void 0:a.id),connectionInProcess:!!a,clickConnectionInProcess:!!s,valid:u&&g}};function ga({type:e="source",position:t=O.Top,isValidConnection:n,isConnectable:o=!0,isConnectableStart:s=!0,isConnectableEnd:r=!0,id:i,onConnect:a,children:l,className:g,onMouseDown:u,onTouchStart:d,...c},h){var C,S;const y=i||null,m=e==="target",w=ne(),p=To(),{connectOnClick:N,noPanClassName:f,rfId:b}=J(fa,oe),{connectingFrom:v,connectingTo:I,clickConnecting:_,isPossibleEndHandle:P,connectionInProcess:j,clickConnectionInProcess:D,valid:$}=J(ha(p,y,e),oe);p||(S=(C=w.getState()).onError)==null||S.call(C,"010",ue.error010());const H=M=>{const{defaultEdgeOptions:A,onConnect:k,hasDefaultEdges:T}=w.getState(),L={...A,...M};if(T){const{edges:B,setEdges:W}=w.getState();W(Dr(L,B))}k==null||k(L),a==null||a(L)},R=M=>{if(!p)return;const A=co(M.nativeEvent);if(s&&(A&&M.button===0||!A)){const k=w.getState();jt.onPointerDown(M.nativeEvent,{autoPanOnConnect:k.autoPanOnConnect,connectionMode:k.connectionMode,connectionRadius:k.connectionRadius,domNode:k.domNode,nodeLookup:k.nodeLookup,lib:k.lib,isTarget:m,handleId:y,nodeId:p,flowId:k.rfId,panBy:k.panBy,cancelConnection:k.cancelConnection,onConnectStart:k.onConnectStart,onConnectEnd:k.onConnectEnd,updateConnection:k.updateConnection,onConnect:H,isValidConnection:n||k.isValidConnection,getTransform:()=>w.getState().transform,getFromHandle:()=>w.getState().connection.fromHandle,autoPanSpeed:k.autoPanSpeed,dragThreshold:k.connectionDragThreshold})}A?u==null||u(M):d==null||d(M)},x=M=>{const{onClickConnectStart:A,onClickConnectEnd:k,connectionClickStartHandle:T,connectionMode:L,isValidConnection:B,lib:W,rfId:V,nodeLookup:X,connection:G}=w.getState();if(!p||!T&&!s)return;if(!T){A==null||A(M.nativeEvent,{nodeId:p,handleId:y,handleType:e}),w.setState({connectionClickStartHandle:{nodeId:p,type:e,id:y}});return}const Y=io(M.target),F=n||B,{connection:U,isValid:ee}=jt.isValid(M.nativeEvent,{handle:{nodeId:p,id:y,type:e},connectionMode:L,fromNodeId:T.nodeId,fromHandleId:T.id||null,fromType:T.type,isValidConnection:F,flowId:V,doc:Y,lib:W,nodeLookup:X});ee&&U&&H(U);const Q=structuredClone(G);delete Q.inProgress,Q.toPosition=Q.toHandle?Q.toHandle.position:null,k==null||k(M,Q),w.setState({connectionClickStartHandle:null})};return E.jsx("div",{"data-handleid":y,"data-nodeid":p,"data-handlepos":t,"data-id":`${b}-${p}-${y}-${e}`,className:re(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",f,g,{source:!m,target:m,connectable:o,connectablestart:s,connectableend:r,clickconnecting:_,connectingfrom:v,connectingto:I,valid:$,connectionindicator:o&&(!j||P)&&(j||D?r:s)}]),onMouseDown:R,onTouchStart:R,onClick:N?x:void 0,ref:h,...c,children:l})}const ze=z.memo(Po(ga));function pa({data:e,isConnectable:t,sourcePosition:n=O.Bottom}){return E.jsxs(E.Fragment,{children:[e==null?void 0:e.label,E.jsx(ze,{type:"source",position:n,isConnectable:t})]})}function ma({data:e,isConnectable:t,targetPosition:n=O.Top,sourcePosition:o=O.Bottom}){return E.jsxs(E.Fragment,{children:[E.jsx(ze,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label,E.jsx(ze,{type:"source",position:o,isConnectable:t})]})}function xa(){return null}function ya({data:e,isConnectable:t,targetPosition:n=O.Top}){return E.jsxs(E.Fragment,{children:[E.jsx(ze,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label]})}const ct={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},An={input:pa,default:ma,output:ya,group:xa};function ba(e){var t,n,o,s;return e.internals.handleBounds===void 0?{width:e.width??e.initialWidth??((t=e.style)==null?void 0:t.width),height:e.height??e.initialHeight??((n=e.style)==null?void 0:n.height)}:{width:e.width??((o=e.style)==null?void 0:o.width),height:e.height??((s=e.style)==null?void 0:s.height)}}const wa=e=>{const{width:t,height:n,x:o,y:s}=Oe(e.nodeLookup,{filter:r=>!!r.selected});return{width:ce(t)?t:null,height:ce(n)?n:null,userSelectionActive:e.userSelectionActive,transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]}) translate(${o}px,${s}px)`}};function va({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const o=ne(),{width:s,height:r,transformString:i,userSelectionActive:a}=J(wa,oe),l=Ao(),g=z.useRef(null);if(z.useEffect(()=>{var c;n||(c=g.current)==null||c.focus({preventScroll:!0})},[n]),$o({nodeRef:g}),a||!s||!r)return null;const u=e?c=>{const h=o.getState().nodes.filter(y=>y.selected);e(c,h)}:void 0,d=c=>{Object.prototype.hasOwnProperty.call(ct,c.key)&&(c.preventDefault(),l({direction:ct[c.key],factor:c.shiftKey?4:1}))};return E.jsx("div",{className:re(["react-flow__nodesselection","react-flow__container",t]),style:{transform:i},children:E.jsx("div",{ref:g,className:"react-flow__nodesselection-rect",onContextMenu:u,tabIndex:n?void 0:-1,onKeyDown:n?void 0:d,style:{width:s,height:r}})})}const Tn=typeof window<"u"?window:void 0,Sa=e=>({nodesSelectionActive:e.nodesSelectionActive,userSelectionActive:e.userSelectionActive});function jo({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:o,onPaneMouseLeave:s,onPaneContextMenu:r,onPaneScroll:i,paneClickDistance:a,deleteKeyCode:l,selectionKeyCode:g,selectionOnDrag:u,selectionMode:d,onSelectionStart:c,onSelectionEnd:h,multiSelectionKeyCode:y,panActivationKeyCode:m,zoomActivationKeyCode:w,elementsSelectable:p,zoomOnScroll:N,zoomOnPinch:f,panOnScroll:b,panOnScrollSpeed:v,panOnScrollMode:I,zoomOnDoubleClick:_,panOnDrag:P,defaultViewport:j,translateExtent:D,minZoom:$,maxZoom:H,preventScrolling:R,onSelectionContextMenu:x,noWheelClassName:C,noPanClassName:S,disableKeyboardA11y:M,onViewportChange:A,isControlledViewport:k}){const{nodesSelectionActive:T,userSelectionActive:L}=J(Sa),B=Fe(g,{target:Tn}),W=Fe(m,{target:Tn}),V=W||P,X=W||b,G=u&&V!==!0,Y=B||L||G;return na({deleteKeyCode:l,multiSelectionKeyCode:y}),E.jsx(ra,{onPaneContextMenu:r,elementsSelectable:p,zoomOnScroll:N,zoomOnPinch:f,panOnScroll:X,panOnScrollSpeed:v,panOnScrollMode:I,zoomOnDoubleClick:_,panOnDrag:!B&&V,defaultViewport:j,translateExtent:D,minZoom:$,maxZoom:H,zoomActivationKeyCode:w,preventScrolling:R,noWheelClassName:C,noPanClassName:S,onViewportChange:A,isControlledViewport:k,paneClickDistance:a,children:E.jsxs(la,{onSelectionStart:c,onSelectionEnd:h,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:o,onPaneMouseLeave:s,onPaneContextMenu:r,onPaneScroll:i,panOnDrag:V,isSelecting:!!Y,selectionMode:d,selectionKeyPressed:B,selectionOnDrag:G,children:[e,T&&E.jsx(va,{onSelectionContextMenu:x,noPanClassName:S,disableKeyboardA11y:M})]})})}jo.displayName="FlowRenderer";const Ea=z.memo(jo),Na=e=>t=>e?Dt(t.nodeLookup,{x:0,y:0,width:t.width,height:t.height},t.transform,!0).map(n=>n.id):Array.from(t.nodeLookup.keys());function Ca(e){return J(z.useCallback(Na(e),[e]),oe)}const Ma=e=>e.updateNodeInternals;function ka(){const e=J(Ma),[t]=z.useState(()=>typeof ResizeObserver>"u"?null:new ResizeObserver(n=>{const o=new Map;n.forEach(s=>{const r=s.target.getAttribute("data-id");o.set(r,{id:r,nodeElement:s.target,force:!0})}),e(o)}));return z.useEffect(()=>()=>{t==null||t.disconnect()},[t]),t}function Ia({node:e,nodeType:t,hasDimensions:n,resizeObserver:o}){const s=ne(),r=z.useRef(null),i=z.useRef(null),a=z.useRef(e.sourcePosition),l=z.useRef(e.targetPosition),g=z.useRef(t),u=n&&!!e.internals.handleBounds;return z.useEffect(()=>{r.current&&!e.hidden&&(!u||i.current!==r.current)&&(i.current&&(o==null||o.unobserve(i.current)),o==null||o.observe(r.current),i.current=r.current)},[u,e.hidden]),z.useEffect(()=>()=>{i.current&&(o==null||o.unobserve(i.current),i.current=null)},[]),z.useEffect(()=>{if(r.current){const d=g.current!==t,c=a.current!==e.sourcePosition,h=l.current!==e.targetPosition;(d||c||h)&&(g.current=t,a.current=e.sourcePosition,l.current=e.targetPosition,s.getState().updateNodeInternals(new Map([[e.id,{id:e.id,nodeElement:r.current,force:!0}]])))}},[e.id,t,e.sourcePosition,e.targetPosition]),r}function _a({id:e,onClick:t,onMouseEnter:n,onMouseMove:o,onMouseLeave:s,onContextMenu:r,onDoubleClick:i,nodesDraggable:a,elementsSelectable:l,nodesConnectable:g,nodesFocusable:u,resizeObserver:d,noDragClassName:c,noPanClassName:h,disableKeyboardA11y:y,rfId:m,nodeTypes:w,nodeClickDistance:p,onError:N}){const{node:f,internals:b,isParent:v}=J(F=>{const U=F.nodeLookup.get(e),ee=F.parentLookup.has(e);return{node:U,internals:U.internals,isParent:ee}},oe);let I=f.type||"default",_=(w==null?void 0:w[I])||An[I];_===void 0&&(N==null||N("003",ue.error003(I)),I="default",_=(w==null?void 0:w.default)||An.default);const P=!!(f.draggable||a&&typeof f.draggable>"u"),j=!!(f.selectable||l&&typeof f.selectable>"u"),D=!!(f.connectable||g&&typeof f.connectable>"u"),$=!!(f.focusable||u&&typeof f.focusable>"u"),H=ne(),R=so(f),x=Ia({node:f,nodeType:I,hasDimensions:R,resizeObserver:d}),C=$o({nodeRef:x,disabled:f.hidden||!P,noDragClassName:c,handleSelector:f.dragHandle,nodeId:e,isSelectable:j,nodeClickDistance:p}),S=Ao();if(f.hidden)return null;const M=fe(f),A=ba(f),k=j||P||t||n||o||s,T=n?F=>n(F,{...b.userNode}):void 0,L=o?F=>o(F,{...b.userNode}):void 0,B=s?F=>s(F,{...b.userNode}):void 0,W=r?F=>r(F,{...b.userNode}):void 0,V=i?F=>i(F,{...b.userNode}):void 0,X=F=>{const{selectNodesOnDrag:U,nodeDragThreshold:ee}=H.getState();j&&(!U||!P||ee>0)&&Ht({id:e,store:H,nodeRef:x}),t&&t(F,{...b.userNode})},G=F=>{if(!(ao(F.nativeEvent)||y)){if(qn.includes(F.key)&&j){const U=F.key==="Escape";Ht({id:e,store:H,unselect:U,nodeRef:x})}else if(P&&f.selected&&Object.prototype.hasOwnProperty.call(ct,F.key)){F.preventDefault();const{ariaLabelConfig:U}=H.getState();H.setState({ariaLiveMessage:U["node.a11yDescription.ariaLiveMessage"]({direction:F.key.replace("Arrow","").toLowerCase(),x:~~b.positionAbsolute.x,y:~~b.positionAbsolute.y})}),S({direction:ct[F.key],factor:F.shiftKey?4:1})}}},Y=()=>{var Z;if(y||!((Z=x.current)!=null&&Z.matches(":focus-visible")))return;const{transform:F,width:U,height:ee,autoPanOnNodeFocus:Q,setCenter:q}=H.getState();if(!Q)return;Dt(new Map([[e,f]]),{x:0,y:0,width:U,height:ee},F,!0).length>0||q(f.position.x+M.width/2,f.position.y+M.height/2,{zoom:F[2]})};return E.jsx("div",{className:re(["react-flow__node",`react-flow__node-${I}`,{[h]:P},f.className,{selected:f.selected,selectable:j,parent:v,draggable:P,dragging:C}]),ref:x,style:{zIndex:b.z,transform:`translate(${b.positionAbsolute.x}px,${b.positionAbsolute.y}px)`,pointerEvents:k?"all":"none",visibility:R?"visible":"hidden",...f.style,...A},"data-id":e,"data-testid":`rf__node-${e}`,onMouseEnter:T,onMouseMove:L,onMouseLeave:B,onContextMenu:W,onClick:X,onDoubleClick:V,onKeyDown:$?G:void 0,tabIndex:$?0:void 0,onFocus:$?Y:void 0,role:f.ariaRole??($?"group":void 0),"aria-roledescription":"node","aria-describedby":y?void 0:`${Mo}-${m}`,"aria-label":f.ariaLabel,...f.domAttributes,children:E.jsx(da,{value:e,children:E.jsx(_,{id:e,data:f.data,type:I,positionAbsoluteX:b.positionAbsolute.x,positionAbsoluteY:b.positionAbsolute.y,selected:f.selected??!1,selectable:j,draggable:P,deletable:f.deletable??!0,isConnectable:D,sourcePosition:f.sourcePosition,targetPosition:f.targetPosition,dragging:C,dragHandle:f.dragHandle,zIndex:b.z,parentId:f.parentId,...M})})})}const Pa=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,onError:e.onError});function Ho(e){const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:o,elementsSelectable:s,onError:r}=J(Pa,oe),i=Ca(e.onlyRenderVisibleElements),a=ka();return E.jsx("div",{className:"react-flow__nodes",style:pt,children:i.map(l=>E.jsx(_a,{id:l,nodeTypes:e.nodeTypes,nodeExtent:e.nodeExtent,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,resizeObserver:a,nodesDraggable:t,nodesConnectable:n,nodesFocusable:o,elementsSelectable:s,nodeClickDistance:e.nodeClickDistance,onError:r},l))})}Ho.displayName="NodeRenderer";const za=z.memo(Ho);function $a(e){return J(z.useCallback(n=>{if(!e)return n.edges.map(s=>s.id);const o=[];if(n.width&&n.height)for(const s of n.edges){const r=n.nodeLookup.get(s.source),i=n.nodeLookup.get(s.target);r&&i&&Hr({sourceNode:r,targetNode:i,width:n.width,height:n.height,transform:n.transform})&&o.push(s.id)}return o},[e]),oe)}const Aa=({color:e="none",strokeWidth:t=1})=>E.jsx("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),Ta=({color:e="none",strokeWidth:t=1})=>E.jsx("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),jn={[st.Arrow]:Aa,[st.ArrowClosed]:Ta};function ja(e){const t=ne();return z.useMemo(()=>{var s,r;return Object.prototype.hasOwnProperty.call(jn,e)?jn[e]:((r=(s=t.getState()).onError)==null||r.call(s,"009",ue.error009(e)),null)},[e])}const Ha=({id:e,type:t,color:n,width:o=12.5,height:s=12.5,markerUnits:r="strokeWidth",strokeWidth:i,orient:a="auto-start-reverse"})=>{const l=ja(t);return l?E.jsx("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${o}`,markerHeight:`${s}`,viewBox:"-10 -10 20 20",markerUnits:r,orient:a,refX:"0",refY:"0",children:E.jsx(l,{color:n,strokeWidth:i})}):null},Ro=({defaultColor:e,rfId:t})=>{const n=J(r=>r.edges),o=J(r=>r.defaultEdgeOptions),s=z.useMemo(()=>Or(n,{id:t,defaultColor:e,defaultMarkerStart:o==null?void 0:o.markerStart,defaultMarkerEnd:o==null?void 0:o.markerEnd}),[n,o,t,e]);return s.length?E.jsx("svg",{className:"react-flow__marker","aria-hidden":"true",children:E.jsx("defs",{children:s.map(r=>E.jsx(Ha,{id:r.id,type:r.type,color:r.color,width:r.width,height:r.height,markerUnits:r.markerUnits,strokeWidth:r.strokeWidth,orient:r.orient},r.id))})}):null};Ro.displayName="MarkerDefinitions";var Ra=z.memo(Ro);function Lo({x:e,y:t,label:n,labelStyle:o,labelShowBg:s=!0,labelBgStyle:r,labelBgPadding:i=[2,4],labelBgBorderRadius:a=2,children:l,className:g,...u}){const[d,c]=z.useState({x:1,y:0,width:0,height:0}),h=re(["react-flow__edge-textwrapper",g]),y=z.useRef(null);return z.useEffect(()=>{if(y.current){const m=y.current.getBBox();c({x:m.x,y:m.y,width:m.width,height:m.height})}},[n]),n?E.jsxs("g",{transform:`translate(${e-d.width/2} ${t-d.height/2})`,className:h,visibility:d.width?"visible":"hidden",...u,children:[s&&E.jsx("rect",{width:d.width+2*i[0],x:-i[0],y:-i[1],height:d.height+2*i[1],className:"react-flow__edge-textbg",style:r,rx:a,ry:a}),E.jsx("text",{className:"react-flow__edge-text",y:d.height/2,dy:"0.3em",ref:y,style:o,children:n}),l]}):null}Lo.displayName="EdgeText";const La=z.memo(Lo);function mt({path:e,labelX:t,labelY:n,label:o,labelStyle:s,labelShowBg:r,labelBgStyle:i,labelBgPadding:a,labelBgBorderRadius:l,interactionWidth:g=20,...u}){return E.jsxs(E.Fragment,{children:[E.jsx("path",{...u,d:e,fill:"none",className:re(["react-flow__edge-path",u.className])}),g&&E.jsx("path",{d:e,fill:"none",strokeOpacity:0,strokeWidth:g,className:"react-flow__edge-interaction"}),o&&ce(t)&&ce(n)?E.jsx(La,{x:t,y:n,label:o,labelStyle:s,labelShowBg:r,labelBgStyle:i,labelBgPadding:a,labelBgBorderRadius:l}):null]})}function Hn({pos:e,x1:t,y1:n,x2:o,y2:s}){return e===O.Left||e===O.Right?[.5*(t+o),n]:[t,.5*(n+s)]}function Do({sourceX:e,sourceY:t,sourcePosition:n=O.Bottom,targetX:o,targetY:s,targetPosition:r=O.Top}){const[i,a]=Hn({pos:n,x1:e,y1:t,x2:o,y2:s}),[l,g]=Hn({pos:r,x1:o,y1:s,x2:e,y2:t}),[u,d,c,h]=lo({sourceX:e,sourceY:t,targetX:o,targetY:s,sourceControlX:i,sourceControlY:a,targetControlX:l,targetControlY:g});return[`M${e},${t} C${i},${a} ${l},${g} ${o},${s}`,u,d,c,h]}function Bo(e){return z.memo(({id:t,sourceX:n,sourceY:o,targetX:s,targetY:r,sourcePosition:i,targetPosition:a,label:l,labelStyle:g,labelShowBg:u,labelBgStyle:d,labelBgPadding:c,labelBgBorderRadius:h,style:y,markerEnd:m,markerStart:w,interactionWidth:p})=>{const[N,f,b]=Do({sourceX:n,sourceY:o,sourcePosition:i,targetX:s,targetY:r,targetPosition:a}),v=e.isInternal?void 0:t;return E.jsx(mt,{id:v,path:N,labelX:f,labelY:b,label:l,labelStyle:g,labelShowBg:u,labelBgStyle:d,labelBgPadding:c,labelBgBorderRadius:h,style:y,markerEnd:m,markerStart:w,interactionWidth:p})})}const Da=Bo({isInternal:!1}),Vo=Bo({isInternal:!0});Da.displayName="SimpleBezierEdge";Vo.displayName="SimpleBezierEdgeInternal";function Fo(e){return z.memo(({id:t,sourceX:n,sourceY:o,targetX:s,targetY:r,label:i,labelStyle:a,labelShowBg:l,labelBgStyle:g,labelBgPadding:u,labelBgBorderRadius:d,style:c,sourcePosition:h=O.Bottom,targetPosition:y=O.Top,markerEnd:m,markerStart:w,pathOptions:p,interactionWidth:N})=>{const[f,b,v]=$t({sourceX:n,sourceY:o,sourcePosition:h,targetX:s,targetY:r,targetPosition:y,borderRadius:p==null?void 0:p.borderRadius,offset:p==null?void 0:p.offset,stepPosition:p==null?void 0:p.stepPosition}),I=e.isInternal?void 0:t;return E.jsx(mt,{id:I,path:f,labelX:b,labelY:v,label:i,labelStyle:a,labelShowBg:l,labelBgStyle:g,labelBgPadding:u,labelBgBorderRadius:d,style:c,markerEnd:m,markerStart:w,interactionWidth:N})})}const Wo=Fo({isInternal:!1}),Oo=Fo({isInternal:!0});Wo.displayName="SmoothStepEdge";Oo.displayName="SmoothStepEdgeInternal";function Yo(e){return z.memo(({id:t,...n})=>{var s;const o=e.isInternal?void 0:t;return E.jsx(Wo,{...n,id:o,pathOptions:z.useMemo(()=>{var r;return{borderRadius:0,offset:(r=n.pathOptions)==null?void 0:r.offset}},[(s=n.pathOptions)==null?void 0:s.offset])})})}const Ba=Yo({isInternal:!1}),Xo=Yo({isInternal:!0});Ba.displayName="StepEdge";Xo.displayName="StepEdgeInternal";function Go(e){return z.memo(({id:t,sourceX:n,sourceY:o,targetX:s,targetY:r,label:i,labelStyle:a,labelShowBg:l,labelBgStyle:g,labelBgPadding:u,labelBgBorderRadius:d,style:c,markerEnd:h,markerStart:y,interactionWidth:m})=>{const[w,p,N]=ho({sourceX:n,sourceY:o,targetX:s,targetY:r}),f=e.isInternal?void 0:t;return E.jsx(mt,{id:f,path:w,labelX:p,labelY:N,label:i,labelStyle:a,labelShowBg:l,labelBgStyle:g,labelBgPadding:u,labelBgBorderRadius:d,style:c,markerEnd:h,markerStart:y,interactionWidth:m})})}const Va=Go({isInternal:!1}),Uo=Go({isInternal:!0});Va.displayName="StraightEdge";Uo.displayName="StraightEdgeInternal";function qo(e){return z.memo(({id:t,sourceX:n,sourceY:o,targetX:s,targetY:r,sourcePosition:i=O.Bottom,targetPosition:a=O.Top,label:l,labelStyle:g,labelShowBg:u,labelBgStyle:d,labelBgPadding:c,labelBgBorderRadius:h,style:y,markerEnd:m,markerStart:w,pathOptions:p,interactionWidth:N})=>{const[f,b,v]=uo({sourceX:n,sourceY:o,sourcePosition:i,targetX:s,targetY:r,targetPosition:a,curvature:p==null?void 0:p.curvature}),I=e.isInternal?void 0:t;return E.jsx(mt,{id:I,path:f,labelX:b,labelY:v,label:l,labelStyle:g,labelShowBg:u,labelBgStyle:d,labelBgPadding:c,labelBgBorderRadius:h,style:y,markerEnd:m,markerStart:w,interactionWidth:N})})}const Fa=qo({isInternal:!1}),Zo=qo({isInternal:!0});Fa.displayName="BezierEdge";Zo.displayName="BezierEdgeInternal";const Rn={default:Zo,straight:Uo,step:Xo,smoothstep:Oo,simplebezier:Vo},Ln={sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null},Wa=(e,t,n)=>n===O.Left?e-t:n===O.Right?e+t:e,Oa=(e,t,n)=>n===O.Top?e-t:n===O.Bottom?e+t:e,Dn="react-flow__edgeupdater";function Bn({position:e,centerX:t,centerY:n,radius:o=10,onMouseDown:s,onMouseEnter:r,onMouseOut:i,type:a}){return E.jsx("circle",{onMouseDown:s,onMouseEnter:r,onMouseOut:i,className:re([Dn,`${Dn}-${a}`]),cx:Wa(t,o,e),cy:Oa(n,o,e),r:o,stroke:"transparent",fill:"transparent"})}function Ya({isReconnectable:e,reconnectRadius:t,edge:n,sourceX:o,sourceY:s,targetX:r,targetY:i,sourcePosition:a,targetPosition:l,onReconnect:g,onReconnectStart:u,onReconnectEnd:d,setReconnecting:c,setUpdateHover:h}){const y=ne(),m=(b,v)=>{if(b.button!==0)return;const{autoPanOnConnect:I,domNode:_,isValidConnection:P,connectionMode:j,connectionRadius:D,lib:$,onConnectStart:H,onConnectEnd:R,cancelConnection:x,nodeLookup:C,rfId:S,panBy:M,updateConnection:A}=y.getState(),k=v.type==="target",T=(W,V)=>{c(!1),d==null||d(W,n,v.type,V)},L=W=>g==null?void 0:g(n,W),B=(W,V)=>{c(!0),u==null||u(b,n,v.type),H==null||H(W,V)};jt.onPointerDown(b.nativeEvent,{autoPanOnConnect:I,connectionMode:j,connectionRadius:D,domNode:_,handleId:v.id,nodeId:v.nodeId,nodeLookup:C,isTarget:k,edgeUpdaterType:v.type,lib:$,flowId:S,cancelConnection:x,panBy:M,isValidConnection:P,onConnect:L,onConnectStart:B,onConnectEnd:R,onReconnectEnd:T,updateConnection:A,getTransform:()=>y.getState().transform,getFromHandle:()=>y.getState().connection.fromHandle,dragThreshold:y.getState().connectionDragThreshold})},w=b=>m(b,{nodeId:n.target,id:n.targetHandle??null,type:"target"}),p=b=>m(b,{nodeId:n.source,id:n.sourceHandle??null,type:"source"}),N=()=>h(!0),f=()=>h(!1);return E.jsxs(E.Fragment,{children:[(e===!0||e==="source")&&E.jsx(Bn,{position:a,centerX:o,centerY:s,radius:t,onMouseDown:w,onMouseEnter:N,onMouseOut:f,type:"source"}),(e===!0||e==="target")&&E.jsx(Bn,{position:l,centerX:r,centerY:i,radius:t,onMouseDown:p,onMouseEnter:N,onMouseOut:f,type:"target"})]})}function Xa({id:e,edgesFocusable:t,edgesReconnectable:n,elementsSelectable:o,onClick:s,onDoubleClick:r,onContextMenu:i,onMouseEnter:a,onMouseMove:l,onMouseLeave:g,reconnectRadius:u,onReconnect:d,onReconnectStart:c,onReconnectEnd:h,rfId:y,edgeTypes:m,noPanClassName:w,onError:p,disableKeyboardA11y:N}){let f=J(q=>q.edgeLookup.get(e));const b=J(q=>q.defaultEdgeOptions);f=b?{...b,...f}:f;let v=f.type||"default",I=(m==null?void 0:m[v])||Rn[v];I===void 0&&(p==null||p("011",ue.error011(v)),v="default",I=(m==null?void 0:m.default)||Rn.default);const _=!!(f.focusable||t&&typeof f.focusable>"u"),P=typeof d<"u"&&(f.reconnectable||n&&typeof f.reconnectable>"u"),j=!!(f.selectable||o&&typeof f.selectable>"u"),D=z.useRef(null),[$,H]=z.useState(!1),[R,x]=z.useState(!1),C=ne(),{zIndex:S,sourceX:M,sourceY:A,targetX:k,targetY:T,sourcePosition:L,targetPosition:B}=J(z.useCallback(q=>{const K=q.nodeLookup.get(f.source),Z=q.nodeLookup.get(f.target);if(!K||!Z)return{zIndex:f.zIndex,...Ln};const te=Wr({id:e,sourceNode:K,targetNode:Z,sourceHandle:f.sourceHandle||null,targetHandle:f.targetHandle||null,connectionMode:q.connectionMode,onError:p});return{zIndex:jr({selected:f.selected,zIndex:f.zIndex,sourceNode:K,targetNode:Z,elevateOnSelect:q.elevateEdgesOnSelect}),...te||Ln}},[f.source,f.target,f.sourceHandle,f.targetHandle,f.selected,f.zIndex]),oe),W=z.useMemo(()=>f.markerStart?`url('#${At(f.markerStart,y)}')`:void 0,[f.markerStart,y]),V=z.useMemo(()=>f.markerEnd?`url('#${At(f.markerEnd,y)}')`:void 0,[f.markerEnd,y]);if(f.hidden||M===null||A===null||k===null||T===null)return null;const X=q=>{var se;const{addSelectedEdges:K,unselectNodesAndEdges:Z,multiSelectionActive:te}=C.getState();j&&(C.setState({nodesSelectionActive:!1}),f.selected&&te?(Z({nodes:[],edges:[f]}),(se=D.current)==null||se.blur()):K([e])),s&&s(q,f)},G=r?q=>{r(q,{...f})}:void 0,Y=i?q=>{i(q,{...f})}:void 0,F=a?q=>{a(q,{...f})}:void 0,U=l?q=>{l(q,{...f})}:void 0,ee=g?q=>{g(q,{...f})}:void 0,Q=q=>{var K;if(!N&&qn.includes(q.key)&&j){const{unselectNodesAndEdges:Z,addSelectedEdges:te}=C.getState();q.key==="Escape"?((K=D.current)==null||K.blur(),Z({edges:[f]})):te([e])}};return E.jsx("svg",{style:{zIndex:S},children:E.jsxs("g",{className:re(["react-flow__edge",`react-flow__edge-${v}`,f.className,w,{selected:f.selected,animated:f.animated,inactive:!j&&!s,updating:$,selectable:j}]),onClick:X,onDoubleClick:G,onContextMenu:Y,onMouseEnter:F,onMouseMove:U,onMouseLeave:ee,onKeyDown:_?Q:void 0,tabIndex:_?0:void 0,role:f.ariaRole??(_?"group":"img"),"aria-roledescription":"edge","data-id":e,"data-testid":`rf__edge-${e}`,"aria-label":f.ariaLabel===null?void 0:f.ariaLabel||`Edge from ${f.source} to ${f.target}`,"aria-describedby":_?`${ko}-${y}`:void 0,ref:D,...f.domAttributes,children:[!R&&E.jsx(I,{id:e,source:f.source,target:f.target,type:f.type,selected:f.selected,animated:f.animated,selectable:j,deletable:f.deletable??!0,label:f.label,labelStyle:f.labelStyle,labelShowBg:f.labelShowBg,labelBgStyle:f.labelBgStyle,labelBgPadding:f.labelBgPadding,labelBgBorderRadius:f.labelBgBorderRadius,sourceX:M,sourceY:A,targetX:k,targetY:T,sourcePosition:L,targetPosition:B,data:f.data,style:f.style,sourceHandleId:f.sourceHandle,targetHandleId:f.targetHandle,markerStart:W,markerEnd:V,pathOptions:"pathOptions"in f?f.pathOptions:void 0,interactionWidth:f.interactionWidth}),P&&E.jsx(Ya,{edge:f,isReconnectable:P,reconnectRadius:u,onReconnect:d,onReconnectStart:c,onReconnectEnd:h,sourceX:M,sourceY:A,targetX:k,targetY:T,sourcePosition:L,targetPosition:B,setUpdateHover:H,setReconnecting:x})]})})}const Ga=e=>({edgesFocusable:e.edgesFocusable,edgesReconnectable:e.edgesReconnectable,elementsSelectable:e.elementsSelectable,connectionMode:e.connectionMode,onError:e.onError});function Ko({defaultMarkerColor:e,onlyRenderVisibleElements:t,rfId:n,edgeTypes:o,noPanClassName:s,onReconnect:r,onEdgeContextMenu:i,onEdgeMouseEnter:a,onEdgeMouseMove:l,onEdgeMouseLeave:g,onEdgeClick:u,reconnectRadius:d,onEdgeDoubleClick:c,onReconnectStart:h,onReconnectEnd:y,disableKeyboardA11y:m}){const{edgesFocusable:w,edgesReconnectable:p,elementsSelectable:N,onError:f}=J(Ga,oe),b=$a(t);return E.jsxs("div",{className:"react-flow__edges",children:[E.jsx(Ra,{defaultColor:e,rfId:n}),b.map(v=>E.jsx(Xa,{id:v,edgesFocusable:w,edgesReconnectable:p,elementsSelectable:N,noPanClassName:s,onReconnect:r,onContextMenu:i,onMouseEnter:a,onMouseMove:l,onMouseLeave:g,onClick:u,reconnectRadius:d,onDoubleClick:c,onReconnectStart:h,onReconnectEnd:y,rfId:n,onError:f,edgeTypes:o,disableKeyboardA11y:m},v))]})}Ko.displayName="EdgeRenderer";const Ua=z.memo(Ko),qa=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function Za({children:e}){const t=J(qa);return E.jsx("div",{className:"react-flow__viewport xyflow__viewport react-flow__container",style:{transform:t},children:e})}function Ka(e){const t=Xt(),n=z.useRef(!1);z.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const Qa=e=>{var t;return(t=e.panZoom)==null?void 0:t.syncViewport};function Ja(e){const t=J(Qa),n=ne();return z.useEffect(()=>{e&&(t==null||t(e),n.setState({transform:[e.x,e.y,e.zoom]}))},[e,t]),null}function ec(e){return e.connection.inProgress?{...e.connection,to:Ye(e.connection.to,e.transform)}:{...e.connection}}function tc(e){return ec}function nc(e){const t=tc();return J(t,oe)}const oc=e=>({nodesConnectable:e.nodesConnectable,isValid:e.connection.isValid,inProgress:e.connection.inProgress,width:e.width,height:e.height});function sc({containerStyle:e,style:t,type:n,component:o}){const{nodesConnectable:s,width:r,height:i,isValid:a,inProgress:l}=J(oc,oe);return!(r&&s&&l)?null:E.jsx("svg",{style:e,width:r,height:i,className:"react-flow__connectionline react-flow__container",children:E.jsx("g",{className:re(["react-flow__connection",Qn(a)]),children:E.jsx(Qo,{style:t,type:n,CustomComponent:o,isValid:a})})})}const Qo=({style:e,type:t=pe.Bezier,CustomComponent:n,isValid:o})=>{const{inProgress:s,from:r,fromNode:i,fromHandle:a,fromPosition:l,to:g,toNode:u,toHandle:d,toPosition:c}=nc();if(!s)return;if(n)return E.jsx(n,{connectionLineType:t,connectionLineStyle:e,fromNode:i,fromHandle:a,fromX:r.x,fromY:r.y,toX:g.x,toY:g.y,fromPosition:l,toPosition:c,connectionStatus:Qn(o),toNode:u,toHandle:d});let h="";const y={sourceX:r.x,sourceY:r.y,sourcePosition:l,targetX:g.x,targetY:g.y,targetPosition:c};switch(t){case pe.Bezier:[h]=uo(y);break;case pe.SimpleBezier:[h]=Do(y);break;case pe.Step:[h]=$t({...y,borderRadius:0});break;case pe.SmoothStep:[h]=$t(y);break;default:[h]=ho(y)}return E.jsx("path",{d:h,fill:"none",className:"react-flow__connection-path",style:e})};Qo.displayName="ConnectionLine";const rc={};function Vn(e=rc){z.useRef(e),ne(),z.useEffect(()=>{},[e])}function ic(){ne(),z.useRef(!1),z.useEffect(()=>{},[])}function Jo({nodeTypes:e,edgeTypes:t,onInit:n,onNodeClick:o,onEdgeClick:s,onNodeDoubleClick:r,onEdgeDoubleClick:i,onNodeMouseEnter:a,onNodeMouseMove:l,onNodeMouseLeave:g,onNodeContextMenu:u,onSelectionContextMenu:d,onSelectionStart:c,onSelectionEnd:h,connectionLineType:y,connectionLineStyle:m,connectionLineComponent:w,connectionLineContainerStyle:p,selectionKeyCode:N,selectionOnDrag:f,selectionMode:b,multiSelectionKeyCode:v,panActivationKeyCode:I,zoomActivationKeyCode:_,deleteKeyCode:P,onlyRenderVisibleElements:j,elementsSelectable:D,defaultViewport:$,translateExtent:H,minZoom:R,maxZoom:x,preventScrolling:C,defaultMarkerColor:S,zoomOnScroll:M,zoomOnPinch:A,panOnScroll:k,panOnScrollSpeed:T,panOnScrollMode:L,zoomOnDoubleClick:B,panOnDrag:W,onPaneClick:V,onPaneMouseEnter:X,onPaneMouseMove:G,onPaneMouseLeave:Y,onPaneScroll:F,onPaneContextMenu:U,paneClickDistance:ee,nodeClickDistance:Q,onEdgeContextMenu:q,onEdgeMouseEnter:K,onEdgeMouseMove:Z,onEdgeMouseLeave:te,reconnectRadius:se,onReconnect:de,onReconnectStart:we,onReconnectEnd:Xe,noDragClassName:Ge,noWheelClassName:Ue,noPanClassName:$e,disableKeyboardA11y:Ae,nodeExtent:xt,rfId:qe,viewport:ve,onViewportChange:Te}){return Vn(e),Vn(t),ic(),Ka(n),Ja(ve),E.jsx(Ea,{onPaneClick:V,onPaneMouseEnter:X,onPaneMouseMove:G,onPaneMouseLeave:Y,onPaneContextMenu:U,onPaneScroll:F,paneClickDistance:ee,deleteKeyCode:P,selectionKeyCode:N,selectionOnDrag:f,selectionMode:b,onSelectionStart:c,onSelectionEnd:h,multiSelectionKeyCode:v,panActivationKeyCode:I,zoomActivationKeyCode:_,elementsSelectable:D,zoomOnScroll:M,zoomOnPinch:A,zoomOnDoubleClick:B,panOnScroll:k,panOnScrollSpeed:T,panOnScrollMode:L,panOnDrag:W,defaultViewport:$,translateExtent:H,minZoom:R,maxZoom:x,onSelectionContextMenu:d,preventScrolling:C,noDragClassName:Ge,noWheelClassName:Ue,noPanClassName:$e,disableKeyboardA11y:Ae,onViewportChange:Te,isControlledViewport:!!ve,children:E.jsxs(Za,{children:[E.jsx(Ua,{edgeTypes:t,onEdgeClick:s,onEdgeDoubleClick:i,onReconnect:de,onReconnectStart:we,onReconnectEnd:Xe,onlyRenderVisibleElements:j,onEdgeContextMenu:q,onEdgeMouseEnter:K,onEdgeMouseMove:Z,onEdgeMouseLeave:te,reconnectRadius:se,defaultMarkerColor:S,noPanClassName:$e,disableKeyboardA11y:Ae,rfId:qe}),E.jsx(sc,{style:m,type:y,component:w,containerStyle:p}),E.jsx("div",{className:"react-flow__edgelabel-renderer"}),E.jsx(za,{nodeTypes:e,onNodeClick:o,onNodeDoubleClick:r,onNodeMouseEnter:a,onNodeMouseMove:l,onNodeMouseLeave:g,onNodeContextMenu:u,nodeClickDistance:Q,onlyRenderVisibleElements:j,noPanClassName:$e,noDragClassName:Ge,disableKeyboardA11y:Ae,nodeExtent:xt,rfId:qe}),E.jsx("div",{className:"react-flow__viewport-portal"})]})})}Jo.displayName="GraphView";const ac=z.memo(Jo),Fn=({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,width:s,height:r,fitView:i,fitViewOptions:a,minZoom:l=.5,maxZoom:g=2,nodeOrigin:u,nodeExtent:d}={})=>{const c=new Map,h=new Map,y=new Map,m=new Map,w=o??t??[],p=n??e??[],N=u??[0,0],f=d??Le;po(y,m,w);const b=Tt(p,c,h,{nodeOrigin:N,nodeExtent:f,elevateNodesOnSelect:!1});let v=[0,0,1];if(i&&s&&r){const I=Oe(c,{filter:D=>!!((D.width||D.initialWidth)&&(D.height||D.initialHeight))}),{x:_,y:P,zoom:j}=Bt(I,s,r,l,g,(a==null?void 0:a.padding)??.1);v=[_,P,j]}return{rfId:"1",width:0,height:0,transform:v,nodes:p,nodesInitialized:b,nodeLookup:c,parentLookup:h,edges:w,edgeLookup:m,connectionLookup:y,onNodesChange:null,onEdgesChange:null,hasDefaultNodes:n!==void 0,hasDefaultEdges:o!==void 0,panZoom:null,minZoom:l,maxZoom:g,translateExtent:Le,nodeExtent:f,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionMode:Me.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:N,nodeDragThreshold:1,connectionDragThreshold:1,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesReconnectable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!1,selectNodesOnDrag:!0,multiSelectionActive:!1,fitViewQueued:i??!1,fitViewOptions:a,fitViewResolver:null,connection:{...Kn},connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,autoPanOnNodeFocus:!0,autoPanSpeed:15,connectionRadius:20,onError:_r,isValidConnection:void 0,onSelectionChangeHandlers:[],lib:"react",debug:!1,ariaLabelConfig:Zn}},cc=({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,width:s,height:r,fitView:i,fitViewOptions:a,minZoom:l,maxZoom:g,nodeOrigin:u,nodeExtent:d})=>Mi((c,h)=>{async function y(){const{nodeLookup:m,panZoom:w,fitViewOptions:p,fitViewResolver:N,width:f,height:b,minZoom:v,maxZoom:I}=h();w&&(await kr({nodes:m,width:f,height:b,panZoom:w,minZoom:v,maxZoom:I},p),N==null||N.resolve(!0),c({fitViewResolver:null}))}return{...Fn({nodes:e,edges:t,width:s,height:r,fitView:i,fitViewOptions:a,minZoom:l,maxZoom:g,nodeOrigin:u,nodeExtent:d,defaultNodes:n,defaultEdges:o}),setNodes:m=>{const{nodeLookup:w,parentLookup:p,nodeOrigin:N,elevateNodesOnSelect:f,fitViewQueued:b}=h(),v=Tt(m,w,p,{nodeOrigin:N,nodeExtent:d,elevateNodesOnSelect:f,checkEquality:!0});b&&v?(y(),c({nodes:m,nodesInitialized:v,fitViewQueued:!1,fitViewOptions:void 0})):c({nodes:m,nodesInitialized:v})},setEdges:m=>{const{connectionLookup:w,edgeLookup:p}=h();po(w,p,m),c({edges:m})},setDefaultNodesAndEdges:(m,w)=>{if(m){const{setNodes:p}=h();p(m),c({hasDefaultNodes:!0})}if(w){const{setEdges:p}=h();p(w),c({hasDefaultEdges:!0})}},updateNodeInternals:m=>{const{triggerNodeChanges:w,nodeLookup:p,parentLookup:N,domNode:f,nodeOrigin:b,nodeExtent:v,debug:I,fitViewQueued:_}=h(),{changes:P,updatedInternals:j}=qr(m,p,N,f,b,v);j&&(Xr(p,N,{nodeOrigin:b,nodeExtent:v}),_?(y(),c({fitViewQueued:!1,fitViewOptions:void 0})):c({}),(P==null?void 0:P.length)>0&&(I&&console.log("React Flow: trigger node changes",P),w==null||w(P)))},updateNodePositions:(m,w=!1)=>{const p=[],N=[],{nodeLookup:f,triggerNodeChanges:b}=h();for(const[v,I]of m){const _=f.get(v),P=!!(_!=null&&_.expandParent&&(_!=null&&_.parentId)&&(I!=null&&I.position)),j={id:v,type:"position",position:P?{x:Math.max(0,I.position.x),y:Math.max(0,I.position.y)}:I.position,dragging:w};P&&_.parentId&&p.push({id:v,parentId:_.parentId,rect:{...I.internals.positionAbsolute,width:I.measured.width??0,height:I.measured.height??0}}),N.push(j)}if(p.length>0){const{parentLookup:v,nodeOrigin:I}=h(),_=Yt(p,f,v,I);N.push(..._)}b(N)},triggerNodeChanges:m=>{const{onNodesChange:w,setNodes:p,nodes:N,hasDefaultNodes:f,debug:b}=h();if(m!=null&&m.length){if(f){const v=Gi(m,N);p(v)}b&&console.log("React Flow: trigger node changes",m),w==null||w(m)}},triggerEdgeChanges:m=>{const{onEdgesChange:w,setEdges:p,edges:N,hasDefaultEdges:f,debug:b}=h();if(m!=null&&m.length){if(f){const v=Ui(m,N);p(v)}b&&console.log("React Flow: trigger edge changes",m),w==null||w(m)}},addSelectedNodes:m=>{const{multiSelectionActive:w,edgeLookup:p,nodeLookup:N,triggerNodeChanges:f,triggerEdgeChanges:b}=h();if(w){const v=m.map(I=>xe(I,!0));f(v);return}f(Ne(N,new Set([...m]),!0)),b(Ne(p))},addSelectedEdges:m=>{const{multiSelectionActive:w,edgeLookup:p,nodeLookup:N,triggerNodeChanges:f,triggerEdgeChanges:b}=h();if(w){const v=m.map(I=>xe(I,!0));b(v);return}b(Ne(p,new Set([...m]))),f(Ne(N,new Set,!0))},unselectNodesAndEdges:({nodes:m,edges:w}={})=>{const{edges:p,nodes:N,nodeLookup:f,triggerNodeChanges:b,triggerEdgeChanges:v}=h(),I=m||N,_=w||p,P=I.map(D=>{const $=f.get(D.id);return $&&($.selected=!1),xe(D.id,!1)}),j=_.map(D=>xe(D.id,!1));b(P),v(j)},setMinZoom:m=>{const{panZoom:w,maxZoom:p}=h();w==null||w.setScaleExtent([m,p]),c({minZoom:m})},setMaxZoom:m=>{const{panZoom:w,minZoom:p}=h();w==null||w.setScaleExtent([p,m]),c({maxZoom:m})},setTranslateExtent:m=>{var w;(w=h().panZoom)==null||w.setTranslateExtent(m),c({translateExtent:m})},setPaneClickDistance:m=>{var w;(w=h().panZoom)==null||w.setClickDistance(m)},resetSelectedElements:()=>{const{edges:m,nodes:w,triggerNodeChanges:p,triggerEdgeChanges:N,elementsSelectable:f}=h();if(!f)return;const b=w.reduce((I,_)=>_.selected?[...I,xe(_.id,!1)]:I,[]),v=m.reduce((I,_)=>_.selected?[...I,xe(_.id,!1)]:I,[]);p(b),N(v)},setNodeExtent:m=>{const{nodes:w,nodeLookup:p,parentLookup:N,nodeOrigin:f,elevateNodesOnSelect:b,nodeExtent:v}=h();m[0][0]===v[0][0]&&m[0][1]===v[0][1]&&m[1][0]===v[1][0]&&m[1][1]===v[1][1]||(Tt(w,p,N,{nodeOrigin:f,nodeExtent:m,elevateNodesOnSelect:b,checkEquality:!1}),c({nodeExtent:m}))},panBy:m=>{const{transform:w,width:p,height:N,panZoom:f,translateExtent:b}=h();return Zr({delta:m,panZoom:f,transform:w,translateExtent:b,width:p,height:N})},setCenter:async(m,w,p)=>{const{width:N,height:f,maxZoom:b,panZoom:v}=h();if(!v)return Promise.resolve(!1);const I=typeof(p==null?void 0:p.zoom)<"u"?p.zoom:b;return await v.setViewport({x:N/2-m*I,y:f/2-w*I,zoom:I},{duration:p==null?void 0:p.duration,ease:p==null?void 0:p.ease,interpolate:p==null?void 0:p.interpolate}),Promise.resolve(!0)},cancelConnection:()=>{c({connection:{...Kn}})},updateConnection:m=>{c({connection:m})},reset:()=>c({...Fn()})}},Object.is);function lc({initialNodes:e,initialEdges:t,defaultNodes:n,defaultEdges:o,initialWidth:s,initialHeight:r,initialMinZoom:i,initialMaxZoom:a,initialFitViewOptions:l,fitView:g,nodeOrigin:u,nodeExtent:d,children:c}){const[h]=z.useState(()=>cc({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,width:s,height:r,fitView:g,minZoom:i,maxZoom:a,fitViewOptions:l,nodeOrigin:u,nodeExtent:d}));return E.jsx(ki,{value:h,children:E.jsx(Qi,{children:c})})}function uc({children:e,nodes:t,edges:n,defaultNodes:o,defaultEdges:s,width:r,height:i,fitView:a,fitViewOptions:l,minZoom:g,maxZoom:u,nodeOrigin:d,nodeExtent:c}){return z.useContext(ht)?E.jsx(E.Fragment,{children:e}):E.jsx(lc,{initialNodes:t,initialEdges:n,defaultNodes:o,defaultEdges:s,initialWidth:r,initialHeight:i,fitView:a,initialFitViewOptions:l,initialMinZoom:g,initialMaxZoom:u,nodeOrigin:d,nodeExtent:c,children:e})}const dc={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0};function fc({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,className:s,nodeTypes:r,edgeTypes:i,onNodeClick:a,onEdgeClick:l,onInit:g,onMove:u,onMoveStart:d,onMoveEnd:c,onConnect:h,onConnectStart:y,onConnectEnd:m,onClickConnectStart:w,onClickConnectEnd:p,onNodeMouseEnter:N,onNodeMouseMove:f,onNodeMouseLeave:b,onNodeContextMenu:v,onNodeDoubleClick:I,onNodeDragStart:_,onNodeDrag:P,onNodeDragStop:j,onNodesDelete:D,onEdgesDelete:$,onDelete:H,onSelectionChange:R,onSelectionDragStart:x,onSelectionDrag:C,onSelectionDragStop:S,onSelectionContextMenu:M,onSelectionStart:A,onSelectionEnd:k,onBeforeDelete:T,connectionMode:L,connectionLineType:B=pe.Bezier,connectionLineStyle:W,connectionLineComponent:V,connectionLineContainerStyle:X,deleteKeyCode:G="Backspace",selectionKeyCode:Y="Shift",selectionOnDrag:F=!1,selectionMode:U=De.Full,panActivationKeyCode:ee="Space",multiSelectionKeyCode:Q=at()?"Meta":"Control",zoomActivationKeyCode:q=at()?"Meta":"Control",snapToGrid:K,snapGrid:Z,onlyRenderVisibleElements:te=!1,selectNodesOnDrag:se,nodesDraggable:de,autoPanOnNodeFocus:we,nodesConnectable:Xe,nodesFocusable:Ge,nodeOrigin:Ue=Io,edgesFocusable:$e,edgesReconnectable:Ae,elementsSelectable:xt=!0,defaultViewport:qe=Bi,minZoom:ve=.5,maxZoom:Te=2,translateExtent:Ut=Le,preventScrolling:os=!0,nodeExtent:yt,defaultMarkerColor:ss="#b1b1b7",zoomOnScroll:rs=!0,zoomOnPinch:is=!0,panOnScroll:as=!1,panOnScrollSpeed:cs=.5,panOnScrollMode:ls=ye.Free,zoomOnDoubleClick:us=!0,panOnDrag:ds=!0,onPaneClick:fs,onPaneMouseEnter:hs,onPaneMouseMove:gs,onPaneMouseLeave:ps,onPaneScroll:ms,onPaneContextMenu:xs,paneClickDistance:qt=0,nodeClickDistance:ys=0,children:bs,onReconnect:ws,onReconnectStart:vs,onReconnectEnd:Ss,onEdgeContextMenu:Es,onEdgeDoubleClick:Ns,onEdgeMouseEnter:Cs,onEdgeMouseMove:Ms,onEdgeMouseLeave:ks,reconnectRadius:Is=10,onNodesChange:_s,onEdgesChange:Ps,noDragClassName:zs="nodrag",noWheelClassName:$s="nowheel",noPanClassName:Zt="nopan",fitView:Kt,fitViewOptions:Qt,connectOnClick:As,attributionPosition:Ts,proOptions:js,defaultEdgeOptions:Hs,elevateNodesOnSelect:Rs,elevateEdgesOnSelect:Ls,disableKeyboardA11y:Jt=!1,autoPanOnConnect:Ds,autoPanOnNodeDrag:Bs,autoPanSpeed:Vs,connectionRadius:Fs,isValidConnection:Ws,onError:Os,style:Ys,id:en,nodeDragThreshold:Xs,connectionDragThreshold:Gs,viewport:Us,onViewportChange:qs,width:Zs,height:Ks,colorMode:Qs="light",debug:Js,onScroll:Ze,ariaLabelConfig:er,...tr},nr){const bt=en||"1",or=Oi(Qs),sr=z.useCallback(tn=>{tn.currentTarget.scrollTo({top:0,left:0,behavior:"instant"}),Ze==null||Ze(tn)},[Ze]);return E.jsx("div",{"data-testid":"rf__wrapper",...tr,onScroll:sr,style:{...Ys,...dc},ref:nr,className:re(["react-flow",s,or]),id:en,role:"application",children:E.jsxs(uc,{nodes:e,edges:t,width:Zs,height:Ks,fitView:Kt,fitViewOptions:Qt,minZoom:ve,maxZoom:Te,nodeOrigin:Ue,nodeExtent:yt,children:[E.jsx(ac,{onInit:g,onNodeClick:a,onEdgeClick:l,onNodeMouseEnter:N,onNodeMouseMove:f,onNodeMouseLeave:b,onNodeContextMenu:v,onNodeDoubleClick:I,nodeTypes:r,edgeTypes:i,connectionLineType:B,connectionLineStyle:W,connectionLineComponent:V,connectionLineContainerStyle:X,selectionKeyCode:Y,selectionOnDrag:F,selectionMode:U,deleteKeyCode:G,multiSelectionKeyCode:Q,panActivationKeyCode:ee,zoomActivationKeyCode:q,onlyRenderVisibleElements:te,defaultViewport:qe,translateExtent:Ut,minZoom:ve,maxZoom:Te,preventScrolling:os,zoomOnScroll:rs,zoomOnPinch:is,zoomOnDoubleClick:us,panOnScroll:as,panOnScrollSpeed:cs,panOnScrollMode:ls,panOnDrag:ds,onPaneClick:fs,onPaneMouseEnter:hs,onPaneMouseMove:gs,onPaneMouseLeave:ps,onPaneScroll:ms,onPaneContextMenu:xs,paneClickDistance:qt,nodeClickDistance:ys,onSelectionContextMenu:M,onSelectionStart:A,onSelectionEnd:k,onReconnect:ws,onReconnectStart:vs,onReconnectEnd:Ss,onEdgeContextMenu:Es,onEdgeDoubleClick:Ns,onEdgeMouseEnter:Cs,onEdgeMouseMove:Ms,onEdgeMouseLeave:ks,reconnectRadius:Is,defaultMarkerColor:ss,noDragClassName:zs,noWheelClassName:$s,noPanClassName:Zt,rfId:bt,disableKeyboardA11y:Jt,nodeExtent:yt,viewport:Us,onViewportChange:qs}),E.jsx(Wi,{nodes:e,edges:t,defaultNodes:n,defaultEdges:o,onConnect:h,onConnectStart:y,onConnectEnd:m,onClickConnectStart:w,onClickConnectEnd:p,nodesDraggable:de,autoPanOnNodeFocus:we,nodesConnectable:Xe,nodesFocusable:Ge,edgesFocusable:$e,edgesReconnectable:Ae,elementsSelectable:xt,elevateNodesOnSelect:Rs,elevateEdgesOnSelect:Ls,minZoom:ve,maxZoom:Te,nodeExtent:yt,onNodesChange:_s,onEdgesChange:Ps,snapToGrid:K,snapGrid:Z,connectionMode:L,translateExtent:Ut,connectOnClick:As,defaultEdgeOptions:Hs,fitView:Kt,fitViewOptions:Qt,onNodesDelete:D,onEdgesDelete:$,onDelete:H,onNodeDragStart:_,onNodeDrag:P,onNodeDragStop:j,onSelectionDrag:C,onSelectionDragStart:x,onSelectionDragStop:S,onMove:u,onMoveStart:d,onMoveEnd:c,noPanClassName:Zt,nodeOrigin:Ue,rfId:bt,autoPanOnConnect:Ds,autoPanOnNodeDrag:Bs,autoPanSpeed:Vs,onError:Os,connectionRadius:Fs,isValidConnection:Ws,selectNodesOnDrag:se,nodeDragThreshold:Xs,connectionDragThreshold:Gs,onBeforeDelete:T,paneClickDistance:qt,debug:Js,ariaLabelConfig:er}),E.jsx(Di,{onSelectionChange:R}),bs,E.jsx(Ti,{proOptions:js,position:Ts}),E.jsx(Ai,{rfId:bt,disableKeyboardA11y:Jt})]})})}var hc=Po(fc);function gc({dimensions:e,lineWidth:t,variant:n,className:o}){return E.jsx("path",{strokeWidth:t,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`,className:re(["react-flow__background-pattern",n,o])})}function pc({radius:e,className:t}){return E.jsx("circle",{cx:e,cy:e,r:e,className:re(["react-flow__background-pattern","dots",t])})}var me;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(me||(me={}));const mc={[me.Dots]:1,[me.Lines]:1,[me.Cross]:6},xc=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function es({id:e,variant:t=me.Dots,gap:n=20,size:o,lineWidth:s=1,offset:r=0,color:i,bgColor:a,style:l,className:g,patternClassName:u}){const d=z.useRef(null),{transform:c,patternId:h}=J(xc,oe),y=o||mc[t],m=t===me.Dots,w=t===me.Cross,p=Array.isArray(n)?n:[n,n],N=[p[0]*c[2]||1,p[1]*c[2]||1],f=y*c[2],b=Array.isArray(r)?r:[r,r],v=w?[f,f]:N,I=[b[0]*c[2]||1+v[0]/2,b[1]*c[2]||1+v[1]/2],_=`${h}${e||""}`;return E.jsxs("svg",{className:re(["react-flow__background",g]),style:{...l,...pt,"--xy-background-color-props":a,"--xy-background-pattern-color-props":i},ref:d,"data-testid":"rf__background",children:[E.jsx("pattern",{id:_,x:c[0]%N[0],y:c[1]%N[1],width:N[0],height:N[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${I[0]},-${I[1]})`,children:m?E.jsx(pc,{radius:f/2,className:u}):E.jsx(gc,{dimensions:v,lineWidth:s,variant:t,className:u})}),E.jsx("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${_})`})]})}es.displayName="Background";const yc=z.memo(es);function bc(){return E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:E.jsx("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function wc(){return E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:E.jsx("path",{d:"M0 0h32v4.2H0z"})})}function vc(){return E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:E.jsx("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function Sc(){return E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:E.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function Ec(){return E.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:E.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}function nt({children:e,className:t,...n}){return E.jsx("button",{type:"button",className:re(["react-flow__controls-button",t]),...n,children:e})}const Nc=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom,ariaLabelConfig:e.ariaLabelConfig});function ts({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:o=!0,fitViewOptions:s,onZoomIn:r,onZoomOut:i,onFitView:a,onInteractiveChange:l,className:g,children:u,position:d="bottom-left",orientation:c="vertical","aria-label":h}){const y=ne(),{isInteractive:m,minZoomReached:w,maxZoomReached:p,ariaLabelConfig:N}=J(Nc,oe),{zoomIn:f,zoomOut:b,fitView:v}=Xt(),I=()=>{f(),r==null||r()},_=()=>{b(),i==null||i()},P=()=>{v(s),a==null||a()},j=()=>{y.setState({nodesDraggable:!m,nodesConnectable:!m,elementsSelectable:!m}),l==null||l(!m)},D=c==="horizontal"?"horizontal":"vertical";return E.jsxs(gt,{className:re(["react-flow__controls",D,g]),position:d,style:e,"data-testid":"rf__controls","aria-label":h??N["controls.ariaLabel"],children:[t&&E.jsxs(E.Fragment,{children:[E.jsx(nt,{onClick:I,className:"react-flow__controls-zoomin",title:N["controls.zoomIn.ariaLabel"],"aria-label":N["controls.zoomIn.ariaLabel"],disabled:p,children:E.jsx(bc,{})}),E.jsx(nt,{onClick:_,className:"react-flow__controls-zoomout",title:N["controls.zoomOut.ariaLabel"],"aria-label":N["controls.zoomOut.ariaLabel"],disabled:w,children:E.jsx(wc,{})})]}),n&&E.jsx(nt,{className:"react-flow__controls-fitview",onClick:P,title:N["controls.fitView.ariaLabel"],"aria-label":N["controls.fitView.ariaLabel"],children:E.jsx(vc,{})}),o&&E.jsx(nt,{className:"react-flow__controls-interactive",onClick:j,title:N["controls.interactive.ariaLabel"],"aria-label":N["controls.interactive.ariaLabel"],children:m?E.jsx(Ec,{}):E.jsx(Sc,{})}),u]})}ts.displayName="Controls";const Cc=z.memo(ts);function Mc({id:e,x:t,y:n,width:o,height:s,style:r,color:i,strokeColor:a,strokeWidth:l,className:g,borderRadius:u,shapeRendering:d,selected:c,onClick:h}){const{background:y,backgroundColor:m}=r||{},w=i||y||m;return E.jsx("rect",{className:re(["react-flow__minimap-node",{selected:c},g]),x:t,y:n,rx:u,ry:u,width:o,height:s,style:{fill:w,stroke:a,strokeWidth:l},shapeRendering:d,onClick:h?p=>h(p,e):void 0})}const kc=z.memo(Mc),Ic=e=>e.nodes.map(t=>t.id),_t=e=>e instanceof Function?e:()=>e;function _c({nodeStrokeColor:e,nodeColor:t,nodeClassName:n="",nodeBorderRadius:o=5,nodeStrokeWidth:s,nodeComponent:r=kc,onClick:i}){const a=J(Ic,oe),l=_t(t),g=_t(e),u=_t(n),d=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return E.jsx(E.Fragment,{children:a.map(c=>E.jsx(zc,{id:c,nodeColorFunc:l,nodeStrokeColorFunc:g,nodeClassNameFunc:u,nodeBorderRadius:o,nodeStrokeWidth:s,NodeComponent:r,onClick:i,shapeRendering:d},c))})}function Pc({id:e,nodeColorFunc:t,nodeStrokeColorFunc:n,nodeClassNameFunc:o,nodeBorderRadius:s,nodeStrokeWidth:r,shapeRendering:i,NodeComponent:a,onClick:l}){const{node:g,x:u,y:d,width:c,height:h}=J(y=>{const{internals:m}=y.nodeLookup.get(e),w=m.userNode,{x:p,y:N}=m.positionAbsolute,{width:f,height:b}=fe(w);return{node:w,x:p,y:N,width:f,height:b}},oe);return!g||g.hidden||!so(g)?null:E.jsx(a,{x:u,y:d,width:c,height:h,style:g.style,selected:!!g.selected,className:o(g),color:t(g),borderRadius:s,strokeColor:n(g),strokeWidth:r,shapeRendering:i,onClick:l,id:g.id})}const zc=z.memo(Pc);var $c=z.memo(_c);const Ac=200,Tc=150,jc=e=>!e.hidden,Hc=e=>{const t={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:t,boundingRect:e.nodeLookup.size>0?oo(Oe(e.nodeLookup,{filter:jc}),t):t,rfId:e.rfId,panZoom:e.panZoom,translateExtent:e.translateExtent,flowWidth:e.width,flowHeight:e.height,ariaLabelConfig:e.ariaLabelConfig}},Rc="react-flow__minimap-desc";function ns({style:e,className:t,nodeStrokeColor:n,nodeColor:o,nodeClassName:s="",nodeBorderRadius:r=5,nodeStrokeWidth:i,nodeComponent:a,bgColor:l,maskColor:g,maskStrokeColor:u,maskStrokeWidth:d,position:c="bottom-right",onClick:h,onNodeClick:y,pannable:m=!1,zoomable:w=!1,ariaLabel:p,inversePan:N,zoomStep:f=10,offsetScale:b=5}){const v=ne(),I=z.useRef(null),{boundingRect:_,viewBB:P,rfId:j,panZoom:D,translateExtent:$,flowWidth:H,flowHeight:R,ariaLabelConfig:x}=J(Hc,oe),C=(e==null?void 0:e.width)??Ac,S=(e==null?void 0:e.height)??Tc,M=_.width/C,A=_.height/S,k=Math.max(M,A),T=k*C,L=k*S,B=b*k,W=_.x-(T-_.width)/2-B,V=_.y-(L-_.height)/2-B,X=T+B*2,G=L+B*2,Y=`${Rc}-${j}`,F=z.useRef(0),U=z.useRef();F.current=k,z.useEffect(()=>{if(I.current&&D)return U.current=si({domNode:I.current,panZoom:D,getTransform:()=>v.getState().transform,getViewScale:()=>F.current}),()=>{var K;(K=U.current)==null||K.destroy()}},[D]),z.useEffect(()=>{var K;(K=U.current)==null||K.update({translateExtent:$,width:H,height:R,inversePan:N,pannable:m,zoomStep:f,zoomable:w})},[m,w,N,f,$,H,R]);const ee=h?K=>{var se;const[Z,te]=((se=U.current)==null?void 0:se.pointer(K))||[0,0];h(K,{x:Z,y:te})}:void 0,Q=y?z.useCallback((K,Z)=>{const te=v.getState().nodeLookup.get(Z).internals.userNode;y(K,te)},[]):void 0,q=p??x["minimap.ariaLabel"];return E.jsx(gt,{position:c,style:{...e,"--xy-minimap-background-color-props":typeof l=="string"?l:void 0,"--xy-minimap-mask-background-color-props":typeof g=="string"?g:void 0,"--xy-minimap-mask-stroke-color-props":typeof u=="string"?u:void 0,"--xy-minimap-mask-stroke-width-props":typeof d=="number"?d*k:void 0,"--xy-minimap-node-background-color-props":typeof o=="string"?o:void 0,"--xy-minimap-node-stroke-color-props":typeof n=="string"?n:void 0,"--xy-minimap-node-stroke-width-props":typeof i=="number"?i:void 0},className:re(["react-flow__minimap",t]),"data-testid":"rf__minimap",children:E.jsxs("svg",{width:C,height:S,viewBox:`${W} ${V} ${X} ${G}`,className:"react-flow__minimap-svg",role:"img","aria-labelledby":Y,ref:I,onClick:ee,children:[q&&E.jsx("title",{id:Y,children:q}),E.jsx($c,{onClick:Q,nodeColor:o,nodeStrokeColor:n,nodeBorderRadius:r,nodeClassName:s,nodeStrokeWidth:i,nodeComponent:a}),E.jsx("path",{className:"react-flow__minimap-mask",d:`M${W-B},${V-B}h${X+B*2}v${G+B*2}h${-X-B*2}z
        M${P.x},${P.y}h${P.width}v${P.height}h${-P.width}z`,fillRule:"evenodd",pointerEvents:"none"})]})})}ns.displayName="MiniMap";const Lc=z.memo(ns),Dc=e=>t=>e?`${Math.max(1/t.transform[2],1)}`:void 0,Bc={[Pe.Line]:"right",[Pe.Handle]:"bottom-right"};function Vc({nodeId:e,position:t,variant:n=Pe.Handle,className:o,style:s=void 0,children:r,color:i,minWidth:a=10,minHeight:l=10,maxWidth:g=Number.MAX_VALUE,maxHeight:u=Number.MAX_VALUE,keepAspectRatio:d=!1,resizeDirection:c,autoScale:h=!0,shouldResize:y,onResizeStart:m,onResize:w,onResizeEnd:p}){const N=To(),f=typeof e=="string"?e:N,b=ne(),v=z.useRef(null),I=n===Pe.Handle,_=J(z.useCallback(Dc(I&&h),[I,h]),oe),P=z.useRef(null),j=t??Bc[n];z.useEffect(()=>{if(!(!v.current||!f))return P.current||(P.current=wi({domNode:v.current,nodeId:f,getStoreItems:()=>{const{nodeLookup:$,transform:H,snapGrid:R,snapToGrid:x,nodeOrigin:C,domNode:S}=b.getState();return{nodeLookup:$,transform:H,snapGrid:R,snapToGrid:x,nodeOrigin:C,paneDomNode:S}},onChange:($,H)=>{const{triggerNodeChanges:R,nodeLookup:x,parentLookup:C,nodeOrigin:S}=b.getState(),M=[],A={x:$.x,y:$.y},k=x.get(f);if(k&&k.expandParent&&k.parentId){const T=k.origin??S,L=$.width??k.measured.width??0,B=$.height??k.measured.height??0,W={id:k.id,parentId:k.parentId,rect:{width:L,height:B,...ro({x:$.x??k.position.x,y:$.y??k.position.y},{width:L,height:B},k.parentId,x,T)}},V=Yt([W],x,C,S);M.push(...V),A.x=$.x?Math.max(T[0]*L,$.x):void 0,A.y=$.y?Math.max(T[1]*B,$.y):void 0}if(A.x!==void 0&&A.y!==void 0){const T={id:f,type:"position",position:{...A}};M.push(T)}if($.width!==void 0&&$.height!==void 0){const L={id:f,type:"dimensions",resizing:!0,setAttributes:c?c==="horizontal"?"width":"height":!0,dimensions:{width:$.width,height:$.height}};M.push(L)}for(const T of H){const L={...T,type:"position"};M.push(L)}R(M)},onEnd:({width:$,height:H})=>{const R={id:f,type:"dimensions",resizing:!1,dimensions:{width:$,height:H}};b.getState().triggerNodeChanges([R])}})),P.current.update({controlPosition:j,boundaries:{minWidth:a,minHeight:l,maxWidth:g,maxHeight:u},keepAspectRatio:d,resizeDirection:c,onResizeStart:m,onResize:w,onResizeEnd:p,shouldResize:y}),()=>{var $;($=P.current)==null||$.destroy()}},[j,a,l,g,u,d,m,w,p,y]);const D=j.split("-");return E.jsx("div",{className:re(["react-flow__resize-control","nodrag",...D,n,o]),ref:v,style:{...s,scale:_,...i&&{[I?"backgroundColor":"borderColor"]:i}},children:r})}z.memo(Vc);const Fc=[{id:"start",type:"default",data:{label:"Start",content:"Welcome to Formul8 AI",blockType:"start",isNote:!1},position:{x:200,y:300},style:{background:"#10b981",color:"white",border:"2px solid #047857",borderRadius:"20px",padding:"12px 16px",minWidth:"120px",maxWidth:"150px",fontSize:"13px",fontFamily:"-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",position:"relative",overflow:"hidden"}},{id:"welcome",type:"default",data:{label:"Welcome Message",content:"Hello! I'm Formul8 AI, your dedicated cannabis industry assistant. How can I help you today?",blockType:"message",isNote:!1},position:{x:550,y:300},style:{background:"#3b82f6",color:"white",border:"2px solid #1e40af",borderRadius:"8px",padding:"12px 16px",minWidth:"200px",maxWidth:"300px",fontSize:"13px",fontFamily:"-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",position:"relative",overflow:"hidden"}},{id:"capture",type:"default",data:{label:"Capture User Input",content:"Capture the user's question or request",blockType:"capture-v3",isNote:!1},position:{x:900,y:300},style:{background:"#ef4444",color:"white",border:"2px solid #dc2626",borderRadius:"8px",padding:"12px 16px",minWidth:"200px",maxWidth:"300px",fontSize:"13px",fontFamily:"-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",position:"relative",overflow:"hidden"}},{id:"analyze",type:"default",data:{label:"Analyze Request",content:"Analyze the user's request and determine the best agent to handle it",blockType:"response-prompt",isNote:!1},position:{x:1250,y:300},style:{background:"#f59e0b",color:"white",border:"2px solid #d97706",borderRadius:"8px",padding:"12px 16px",minWidth:"200px",maxWidth:"300px",fontSize:"13px",fontFamily:"-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",position:"relative",overflow:"hidden"}},{id:"route",type:"default",data:{label:"Route to Agent",content:"Route the request to the appropriate specialized agent",blockType:"choice",isNote:!1},position:{x:1600,y:300},style:{background:"#6b7280",color:"white",border:"2px solid #4b5563",borderRadius:"8px",padding:"12px 16px",minWidth:"200px",maxWidth:"300px",fontSize:"13px",fontFamily:"-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",position:"relative",overflow:"hidden"}},{id:"response",type:"default",data:{label:"Generate Response",content:"Generate a comprehensive response using the selected agent",blockType:"response-prompt",isNote:!1},position:{x:1950,y:300},style:{background:"#f59e0b",color:"white",border:"2px solid #d97706",borderRadius:"8px",padding:"12px 16px",minWidth:"200px",maxWidth:"300px",fontSize:"13px",fontFamily:"-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",position:"relative",overflow:"hidden"}},{id:"note_welcome",type:"default",data:{label:"Note",content:"First, we welcome the user and ask for their question. We capture their response using a capture step.",blockType:"note",isNote:!0},position:{x:200,y:100},style:{background:"#fbbf24",color:"white",border:"2px solid #f59e0b",borderRadius:"6px",padding:"10px 12px",minWidth:"200px",maxWidth:"280px",fontSize:"12px",fontFamily:"-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",position:"relative",overflow:"hidden",opacity:"0.95"}},{id:"note_analyze",type:"default",data:{label:"Note",content:"We analyze the user's request and determine which specialized agent should handle it based on the content.",blockType:"note",isNote:!0},position:{x:1250,y:100},style:{background:"#fbbf24",color:"white",border:"2px solid #f59e0b",borderRadius:"6px",padding:"10px 12px",minWidth:"200px",maxWidth:"280px",fontSize:"12px",fontFamily:"-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",position:"relative",overflow:"hidden",opacity:"0.95"}},{id:"note_response",type:"default",data:{label:"Note",content:"Finally, we generate a comprehensive response using the selected specialized agent's knowledge and capabilities.",blockType:"note",isNote:!0},position:{x:1950,y:100},style:{background:"#fbbf24",color:"white",border:"2px solid #f59e0b",borderRadius:"6px",padding:"10px 12px",minWidth:"200px",maxWidth:"280px",fontSize:"12px",fontFamily:"-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",position:"relative",overflow:"hidden",opacity:"0.95"}}],Wc=[{id:"e-start-welcome",source:"start",target:"welcome",type:"smoothstep",style:{stroke:"#9ca3af",strokeWidth:2}},{id:"e-welcome-capture",source:"welcome",target:"capture",type:"smoothstep",style:{stroke:"#9ca3af",strokeWidth:2}},{id:"e-capture-analyze",source:"capture",target:"analyze",type:"smoothstep",style:{stroke:"#9ca3af",strokeWidth:2}},{id:"e-analyze-route",source:"analyze",target:"route",type:"smoothstep",style:{stroke:"#9ca3af",strokeWidth:2}},{id:"e-route-response",source:"route",target:"response",type:"smoothstep",style:{stroke:"#9ca3af",strokeWidth:2}}],Wn={nodes:Fc,edges:Wc},Oc=e=>{const t={start:"▶️",message:"💬",block:"📦","response-prompt":"🤖","capture-v3":"📝",choice:"❓",note:"📝","set-v3":"⚙️","kb-search":"🔍",default:"⚙️"};return t[e]||t.default},Yc=({data:e})=>{const t=e,n=t.blockType,o=t.isNote||!1,s=()=>{const r={borderRadius:"8px",padding:"12px 16px",minWidth:"200px",maxWidth:"300px",fontSize:"13px",fontFamily:"-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",border:"2px solid #e0e0e0",color:"#333333",textAlign:"left",position:"relative",overflow:"hidden"};if(o)return{...r,background:"#fbbf24",borderColor:"#f59e0b",color:"white",minWidth:"200px",maxWidth:"280px",padding:"10px 12px",fontSize:"12px",opacity:"0.95",borderRadius:"6px"};if(n==="start")return{...r,background:"#10b981",borderColor:"#047857",color:"white",borderRadius:"20px",minWidth:"120px",maxWidth:"150px",padding:"12px 16px",textAlign:"center"};const i={start:{background:"#10b981",borderColor:"#047857",color:"white",borderRadius:"20px"},message:{background:"#3b82f6",borderColor:"#1e40af",color:"white",borderRadius:"8px"},block:{background:"#8b5cf6",borderColor:"#6d28d9",color:"white",borderRadius:"8px"},"response-prompt":{background:"#f59e0b",borderColor:"#d97706",color:"white",borderRadius:"8px"},"capture-v3":{background:"#ef4444",borderColor:"#dc2626",color:"white",borderRadius:"8px"},choice:{background:"#6b7280",borderColor:"#4b5563",color:"white",borderRadius:"8px"},note:{background:"#fbbf24",borderColor:"#f59e0b",color:"white",borderRadius:"6px"},"set-v3":{background:"#6b7280",borderColor:"#4b5563",color:"white",borderRadius:"8px"},"kb-search":{background:"#8b5cf6",borderColor:"#6d28d9",color:"white",borderRadius:"8px"},default:{background:"#f3f4f6",borderColor:"#d1d5db",color:"#374151",borderRadius:"8px"}},a=i[n]||i.default;return{...r,...a}};return E.jsxs("div",{style:s(),children:[E.jsx(ze,{type:"target",position:O.Top,style:{background:"#fff",border:"2px solid #666",width:"12px",height:"12px"}}),E.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:o?"6px":"8px",gap:"6px",justifyContent:n==="start"?"center":"flex-start"},children:[E.jsx("span",{style:{fontSize:n==="start"?"16px":o?"12px":"14px"},children:Oc(n)}),E.jsx("div",{style:{fontWeight:"600",fontSize:n==="start"?"13px":o?"11px":"13px",lineHeight:"1.2"},children:t.label})]}),t.content&&n!=="start"&&E.jsx("div",{style:{fontSize:o?"10px":"12px",opacity:.9,lineHeight:"1.3",wordBreak:"break-word",maxHeight:o?"60px":"80px",overflow:"hidden",background:o?"rgba(255,255,255,0.15)":"rgba(255,255,255,0.1)",padding:o?"6px":"8px",borderRadius:"4px",border:"1px solid rgba(255,255,255,0.2)"},children:t.content&&t.content.length>(o?80:100)?t.content.substring(0,o?80:100)+"...":t.content}),E.jsx(ze,{type:"source",position:O.Bottom,style:{background:"#fff",border:"2px solid #666",width:"12px",height:"12px"}})]})},Xc={voiceflow:Yc};function Zc(){const[e,t]=z.useState([]),[n,o]=z.useState([]),[s,r]=z.useState(null);z.useEffect(()=>{const a=Wn.nodes.map(l=>({...l,type:"voiceflow",data:{...l.data,label:l.data.label||"",content:l.data.content||"",blockType:l.data.blockType||"default",isNote:l.data.isNote||!1}}));t(a),o(Wn.edges)},[]);const i=z.useCallback((a,l)=>{r(l)},[]);return E.jsxs("div",{style:{width:"100vw",height:"100vh",display:"flex",flexDirection:"column"},children:[E.jsxs("div",{style:{padding:"0 24px",background:"white",borderBottom:"1px solid #e5e7eb",display:"flex",alignItems:"center",justifyContent:"space-between",height:"64px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[E.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[E.jsx("div",{style:{width:"32px",height:"32px",background:"linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%)",borderRadius:"8px",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontWeight:"bold",fontSize:"16px"},children:"F8"}),E.jsxs("div",{children:[E.jsx("h1",{style:{margin:0,fontSize:"20px",fontWeight:"600",color:"#111827"},children:"Formul8 AI"}),E.jsx("p",{style:{margin:"2px 0 0 0",fontSize:"13px",color:"#6b7280"},children:"Voiceflow Orchestration"})]})]}),E.jsxs("div",{style:{display:"flex",gap:"8px"},children:[E.jsx("button",{style:{padding:"8px 16px",background:"#f9fafb",border:"1px solid #d1d5db",borderRadius:"8px",fontSize:"13px",fontWeight:"500",cursor:"pointer",color:"#374151",transition:"all 0.2s"},children:"Share"}),E.jsx("button",{style:{padding:"8px 16px",background:"#f9fafb",border:"1px solid #d1d5db",borderRadius:"8px",fontSize:"13px",fontWeight:"500",cursor:"pointer",color:"#374151",transition:"all 0.2s"},children:"Call"}),E.jsx("button",{style:{padding:"8px 16px",background:"#10b981",border:"1px solid #059669",borderRadius:"8px",fontSize:"13px",fontWeight:"500",cursor:"pointer",color:"white",transition:"all 0.2s"},children:"► Run"})]})]}),E.jsxs("div",{style:{flex:1,position:"relative"},children:[E.jsxs(hc,{nodes:e,edges:n,onNodeClick:i,nodeTypes:Xc,fitView:!0,fitViewOptions:{padding:.2,includeHiddenNodes:!1,minZoom:.1,maxZoom:2},style:{background:"#fafafa"},children:[E.jsx(yc,{color:"#e5e7eb",gap:20}),E.jsx(Cc,{style:{background:"white",border:"1px solid #e5e7eb",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"}}),E.jsx(Lc,{style:{background:"white",border:"1px solid #e5e7eb",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},nodeColor:"#3b82f6",maskColor:"rgba(0,0,0,0.1)"})]}),s&&E.jsxs("div",{style:{position:"absolute",top:"20px",right:"20px",background:"white",border:"1px solid #e5e7eb",borderRadius:"12px",padding:"20px",minWidth:"300px",maxWidth:"400px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",zIndex:1e3},children:[E.jsx("h3",{style:{margin:"0 0 12px 0",fontSize:"16px",fontWeight:"600",color:"#111827"},children:"Block Details"}),E.jsxs("div",{style:{marginBottom:"12px"},children:[E.jsx("strong",{children:"Type:"})," ",s.data.blockType]}),E.jsxs("div",{style:{marginBottom:"12px"},children:[E.jsx("strong",{children:"Label:"})," ",s.data.label]}),s.data.content&&E.jsxs("div",{children:[E.jsx("strong",{children:"Content:"}),E.jsx("div",{style:{marginTop:"8px",padding:"12px",background:"#f9fafb",borderRadius:"6px",fontSize:"13px",lineHeight:"1.4",maxHeight:"200px",overflow:"auto"},children:s.data.content})]})]})]})]})}export{Zc as default};
