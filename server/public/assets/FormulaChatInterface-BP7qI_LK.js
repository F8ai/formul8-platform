var Un=Object.defineProperty;var Js=i=>{throw TypeError(i)};var An=(i,t,e)=>t in i?Un(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var h=(i,t,e)=>An(i,typeof t!="symbol"?t+"":t,e),ls=(i,t,e)=>t.has(i)||Js("Cannot "+e);var u=(i,t,e)=>(ls(i,t,"read from private field"),e?e.call(i):t.get(i)),y=(i,t,e)=>t.has(i)?Js("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(i):t.set(i,e),F=(i,t,e,s)=>(ls(i,t,"write to private field"),s?s.call(i,e):t.set(i,e),e),b=(i,t,e)=>(ls(i,t,"access private method"),e);import{a4 as Gs,r as G,j as g,C as Fs,d as Cs,f as ze,B as lt,a5 as kn,E as ki,a3 as Ss,dO as Mn,dP as Qs,cj as rs,dQ as Zs,dR as as,dS as Rn,dT as Dn,dU as ne,dV as In,dW as dt,dX as On,dY as Wt,dZ as $n,d_ as Ps,d$ as Bn,e0 as jt,e1 as Ln,e2 as zn,e3 as jn,al as _n,t as qn,e4 as Hn,v as Wn,M as Gn,Q as Vn,A as ei,x as ti,n as Kn,q as si,ak as Xn,e5 as Yn,e6 as Jn,e7 as Qn,e8 as Zn,af as ds,ah as eo,I as to,ag as so,G as io,J as ii}from"./index-CDF1r-gK.js";import{t as no,d as oo}from"./throttle-Bdt7xJtI.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ro=Gs("FileImage",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["circle",{cx:"10",cy:"12",r:"2",key:"737tya"}],["path",{d:"m20 17-1.296-1.296a2.41 2.41 0 0 0-3.408 0L9 22",key:"wt3hpn"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ao=Gs("FileVideo",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m10 11 5 3-5 3v-6Z",key:"7ntvm4"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ni=Gs("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]);function lo({url:i,title:t,type:e,size:s,onOpenDocument:n}){const[o,r]=G.useState(!1),a=(N,R)=>{var A;if(R)return R.toLowerCase();switch((A=N.split(".").pop())==null?void 0:A.toLowerCase()){case"pdf":return"pdf";case"doc":case"docx":return"document";case"xls":case"xlsx":return"spreadsheet";case"ppt":case"pptx":return"presentation";case"jpg":case"jpeg":case"png":case"gif":return"image";case"mp4":case"avi":case"mov":return"video";default:return"document"}},d=N=>{switch(N){case"pdf":case"document":case"presentation":return g.jsx(Ss,{className:"w-6 h-6"});case"spreadsheet":return g.jsx(Mn,{className:"w-6 h-6"});case"image":return g.jsx(ro,{className:"w-6 h-6"});case"video":return g.jsx(ao,{className:"w-6 h-6"});default:return g.jsx(Ss,{className:"w-6 h-6"})}},p=N=>{switch(N){case"pdf":return"text-red-500";case"document":return"text-blue-500";case"spreadsheet":return"text-green-500";case"presentation":return"text-orange-500";case"image":return"text-purple-500";case"video":return"text-pink-500";default:return"text-formul8-gray"}},c=(N,R)=>{var A;if(R)return R;const k=((A=N.split("/").pop())==null?void 0:A.split("?")[0])||"Document";return decodeURIComponent(k)},m=a(i,e),v=c(i,t),w=d(m),C=p(m),E=()=>{n(i,v,m)},U=N=>{N.stopPropagation(),window.open(i,"_blank")};return g.jsx(Fs,{className:`cursor-pointer transition-all duration-200 max-w-sm my-2 border-formul8-border bg-formul8-card hover:bg-formul8-bg-card ${o?"shadow-lg border-formul8-primary":"shadow-sm"}`,onMouseEnter:()=>r(!0),onMouseLeave:()=>r(!1),onClick:E,children:g.jsx(Cs,{className:"p-3",children:g.jsxs("div",{className:"flex items-start space-x-3",children:[g.jsx("div",{className:`${C} mt-1`,children:w}),g.jsxs("div",{className:"flex-1 min-w-0",children:[g.jsx("h4",{className:"text-sm font-medium text-formul8-white truncate",children:v}),g.jsxs("div",{className:"flex items-center justify-between mt-1",children:[g.jsxs("div",{className:"flex items-center space-x-2",children:[g.jsx(ze,{variant:"secondary",className:"text-xs bg-formul8-bg-dark text-formul8-gray border-formul8-border",children:m.toUpperCase()}),s&&g.jsx("span",{className:"text-xs text-formul8-muted",children:s})]}),g.jsxs("div",{className:"flex items-center space-x-1",children:[g.jsx(lt,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 text-formul8-gray hover:text-formul8-white hover:bg-formul8-bg-dark",onClick:U,children:g.jsx(kn,{className:"w-3 h-3"})}),g.jsx(ki,{className:"w-3 h-3 text-formul8-muted"})]})]}),g.jsx("p",{className:"text-xs text-formul8-muted mt-1 truncate",children:"Click to open in document viewer"})]})]})})})}function uo(i,t,e){const s=[];return i.forEach(n=>typeof n!="string"?s.push(n):t[Symbol.split](n).forEach((o,r,a)=>{o!==""&&s.push(o),r<a.length-1&&s.push(e)})),s}/**
 * Takes a string with placeholder variables like `%{smart_count} file selected`
 * and replaces it with values from options `{smart_count: 5}`
 *
 * @license https://github.com/airbnb/polyglot.js/blob/master/LICENSE
 * taken from https://github.com/airbnb/polyglot.js/blob/master/lib/polyglot.js#L299
 *
 * @param phrase that needs interpolation, with placeholders
 * @param options with values that will be used to replace placeholders
 */function oi(i,t){const e=/\$/g,s="$$$$";let n=[i];if(t==null)return n;for(const o of Object.keys(t))if(o!=="_"){let r=t[o];typeof r=="string"&&(r=e[Symbol.replace](r,s)),n=uo(n,new RegExp(`%\\{${o}\\}`,"g"),r)}return n}const co=i=>{throw new Error(`missing string: ${i}`)};var mt,ft,Ts;class Mi{constructor(t,{onMissingKey:e=co}={}){y(this,ft);h(this,"locale");y(this,mt);this.locale={strings:{},pluralize(s){return s===1?0:1}},Array.isArray(t)?t.forEach(b(this,ft,Ts),this):b(this,ft,Ts).call(this,t),F(this,mt,e)}translate(t,e){return this.translateArray(t,e).join("")}translateArray(t,e){let s=this.locale.strings[t];if(s==null&&(u(this,mt).call(this,t),s=t),typeof s=="object"){if(e&&typeof e.smart_count<"u"){const o=this.locale.pluralize(e.smart_count);return oi(s[o],e)}throw new Error("Attempted to use a string with plural forms, but no value was given for %{smart_count}")}if(typeof s!="string")throw new Error("string was not a string");return oi(s,e)}}mt=new WeakMap,ft=new WeakSet,Ts=function(t){if(!(t!=null&&t.strings))return;const e=this.locale;Object.assign(this.locale,{strings:{...e.strings,...t.strings},pluralize:t.pluralize||e.pluralize})};class Ri{constructor(t,e){h(this,"uppy");h(this,"opts");h(this,"id");h(this,"defaultLocale");h(this,"i18n");h(this,"i18nArray");h(this,"type");h(this,"VERSION");this.uppy=t,this.opts=e??{}}getPluginState(){const{plugins:t}=this.uppy.getState();return(t==null?void 0:t[this.id])||{}}setPluginState(t){const{plugins:e}=this.uppy.getState();this.uppy.setState({plugins:{...e,[this.id]:{...e[this.id],...t}}})}setOptions(t){this.opts={...this.opts,...t},this.setPluginState(void 0),this.i18nInit()}i18nInit(){const t=new Mi([this.defaultLocale,this.uppy.locale,this.opts.locale]);this.i18n=t.translate.bind(t),this.i18nArray=t.translateArray.bind(t),this.setPluginState(void 0)}addTarget(t){throw new Error("Extend the addTarget method to add your plugin to another plugin's target")}install(){}uninstall(){}update(t){}afterUpdate(){}}function us(i){return i<10?`0${i}`:i.toString()}function _t(){const i=new Date,t=us(i.getHours()),e=us(i.getMinutes()),s=us(i.getSeconds());return`${t}:${e}:${s}`}const po={debug:()=>{},warn:()=>{},error:(...i)=>console.error(`[Uppy] [${_t()}]`,...i)},ho={debug:(...i)=>console.debug(`[Uppy] [${_t()}]`,...i),warn:(...i)=>console.warn(`[Uppy] [${_t()}]`,...i),error:(...i)=>console.error(`[Uppy] [${_t()}]`,...i)};function Di(i){return typeof i!="object"||i===null||!("nodeType"in i)?!1:i.nodeType===Node.ELEMENT_NODE}function mo(i,t=document){return typeof i=="string"?t.querySelector(i):Di(i)?i:null}function Ii(i){for(;i&&!i.dir;)i=i.parentNode;return i==null?void 0:i.dir}function fo(i){let t=null,e;return(...s)=>(e=s,t||(t=Promise.resolve().then(()=>(t=null,i(...e)))),t)}var gt;const Gt=class Gt extends Ri{constructor(){super(...arguments);y(this,gt);h(this,"isTargetDOMEl");h(this,"el");h(this,"parent");h(this,"title")}getTargetPlugin(e){let s;if(typeof(e==null?void 0:e.addTarget)=="function")s=e,s instanceof Gt||console.warn(new Error("The provided plugin is not an instance of UIPlugin. This is an indication of a bug with the way Uppy is bundled.",{cause:{targetPlugin:s,UIPlugin:Gt}}));else if(typeof e=="function"){const n=e;this.uppy.iteratePlugins(o=>{o instanceof n&&(s=o)})}return s}mount(e,s){const n=s.id,o=mo(e);if(o){this.isTargetDOMEl=!0;const d=document.createElement("div");return d.classList.add("uppy-Root"),F(this,gt,fo(p=>{this.uppy.getPlugin(this.id)&&(Qs(this.render(p,d),d),this.afterUpdate())})),this.uppy.log(`Installing ${n} to a DOM element '${e}'`),this.opts.replaceTargetContent&&(o.innerHTML=""),Qs(this.render(this.uppy.getState(),d),d),this.el=d,o.appendChild(d),d.dir=this.opts.direction||Ii(d)||"ltr",this.onMount(),this.el}const r=this.getTargetPlugin(e);if(r)return this.uppy.log(`Installing ${n} to ${r.id}`),this.parent=r,this.el=r.addTarget(s),this.onMount(),this.el;this.uppy.log(`Not installing ${n}`);let a=`Invalid target option given to ${n}.`;throw typeof e=="function"?a+=" The given target is not a Plugin class. Please check that you're not specifying a React Component instead of a plugin. If you are using @uppy/* packages directly, make sure you have only 1 version of @uppy/core installed: run `npm ls @uppy/core` on the command line and verify that all the versions match and are deduped correctly.":a+="If you meant to target an HTML element, please make sure that the element exists. Check that the <script> tag initializing Uppy is right before the closing </body> tag at the end of the page. (see https://github.com/transloadit/uppy/issues/1042)\n\nIf you meant to target a plugin, please confirm that your `import` statements or `require` calls are correct.",new Error(a)}render(e,s){throw new Error("Extend the render method to add your plugin to a DOM element")}update(e){var s;this.el!=null&&((s=u(this,gt))==null||s.call(this,e))}unmount(){var e;this.isTargetDOMEl&&((e=this.el)==null||e.remove()),this.onUnmount()}onMount(){}onUnmount(){}};gt=new WeakMap;let at=Gt;const go="@uppy/store-default",yo="The default simple object-based store for Uppy.",bo="4.3.2",vo="MIT",wo="lib/index.js",Fo="module",Co={build:"tsc --build tsconfig.build.json",typecheck:"tsc --build",test:"vitest run --environment=jsdom --silent='passed-only'"},So=["file uploader","uppy","uppy-store"],Po="https://uppy.io",To={url:"https://github.com/transloadit/uppy/issues"},xo={jsdom:"^26.1.0",typescript:"^5.8.3",vitest:"^3.2.4"},Eo={type:"git",url:"git+https://github.com/transloadit/uppy.git"},No=["src","lib","dist","CHANGELOG.md"],Uo={name:go,description:yo,version:bo,license:vo,main:wo,type:Fo,scripts:Co,keywords:So,homepage:Po,bugs:To,devDependencies:xo,repository:Eo,files:No};var je,Vt,$i;class Oi{constructor(){y(this,Vt);h(this,"state",{});y(this,je,new Set)}getState(){return this.state}setState(t){const e={...this.state},s={...this.state,...t};this.state=s,b(this,Vt,$i).call(this,e,s,t)}subscribe(t){return u(this,je).add(t),()=>{u(this,je).delete(t)}}}je=new WeakMap,Vt=new WeakSet,$i=function(...t){u(this,je).forEach(e=>{e(...t)})},h(Oi,"VERSION",Uo.version);function Bi(i){const t=i.lastIndexOf(".");return t===-1||t===i.length-1?{name:i,extension:void 0}:{name:i.slice(0,t),extension:i.slice(t+1)}}const ri={__proto__:null,md:"text/markdown",markdown:"text/markdown",mp4:"video/mp4",mp3:"audio/mp3",svg:"image/svg+xml",jpg:"image/jpeg",png:"image/png",webp:"image/webp",gif:"image/gif",heic:"image/heic",heif:"image/heif",yaml:"text/yaml",yml:"text/yaml",csv:"text/csv",tsv:"text/tab-separated-values",tab:"text/tab-separated-values",avi:"video/x-msvideo",mks:"video/x-matroska",mkv:"video/x-matroska",mov:"video/quicktime",dicom:"application/dicom",doc:"application/msword",msg:"application/vnd.ms-outlook",docm:"application/vnd.ms-word.document.macroenabled.12",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",dot:"application/msword",dotm:"application/vnd.ms-word.template.macroenabled.12",dotx:"application/vnd.openxmlformats-officedocument.wordprocessingml.template",xla:"application/vnd.ms-excel",xlam:"application/vnd.ms-excel.addin.macroenabled.12",xlc:"application/vnd.ms-excel",xlf:"application/x-xliff+xml",xlm:"application/vnd.ms-excel",xls:"application/vnd.ms-excel",xlsb:"application/vnd.ms-excel.sheet.binary.macroenabled.12",xlsm:"application/vnd.ms-excel.sheet.macroenabled.12",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",xlt:"application/vnd.ms-excel",xltm:"application/vnd.ms-excel.template.macroenabled.12",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template",xlw:"application/vnd.ms-excel",txt:"text/plain",text:"text/plain",conf:"text/plain",log:"text/plain",pdf:"application/pdf",zip:"application/zip","7z":"application/x-7z-compressed",rar:"application/x-rar-compressed",tar:"application/x-tar",gz:"application/gzip",dmg:"application/x-apple-diskimage"};function Li(i){var e;if(i.type)return i.type;const t=i.name?(e=Bi(i.name).extension)==null?void 0:e.toLowerCase():null;return t&&t in ri?ri[t]:"application/octet-stream"}function Ao(i){return i.charCodeAt(0).toString(32)}function ai(i){let t="";return i.replace(/[^A-Z0-9]/gi,e=>(t+=`-${Ao(e)}`,"/"))+t}function ko(i,t){let e=t||"uppy";return typeof i.name=="string"&&(e+=`-${ai(i.name.toLowerCase())}`),i.type!==void 0&&(e+=`-${i.type}`),i.meta&&typeof i.meta.relativePath=="string"&&(e+=`-${ai(i.meta.relativePath.toLowerCase())}`),i.data.size!==void 0&&(e+=`-${i.data.size}`),i.data.lastModified!==void 0&&(e+=`-${i.data.lastModified}`),e}function Mo(i){return!i.isRemote||!i.remote?!1:new Set(["box","dropbox","drive","facebook","unsplash"]).has(i.remote.provider)}function Ro(i,t){if(Mo(i))return i.id;const e=Li(i);return ko({...i,type:e},t)}var Do=function(){var t={},e=t._fns={};t.emit=function(r,a,d,p,c,m,v){var w=s(r);w.length&&n(r,w,[a,d,p,c,m,v])},t.on=function(r,a){e[r]||(e[r]=[]),e[r].push(a)},t.once=function(r,a){function d(){a.apply(this,arguments),t.off(r,d)}this.on(r,d)},t.off=function(r,a){var d=[];if(r&&a){var p=this._fns[r],c=0,m=p?p.length:0;for(c;c<m;c++)p[c]!==a&&d.push(p[c])}d.length?this._fns[r]=d:delete this._fns[r]};function s(o){var r=e[o]?e[o]:[],a=o.indexOf(":"),d=a===-1?[o]:[o.substring(0,a),o.substring(a+1)],p=Object.keys(e),c=0,m=p.length;for(c;c<m;c++){var v=p[c];if(v==="*"&&(r=r.concat(e[v])),d.length===2&&d[0]===v){r=r.concat(e[v]);break}}return r}function n(o,r,a){var d=0,p=r.length;for(d;d<p&&r[d];d++)r[d].event=o,r[d].apply(r[d],a)}return t};const Io=rs(Do);let Oo="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",$o=(i=21)=>{let t="",e=i|0;for(;e--;)t+=Oo[Math.random()*64|0];return t};const Bo="@uppy/core",Lo="Core module for the extensible JavaScript file upload widget with support for drag&drop, resumable uploads, previews, restrictions, file processing/encoding, remote providers like Instagram, Dropbox, Google Drive, S3 and more :dog:",zo="4.5.2",jo="MIT",_o="lib/index.js",qo="dist/style.min.css",Ho="module",Wo=["*.css"],Go={build:"tsc --build tsconfig.build.json","build:css":"sass --load-path=../../ src/style.scss dist/style.css && postcss dist/style.css -u cssnano -o dist/style.min.css",typecheck:"tsc --build",test:"vitest run --environment=jsdom --silent='passed-only'"},Vo=["file uploader","uppy","uppy-plugin"],Ko="https://uppy.io",Xo={url:"https://github.com/transloadit/uppy/issues"},Yo={type:"git",url:"git+https://github.com/transloadit/uppy.git"},Jo=["src","lib","dist","CHANGELOG.md"],Qo={"@transloadit/prettier-bytes":"^0.3.4","@uppy/store-default":"^4.3.2","@uppy/utils":"^6.2.2",lodash:"^4.17.21","mime-match":"^1.0.2","namespace-emitter":"^2.0.1",nanoid:"^5.0.9",preact:"^10.5.13"},Zo={"@types/deep-freeze":"^0",cssnano:"^7.0.7","deep-freeze":"^0.0.1",jsdom:"^26.1.0",postcss:"^8.5.6","postcss-cli":"^11.0.1",sass:"^1.89.2",typescript:"^5.8.3",vitest:"^3.2.4"},er={name:Bo,description:Lo,version:zo,license:jo,main:_o,style:qo,type:Ho,sideEffects:Wo,scripts:Go,keywords:Vo,homepage:Ko,bugs:Xo,repository:Yo,files:Jo,dependencies:Qo,devDependencies:Zo};function tr(i,t){return t.name?t.name:i.split("/")[0]==="image"?`${i.split("/")[0]}.${i.split("/")[1]}`:"noname"}const sr={strings:{addBulkFilesFailed:{0:"Failed to add %{smart_count} file due to an internal error",1:"Failed to add %{smart_count} files due to internal errors"},youCanOnlyUploadX:{0:"You can only upload %{smart_count} file",1:"You can only upload %{smart_count} files"},youHaveToAtLeastSelectX:{0:"You have to select at least %{smart_count} file",1:"You have to select at least %{smart_count} files"},aggregateExceedsSize:"You selected %{size} of files, but maximum allowed size is %{sizeAllowed}",exceedsSize:"%{file} exceeds maximum allowed size of %{size}",missingRequiredMetaField:"Missing required meta fields",missingRequiredMetaFieldOnFile:"Missing required meta fields in %{fileName}",inferiorSize:"This file is smaller than the allowed size of %{size}",youCanOnlyUploadFileTypes:"You can only upload: %{types}",noMoreFilesAllowed:"Cannot add more files",noDuplicates:"Cannot add the duplicate file '%{fileName}', it already exists",companionError:"Connection with Companion failed",authAborted:"Authentication aborted",companionUnauthorizeHint:"To unauthorize to your %{provider} account, please go to %{url}",failedToUpload:"Failed to upload %{file}",noInternetConnection:"No Internet connection",connectedToInternet:"Connected to the Internet",noFilesFound:"You have no files or folders here",noSearchResults:"Unfortunately, there are no results for this search",selectX:{0:"Select %{smart_count}",1:"Select %{smart_count}"},allFilesFromFolderNamed:"All files from folder %{name}",openFolderNamed:"Open folder %{name}",cancel:"Cancel",logOut:"Log out",logIn:"Log in",pickFiles:"Pick files",pickPhotos:"Pick photos",filter:"Filter",resetFilter:"Reset filter",loading:"Loading...",loadedXFiles:"Loaded %{numFiles} files",authenticateWithTitle:"Please authenticate with %{pluginName} to select files",authenticateWith:"Connect to %{pluginName}",signInWithGoogle:"Sign in with Google",searchImages:"Search for images",enterTextToSearch:"Enter text to search for images",search:"Search",resetSearch:"Reset search",emptyFolderAdded:"No files were added from empty folder",addedNumFiles:"Added %{numFiles} file(s)",folderAlreadyAdded:'The folder "%{folder}" was already added',folderAdded:{0:"Added %{smart_count} file from %{folder}",1:"Added %{smart_count} files from %{folder}"},additionalRestrictionsFailed:"%{count} additional restrictions were not fulfilled",unnamed:"Unnamed",pleaseWait:"Please wait"}};var ir=function(t){if(typeof t!="number"||Number.isNaN(t))throw new TypeError(`Expected a number, got ${typeof t}`);const e=t<0;let s=Math.abs(t);if(e&&(s=-s),s===0)return"0 B";const n=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],o=Math.min(Math.floor(Math.log(s)/Math.log(1024)),n.length-1),r=Number(s/1024**o),a=n[o];return`${r>=10||r%1===0?Math.round(r):r.toFixed(1)} ${a}`};const Te=rs(ir);function zi(i,t){this.text=i=i||"",this.hasWild=~i.indexOf("*"),this.separator=t,this.parts=i.split(t)}zi.prototype.match=function(i){var t=!0,e=this.parts,s,n=e.length,o;if(typeof i=="string"||i instanceof String)if(!this.hasWild&&this.text!=i)t=!1;else{for(o=(i||"").split(this.separator),s=0;t&&s<n;s++)e[s]!=="*"&&(s<o.length?t=e[s]===o[s]:t=!1);t=t&&o}else if(typeof i.splice=="function")for(t=[],s=i.length;s--;)this.match(i[s])&&(t[t.length]=i[s]);else if(typeof i=="object"){t={};for(var r in i)this.match(r)&&(t[r]=i[r])}return t};var nr=function(i,t,e){var s=new zi(i,e||/[\/\.]/);return typeof t<"u"?s.match(t):s},or=nr,rr=/[\/\+\.]/,ar=function(i,t){function e(s){var n=or(s,i,rr);return n&&n.length>=2}return t?e(t.split(";")[0]):e};const lr=rs(ar),dr={maxFileSize:null,minFileSize:null,maxTotalFileSize:null,maxNumberOfFiles:null,minNumberOfFiles:null,allowedFileTypes:null,requiredMetaFields:[]};class ie extends Error{constructor(e,s){super(e);h(this,"isUserFacing");h(this,"file");h(this,"isRestriction",!0);this.isUserFacing=(s==null?void 0:s.isUserFacing)??!0,s!=null&&s.file&&(this.file=s.file)}}class ur{constructor(t,e){h(this,"getI18n");h(this,"getOpts");this.getI18n=e,this.getOpts=()=>{var n;const s=t();if(((n=s.restrictions)==null?void 0:n.allowedFileTypes)!=null&&!Array.isArray(s.restrictions.allowedFileTypes))throw new TypeError("`restrictions.allowedFileTypes` must be an array");return s}}validateAggregateRestrictions(t,e){const{maxTotalFileSize:s,maxNumberOfFiles:n}=this.getOpts().restrictions;if(n&&t.filter(r=>!r.isGhost).length+e.length>n)throw new ie(`${this.getI18n()("youCanOnlyUploadX",{smart_count:n})}`);if(s){const o=[...t,...e].reduce((r,a)=>r+(a.size??0),0);if(o>s)throw new ie(this.getI18n()("aggregateExceedsSize",{sizeAllowed:Te(s),size:Te(o)}))}}validateSingleFile(t){const{maxFileSize:e,minFileSize:s,allowedFileTypes:n}=this.getOpts().restrictions;if(n&&!n.some(r=>r.includes("/")?t.type?lr(t.type.replace(/;.*?$/,""),r):!1:r[0]==="."&&t.extension?t.extension.toLowerCase()===r.slice(1).toLowerCase():!1)){const r=n.join(", ");throw new ie(this.getI18n()("youCanOnlyUploadFileTypes",{types:r}),{file:t})}if(e&&t.size!=null&&t.size>e)throw new ie(this.getI18n()("exceedsSize",{size:Te(e),file:t.name??this.getI18n()("unnamed")}),{file:t});if(s&&t.size!=null&&t.size<s)throw new ie(this.getI18n()("inferiorSize",{size:Te(s)}),{file:t})}validate(t,e){e.forEach(s=>{this.validateSingleFile(s)}),this.validateAggregateRestrictions(t,e)}validateMinNumberOfFiles(t){const{minNumberOfFiles:e}=this.getOpts().restrictions;if(e&&Object.keys(t).length<e)throw new ie(this.getI18n()("youHaveToAtLeastSelectX",{smart_count:e}))}getMissingRequiredMetaFields(t){const e=new ie(this.getI18n()("missingRequiredMetaFieldOnFile",{fileName:t.name??this.getI18n()("unnamed")})),{requiredMetaFields:s}=this.getOpts().restrictions,n=[];for(const o of s)(!Object.hasOwn(t.meta,o)||t.meta[o]==="")&&n.push(o);return{missingFields:n,error:e}}}function cr(i){if(i==null&&typeof navigator<"u"&&(i=navigator.userAgent),!i)return!0;const t=/Edge\/(\d+\.\d+)/.exec(i);if(!t)return!0;const s=t[1].split(".",2),n=parseInt(s[0],10),o=parseInt(s[1],10);return n<15||n===15&&o<15063||n>18||n===18&&o>=18218}const Ot={totalProgress:0,allowNewUpload:!0,error:null,recoveredState:null};var J,Q,yt,xe,_e,qe,Ee,S,Pe,Es,ji,Ns,_i,Us,As,ks,Ms,Kt,Rs,Ne,qi,Hi,be,bt,ut,Wi,qt,ct;const Xt=class Xt{constructor(t){y(this,S);y(this,J,Object.create(null));y(this,Q);y(this,yt);y(this,xe,Io());y(this,_e,new Set);y(this,qe,new Set);y(this,Ee,new Set);h(this,"defaultLocale");h(this,"locale");h(this,"opts");h(this,"store");h(this,"i18n");h(this,"i18nArray");h(this,"scheduledAutoProceed",null);h(this,"wasOffline",!1);y(this,Kt,(t,e)=>{const s=t?this.getFile(t.id):void 0;if(t==null||!s){this.log(`Not setting progress for a file that has been removed: ${t==null?void 0:t.id}`);return}if(s.progress.percentage===100){this.log(`Not setting progress for a file that has been already uploaded: ${t.id}`);return}const n={bytesTotal:e.bytesTotal,percentage:e.bytesTotal!=null&&Number.isFinite(e.bytesTotal)&&e.bytesTotal>0?Math.round(e.bytesUploaded/e.bytesTotal*100):void 0};s.progress.uploadStarted!=null?this.setFileState(t.id,{progress:{...s.progress,...n,bytesUploaded:e.bytesUploaded}}):this.setFileState(t.id,{progress:{...s.progress,...n}}),u(this,Ne).call(this)});y(this,Ne,no(()=>b(this,S,Rs).call(this),500,{leading:!0,trailing:!0}));y(this,be,this.updateOnlineStatus.bind(this));y(this,bt,new Map);this.defaultLocale=sr;const e={id:"uppy",autoProceed:!1,allowMultipleUploadBatches:!0,debug:!1,restrictions:dr,meta:{},onBeforeFileAdded:(n,o)=>!Object.hasOwn(o,n.id),onBeforeUpload:n=>n,store:new Oi,logger:po,infoTimeout:5e3},s={...e,...t};this.opts={...s,restrictions:{...e.restrictions,...t==null?void 0:t.restrictions}},t!=null&&t.logger&&t.debug?this.log("You are using a custom `logger`, but also set `debug: true`, which uses built-in logger to output logs to console. Ignoring `debug: true` and using your custom `logger`.","warning"):t!=null&&t.debug&&(this.opts.logger=ho),this.log(`Using Core v${Xt.VERSION}`),this.i18nInit(),this.store=this.opts.store,this.setState({...Ot,plugins:{},files:{},currentUploads:{},capabilities:{uploadProgress:cr(),individualCancellation:!0,resumableUploads:!1},meta:{...this.opts.meta},info:[]}),F(this,Q,new ur(()=>this.opts,()=>this.i18n)),F(this,yt,this.store.subscribe((n,o,r)=>{this.emit("state-update",n,o,r),this.updateAll(o)})),this.opts.debug&&typeof window<"u"&&(window[this.opts.id]=this),b(this,S,Hi).call(this)}emit(t,...e){u(this,xe).emit(t,...e)}on(t,e){return u(this,xe).on(t,e),this}once(t,e){return u(this,xe).once(t,e),this}off(t,e){return u(this,xe).off(t,e),this}updateAll(t){this.iteratePlugins(e=>{e.update(t)})}setState(t){this.store.setState(t)}getState(){return this.store.getState()}patchFilesState(t){const e=this.getState().files;this.setState({files:{...e,...Object.fromEntries(Object.entries(t).map(([s,n])=>[s,{...e[s],...n}]))}})}setFileState(t,e){if(!this.getState().files[t])throw new Error(`Canâ€™t set state for ${t} (the file could have been removed)`);this.patchFilesState({[t]:e})}i18nInit(){const t=s=>this.log(`Missing i18n string: ${s}`,"error"),e=new Mi([this.defaultLocale,this.opts.locale],{onMissingKey:t});this.i18n=e.translate.bind(e),this.i18nArray=e.translateArray.bind(e),this.locale=e.locale}setOptions(t){this.opts={...this.opts,...t,restrictions:{...this.opts.restrictions,...t==null?void 0:t.restrictions}},t.meta&&this.setMeta(t.meta),this.i18nInit(),t.locale&&this.iteratePlugins(e=>{e.setOptions(t)}),this.setState(void 0)}resetProgress(){const t={percentage:0,bytesUploaded:!1,uploadComplete:!1,uploadStarted:null},e={...this.getState().files},s=Object.create(null);Object.keys(e).forEach(n=>{s[n]={...e[n],progress:{...e[n].progress,...t},tus:void 0,transloadit:void 0}}),this.setState({files:s,...Ot})}clear(){const{capabilities:t,currentUploads:e}=this.getState();if(Object.keys(e).length>0&&!t.individualCancellation)throw new Error("The installed uploader plugin does not allow removing files during an upload.");this.setState({...Ot,files:{}})}addPreProcessor(t){u(this,_e).add(t)}removePreProcessor(t){return u(this,_e).delete(t)}addPostProcessor(t){u(this,Ee).add(t)}removePostProcessor(t){return u(this,Ee).delete(t)}addUploader(t){u(this,qe).add(t)}removeUploader(t){return u(this,qe).delete(t)}setMeta(t){const e={...this.getState().meta,...t},s={...this.getState().files};Object.keys(s).forEach(n=>{s[n]={...s[n],meta:{...s[n].meta,...t}}}),this.log("Adding metadata:"),this.log(t),this.setState({meta:e,files:s})}setFileMeta(t,e){const s={...this.getState().files};if(!s[t]){this.log(`Was trying to set metadata for a file that has been removed: ${t}`);return}const n={...s[t].meta,...e};s[t]={...s[t],meta:n},this.setState({files:s})}getFile(t){return this.getState().files[t]}getFiles(){const{files:t}=this.getState();return Object.values(t)}getFilesByIds(t){return t.map(e=>this.getFile(e))}getObjectOfFilesPerState(){const{files:t,totalProgress:e,error:s}=this.getState(),n=Object.values(t),o=[],r=[],a=[],d=[],p=[],c=[],m=[],v=[],w=[];for(const C of n){const{progress:E}=C;!E.uploadComplete&&E.uploadStarted&&(o.push(C),C.isPaused||v.push(C)),E.uploadStarted||r.push(C),(E.uploadStarted||E.preprocess||E.postprocess)&&a.push(C),E.uploadStarted&&d.push(C),C.isPaused&&p.push(C),E.uploadComplete&&c.push(C),C.error&&m.push(C),(E.preprocess||E.postprocess)&&w.push(C)}return{newFiles:r,startedFiles:a,uploadStartedFiles:d,pausedFiles:p,completeFiles:c,erroredFiles:m,inProgressFiles:o,inProgressNotPausedFiles:v,processingFiles:w,isUploadStarted:d.length>0,isAllComplete:e===100&&c.length===n.length&&w.length===0,isAllErrored:!!s&&m.length===n.length,isAllPaused:o.length!==0&&p.length===o.length,isUploadInProgress:o.length>0,isSomeGhost:n.some(C=>C.isGhost)}}validateRestrictions(t,e=this.getFiles()){try{u(this,Q).validate(e,[t])}catch(s){return s}return null}validateSingleFile(t){try{u(this,Q).validateSingleFile(t)}catch(e){return e.message}return null}validateAggregateRestrictions(t){const e=this.getFiles();try{u(this,Q).validateAggregateRestrictions(e,t)}catch(s){return s.message}return null}checkIfFileAlreadyExists(t){const{files:e}=this.getState();return!!(e[t]&&!e[t].isGhost)}addFile(t){b(this,S,Ns).call(this,t);const{nextFilesState:e,validFilesToAdd:s,errors:n}=b(this,S,As).call(this,[t]),o=n.filter(a=>a.isRestriction);if(b(this,S,Pe).call(this,o),n.length>0)throw n[0];this.setState({files:e});const[r]=s;return this.emit("file-added",r),this.emit("files-added",s),this.log(`Added file: ${r.name}, ${r.id}, mime type: ${r.type}`),b(this,S,Us).call(this),r.id}addFiles(t){b(this,S,Ns).call(this);const{nextFilesState:e,validFilesToAdd:s,errors:n}=b(this,S,As).call(this,t),o=n.filter(a=>a.isRestriction);b(this,S,Pe).call(this,o);const r=n.filter(a=>!a.isRestriction);if(r.length>0){let a=`Multiple errors occurred while adding files:
`;if(r.forEach(d=>{a+=`
 * ${d.message}`}),this.info({message:this.i18n("addBulkFilesFailed",{smart_count:r.length}),details:a},"error",this.opts.infoTimeout),typeof AggregateError=="function")throw new AggregateError(r,a);{const d=new Error(a);throw d.errors=r,d}}this.setState({files:e}),s.forEach(a=>{this.emit("file-added",a)}),this.emit("files-added",s),s.length>5?this.log(`Added batch of ${s.length} files`):Object.values(s).forEach(a=>{this.log(`Added file: ${a.name}
 id: ${a.id}
 type: ${a.type}`)}),s.length>0&&b(this,S,Us).call(this)}removeFiles(t){const{files:e,currentUploads:s}=this.getState(),n={...e},o={...s},r=Object.create(null);t.forEach(c=>{e[c]&&(r[c]=e[c],delete n[c])});function a(c){return r[c]===void 0}Object.keys(o).forEach(c=>{const m=s[c].fileIDs.filter(a);if(m.length===0){delete o[c];return}const{capabilities:v}=this.getState();if(m.length!==s[c].fileIDs.length&&!v.individualCancellation)throw new Error("The installed uploader plugin does not allow removing files during an upload.");o[c]={...s[c],fileIDs:m}});const d={currentUploads:o,files:n};Object.keys(n).length===0&&(d.allowNewUpload=!0,d.error=null,d.recoveredState=null),this.setState(d),u(this,Ne).call(this);const p=Object.keys(r);p.forEach(c=>{this.emit("file-removed",r[c])}),p.length>5?this.log(`Removed ${p.length} files`):this.log(`Removed files: ${p.join(", ")}`)}removeFile(t){this.removeFiles([t])}pauseResume(t){if(!this.getState().capabilities.resumableUploads||this.getFile(t).progress.uploadComplete)return;const e=this.getFile(t),n=!(e.isPaused||!1);return this.setFileState(t,{isPaused:n}),this.emit("upload-pause",e,n),n}pauseAll(){const t={...this.getState().files};Object.keys(t).filter(s=>!t[s].progress.uploadComplete&&t[s].progress.uploadStarted).forEach(s=>{const n={...t[s],isPaused:!0};t[s]=n}),this.setState({files:t}),this.emit("pause-all")}resumeAll(){const t={...this.getState().files};Object.keys(t).filter(s=>!t[s].progress.uploadComplete&&t[s].progress.uploadStarted).forEach(s=>{const n={...t[s],isPaused:!1,error:null};t[s]=n}),this.setState({files:t}),this.emit("resume-all")}async retryAll(){const t=await b(this,S,Ms).call(this);return this.emit("complete",t),t}cancelAll(){this.emit("cancel-all");const{files:t}=this.getState(),e=Object.keys(t);e.length&&this.removeFiles(e),this.setState(Ot)}retryUpload(t){this.setFileState(t,{error:null,isPaused:!1}),this.emit("upload-retry",this.getFile(t));const e=b(this,S,ut).call(this,[t],{forceAllowNewUpload:!0});return b(this,S,ct).call(this,e)}logout(){this.iteratePlugins(t=>{var e,s;(s=(e=t.provider)==null?void 0:e.logout)==null||s.call(e)})}[Symbol.for("uppy test: updateTotalProgress")](){return b(this,S,Rs).call(this)}updateOnlineStatus(){window.navigator.onLine??!0?(this.emit("is-online"),this.wasOffline&&(this.emit("back-online"),this.info(this.i18n("connectedToInternet"),"success",3e3),this.wasOffline=!1)):(this.emit("is-offline"),this.info(this.i18n("noInternetConnection"),"error",0),this.wasOffline=!0)}getID(){return this.opts.id}use(t,...e){if(typeof t!="function"){const r=`Expected a plugin class, but got ${t===null?"null":typeof t}. Please verify that the plugin was imported and spelled correctly.`;throw new TypeError(r)}const s=new t(this,...e),n=s.id;if(!n)throw new Error("Your plugin must have an id");if(!s.type)throw new Error("Your plugin must have a type");const o=this.getPlugin(n);if(o){const r=`Already found a plugin named '${o.id}'. Tried to use: '${n}'.
Uppy plugins must have unique \`id\` options.`;throw new Error(r)}return t.VERSION&&this.log(`Using ${n} v${t.VERSION}`),s.type in u(this,J)?u(this,J)[s.type].push(s):u(this,J)[s.type]=[s],s.install(),this.emit("plugin-added",s),this}getPlugin(t){for(const e of Object.values(u(this,J))){const s=e.find(n=>n.id===t);if(s!=null)return s}}[Symbol.for("uppy test: getPlugins")](t){return u(this,J)[t]}iteratePlugins(t){Object.values(u(this,J)).flat(1).forEach(t)}removePlugin(t){this.log(`Removing plugin ${t.id}`),this.emit("plugin-remove",t),t.uninstall&&t.uninstall();const e=u(this,J)[t.type],s=e.findIndex(r=>r.id===t.id);s!==-1&&e.splice(s,1);const o={plugins:{...this.getState().plugins,[t.id]:void 0}};this.setState(o)}destroy(){this.log(`Closing Uppy instance ${this.opts.id}: removing all files and uninstalling plugins`),this.cancelAll(),u(this,yt).call(this),this.iteratePlugins(t=>{this.removePlugin(t)}),typeof window<"u"&&window.removeEventListener&&(window.removeEventListener("online",u(this,be)),window.removeEventListener("offline",u(this,be)))}hideInfo(){const{info:t}=this.getState();this.setState({info:t.slice(1)}),this.emit("info-hidden")}info(t,e="info",s=3e3){const n=typeof t=="object";this.setState({info:[...this.getState().info,{type:e,message:n?t.message:t,details:n?t.details:null}]}),setTimeout(()=>this.hideInfo(),s),this.emit("info-visible")}log(t,e){const{logger:s}=this.opts;switch(e){case"error":s.error(t);break;case"warning":s.warn(t);break;default:s.debug(t);break}}registerRequestClient(t,e){u(this,bt).set(t,e)}getRequestClientForFile(t){if(!t.remote)throw new Error(`Tried to get RequestClient for a non-remote file ${t.id}`);const e=u(this,bt).get(t.remote.requestClientId);if(e==null)throw new Error(`requestClientId "${t.remote.requestClientId}" not registered for file "${t.id}"`);return e}restore(t){return this.log(`Core: attempting to restore upload "${t}"`),this.getState().currentUploads[t]?b(this,S,ct).call(this,t):(b(this,S,qt).call(this,t),Promise.reject(new Error("Nonexistent upload")))}[Symbol.for("uppy test: createUpload")](...t){return b(this,S,ut).call(this,...t)}addResultData(t,e){if(!b(this,S,Wi).call(this,t)){this.log(`Not setting result for an upload that has been removed: ${t}`);return}const{currentUploads:s}=this.getState(),n={...s[t],result:{...s[t].result,...e}};this.setState({currentUploads:{...s,[t]:n}})}async upload(){var n;(n=u(this,J).uploader)!=null&&n.length||this.log("No uploader type plugins are used","warning");let{files:t}=this.getState();if(b(this,S,ks).call(this).length>0){const o=await b(this,S,Ms).call(this);if(!(this.getFiles().filter(a=>a.progress.uploadStarted==null).length>0))return this.emit("complete",o),o;({files:t}=this.getState())}const s=this.opts.onBeforeUpload(t);return s===!1?Promise.reject(new Error("Not starting the upload because onBeforeUpload returned false")):(s&&typeof s=="object"&&(t=s,this.setState({files:t})),Promise.resolve().then(()=>u(this,Q).validateMinNumberOfFiles(t)).catch(o=>{throw b(this,S,Pe).call(this,[o]),o}).then(()=>{if(!b(this,S,ji).call(this,t))throw new ie(this.i18n("missingRequiredMetaField"))}).catch(o=>{throw o}).then(async()=>{const{currentUploads:o}=this.getState(),r=Object.values(o).flatMap(c=>c.fileIDs),a=[];Object.keys(t).forEach(c=>{const m=this.getFile(c);!m.progress.uploadStarted&&r.indexOf(c)===-1&&a.push(m.id)});const d=b(this,S,ut).call(this,a),p=await b(this,S,ct).call(this,d);return this.emit("complete",p),p}).catch(o=>{throw this.emit("error",o),this.log(o,"error"),o}))}};J=new WeakMap,Q=new WeakMap,yt=new WeakMap,xe=new WeakMap,_e=new WeakMap,qe=new WeakMap,Ee=new WeakMap,S=new WeakSet,Pe=function(t){for(const r of t)r.isRestriction?this.emit("restriction-failed",r.file,r):this.emit("error",r,r.file),this.log(r,"warning");const e=t.filter(r=>r.isUserFacing),s=4,n=e.slice(0,s),o=e.slice(s);n.forEach(({message:r,details:a=""})=>{this.info({message:r,details:a},"error",this.opts.infoTimeout)}),o.length>0&&this.info({message:this.i18n("additionalRestrictionsFailed",{count:o.length})})},Es=function(t){const{missingFields:e,error:s}=u(this,Q).getMissingRequiredMetaFields(t);return e.length>0?(this.setFileState(t.id,{missingRequiredMetaFields:e}),this.log(s.message),this.emit("restriction-failed",t,s),!1):(e.length===0&&t.missingRequiredMetaFields&&this.setFileState(t.id,{missingRequiredMetaFields:[]}),!0)},ji=function(t){let e=!0;for(const s of Object.values(t))b(this,S,Es).call(this,s)||(e=!1);return e},Ns=function(t){const{allowNewUpload:e}=this.getState();if(e===!1){const s=new ie(this.i18n("noMoreFilesAllowed"),{file:t});throw b(this,S,Pe).call(this,[s]),s}},_i=function(t){const e=t instanceof File?{name:t.name,type:t.type,size:t.size,data:t}:t,s=Li(e),n=tr(s,e),o=Bi(n).extension,r=Ro(e,this.getID()),a=e.meta||{};a.name=n,a.type=s;const d=Number.isFinite(e.data.size)?e.data.size:null;return{source:e.source||"",id:r,name:n,extension:o||"",meta:{...this.getState().meta,...a},type:s,data:e.data,progress:{percentage:0,bytesUploaded:!1,bytesTotal:d,uploadComplete:!1,uploadStarted:null},size:d,isGhost:!1,isRemote:e.isRemote||!1,remote:e.remote,preview:e.preview}},Us=function(){this.opts.autoProceed&&!this.scheduledAutoProceed&&(this.scheduledAutoProceed=setTimeout(()=>{this.scheduledAutoProceed=null,this.upload().catch(t=>{t.isRestriction||this.log(t.stack||t.message||t)})},4))},As=function(t){var r;let{files:e}=this.getState(),s={...e};const n=[],o=[];for(const a of t)try{let d=b(this,S,_i).call(this,a);const p=(r=e[d.id])==null?void 0:r.isGhost;p&&(d={...e[d.id],isGhost:!1,data:a.data},this.log(`Replaced the blob in the restored ghost file: ${d.name}, ${d.id}`));const c=this.opts.onBeforeFileAdded(d,s);if(e=this.getState().files,s={...e,...s},!c&&this.checkIfFileAlreadyExists(d.id))throw new ie(this.i18n("noDuplicates",{fileName:d.name??this.i18n("unnamed")}),{file:a});if(c===!1&&!p)throw new ie("Cannot add the file because onBeforeFileAdded returned false.",{isUserFacing:!1,file:a});typeof c=="object"&&c!==null&&(d=c),u(this,Q).validateSingleFile(d),s[d.id]=d,n.push(d)}catch(d){o.push(d)}try{u(this,Q).validateAggregateRestrictions(Object.values(e),n)}catch(a){return o.push(a),{nextFilesState:e,validFilesToAdd:[],errors:o}}return{nextFilesState:s,validFilesToAdd:n,errors:o}},ks=function(){const{files:t}=this.getState();return Object.keys(t).filter(e=>t[e].error)},Ms=async function(){const t=b(this,S,ks).call(this),e={...this.getState().files};if(t.forEach(n=>{e[n]={...e[n],isPaused:!1,error:null}}),this.setState({files:e,error:null}),this.emit("retry-all",this.getFilesByIds(t)),t.length===0)return{successful:[],failed:[]};const s=b(this,S,ut).call(this,t,{forceAllowNewUpload:!0});return b(this,S,ct).call(this,s)},Kt=new WeakMap,Rs=function(){const t=b(this,S,qi).call(this);let e=null;t!=null&&(e=Math.round(t*100),e>100?e=100:e<0&&(e=0)),this.emit("progress",e??0),this.setState({totalProgress:e??0})},Ne=new WeakMap,qi=function(){const e=this.getFiles().filter(d=>d.progress.uploadStarted||d.progress.preprocess||d.progress.postprocess);if(e.length===0)return 0;if(e.every(d=>d.progress.uploadComplete))return 1;const s=d=>d.progress.bytesTotal!=null&&d.progress.bytesTotal!==0,n=e.filter(s),o=e.filter(d=>!s(d));if(n.every(d=>d.progress.uploadComplete)&&o.length>0&&!o.every(d=>d.progress.uploadComplete))return null;const r=n.reduce((d,p)=>d+(p.progress.bytesTotal??0),0),a=n.reduce((d,p)=>d+(p.progress.bytesUploaded||0),0);return r===0?0:a/r},Hi=function(){const t=(n,o,r)=>{let a=n.message||"Unknown error";n.details&&(a+=` ${n.details}`),this.setState({error:a}),o!=null&&o.id in this.getState().files&&this.setFileState(o.id,{error:a,response:r})};this.on("error",t),this.on("upload-error",(n,o,r)=>{if(t(o,n,r),typeof o=="object"&&o.message){this.log(o.message,"error");const a=new Error(this.i18n("failedToUpload",{file:(n==null?void 0:n.name)??""}));a.isUserFacing=!0,a.details=o.message,o.details&&(a.details+=` ${o.details}`),b(this,S,Pe).call(this,[a])}else b(this,S,Pe).call(this,[o])});let e=null;this.on("upload-stalled",(n,o)=>{const{message:r}=n,a=o.map(d=>d.meta.name).join(", ");e||(this.info({message:r,details:a},"warning",this.opts.infoTimeout),e=setTimeout(()=>{e=null},this.opts.infoTimeout)),this.log(`${r} ${a}`.trim(),"warning")}),this.on("upload",()=>{this.setState({error:null})});const s=n=>{const o=n.filter(a=>{const d=a!=null&&this.getFile(a.id);return d||this.log(`Not setting progress for a file that has been removed: ${a==null?void 0:a.id}`),d}),r=Object.fromEntries(o.map(a=>[a.id,{progress:{uploadStarted:Date.now(),uploadComplete:!1,bytesUploaded:0,bytesTotal:a.size}}]));this.patchFilesState(r)};this.on("upload-start",s),this.on("upload-progress",u(this,Kt)),this.on("upload-success",(n,o)=>{if(n==null||!this.getFile(n.id)){this.log(`Not setting progress for a file that has been removed: ${n==null?void 0:n.id}`);return}const r=this.getFile(n.id).progress;this.setFileState(n.id,{progress:{...r,postprocess:u(this,Ee).size>0?{mode:"indeterminate"}:void 0,uploadComplete:!0,percentage:100,bytesUploaded:r.bytesTotal},response:o,uploadURL:o.uploadURL,isPaused:!1}),n.size==null&&this.setFileState(n.id,{size:o.bytesUploaded||r.bytesTotal}),u(this,Ne).call(this)}),this.on("preprocess-progress",(n,o)=>{if(n==null||!this.getFile(n.id)){this.log(`Not setting progress for a file that has been removed: ${n==null?void 0:n.id}`);return}this.setFileState(n.id,{progress:{...this.getFile(n.id).progress,preprocess:o}})}),this.on("preprocess-complete",n=>{if(n==null||!this.getFile(n.id)){this.log(`Not setting progress for a file that has been removed: ${n==null?void 0:n.id}`);return}const o={...this.getState().files};o[n.id]={...o[n.id],progress:{...o[n.id].progress}},delete o[n.id].progress.preprocess,this.setState({files:o})}),this.on("postprocess-progress",(n,o)=>{if(n==null||!this.getFile(n.id)){this.log(`Not setting progress for a file that has been removed: ${n==null?void 0:n.id}`);return}this.setFileState(n.id,{progress:{...this.getState().files[n.id].progress,postprocess:o}})}),this.on("postprocess-complete",n=>{if(n==null||!this.getFile(n.id)){this.log(`Not setting progress for a file that has been removed: ${n==null?void 0:n.id}`);return}const o={...this.getState().files};o[n.id]={...o[n.id],progress:{...o[n.id].progress}},delete o[n.id].progress.postprocess,this.setState({files:o})}),this.on("restored",()=>{u(this,Ne).call(this)}),this.on("dashboard:file-edit-complete",n=>{n&&b(this,S,Es).call(this,n)}),typeof window<"u"&&window.addEventListener&&(window.addEventListener("online",u(this,be)),window.addEventListener("offline",u(this,be)),setTimeout(u(this,be),3e3))},be=new WeakMap,bt=new WeakMap,ut=function(t,e={}){const{forceAllowNewUpload:s=!1}=e,{allowNewUpload:n,currentUploads:o}=this.getState();if(!n&&!s)throw new Error("Cannot create a new upload: already uploading.");const r=$o();return this.emit("upload",r,this.getFilesByIds(t)),this.setState({allowNewUpload:this.opts.allowMultipleUploadBatches!==!1&&this.opts.allowMultipleUploads!==!1,currentUploads:{...o,[r]:{fileIDs:t,step:0,result:{}}}}),r},Wi=function(t){const{currentUploads:e}=this.getState();return e[t]},qt=function(t){const e={...this.getState().currentUploads};delete e[t],this.setState({currentUploads:e})},ct=async function(t){const e=()=>{const{currentUploads:r}=this.getState();return r[t]};let s=e();const n=[...u(this,_e),...u(this,qe),...u(this,Ee)];try{for(let r=s.step||0;r<n.length&&s;r++){const a=n[r];this.setState({currentUploads:{...this.getState().currentUploads,[t]:{...s,step:r}}});const{fileIDs:d}=s;await a(d,t),s=e()}}catch(r){throw b(this,S,qt).call(this,t),r}if(s){s.fileIDs.forEach(p=>{const c=this.getFile(p);c!=null&&c.progress.postprocess&&this.emit("postprocess-complete",c)});const r=s.fileIDs.map(p=>this.getFile(p)),a=r.filter(p=>!p.error),d=r.filter(p=>p.error);this.addResultData(t,{successful:a,failed:d,uploadID:t}),s=e()}let o;return s&&(o=s.result,b(this,S,qt).call(this,t)),o==null&&(this.log(`Not setting result for an upload that has been removed: ${t}`),o={successful:[],failed:[],uploadID:t}),o},h(Xt,"VERSION",er.version);let xs=Xt;var pr=0;function l(i,t,e,s,n,o){t||(t={});var r,a,d=t;if("ref"in d)for(a in d={},t)a=="ref"?r=t[a]:d[a]=t[a];var p={type:i,props:d,key:e,ref:r,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--pr,__i:-1,__u:0,__source:n,__self:o};if(typeof i=="function"&&(r=i.defaultProps))for(a in r)d[a]===void 0&&(d[a]=r[a]);return Zs.vnode&&Zs.vnode(p),p}const hr="@uppy/informer",mr="A notification and error pop-up bar for Uppy.",fr="4.3.2",gr="MIT",yr="lib/index.js",br="dist/style.min.css",vr="module",wr={build:"tsc --build tsconfig.build.json","build:css":"sass --load-path=../../ src/style.scss dist/style.css && postcss dist/style.css -u cssnano -o dist/style.min.css",typecheck:"tsc --build"},Fr=["file uploader","uppy","uppy-plugin","notification","bar","ui"],Cr="https://uppy.io",Sr={url:"https://github.com/transloadit/uppy/issues"},Pr={type:"git",url:"git+https://github.com/transloadit/uppy.git"},Tr=["src","lib","dist","CHANGELOG.md"],xr={"@uppy/utils":"^6.2.2",preact:"^10.5.13"},Er={"@uppy/core":"^4.5.2"},Nr={cssnano:"^7.0.7",postcss:"^8.5.6","postcss-cli":"^11.0.1",sass:"^1.89.2",typescript:"^5.8.3"},Ur={name:hr,description:mr,version:fr,license:gr,main:yr,style:br,type:vr,scripts:wr,keywords:Fr,homepage:Cr,bugs:Sr,repository:Pr,files:Tr,dependencies:xr,peerDependencies:Er,devDependencies:Nr},li=300;class Ar extends as{constructor(){super(...arguments);h(this,"ref",Rn())}componentWillEnter(e){this.ref.current.style.opacity="1",this.ref.current.style.transform="none",setTimeout(e,li)}componentWillLeave(e){this.ref.current.style.opacity="0",this.ref.current.style.transform="translateY(350%)",setTimeout(e,li)}render(){const{children:e}=this.props;return l("div",{className:"uppy-Informer-animated",ref:this.ref,children:e})}}class Gi extends at{constructor(e,s){super(e,s);h(this,"render",e=>l("div",{className:"uppy uppy-Informer",children:l(Dn,{children:e.info.map(s=>l(Ar,{children:l("p",{role:"alert",children:[s.message," ",s.details&&l("span",{"aria-label":s.details,"data-microtip-position":"top-left","data-microtip-size":"medium",role:"tooltip",onClick:()=>alert(`${s.message} 

 ${s.details}`),children:"?"})]})},s.message))})}));this.type="progressindicator",this.id=this.opts.id||"Informer",this.title="Informer"}install(){const{target:e}=this.opts;e&&this.mount(e,this)}}h(Gi,"VERSION",Ur.version);const kr={position:"relative",width:"100%",minHeight:"100%"},Mr={position:"absolute",top:0,left:0,width:"100%",overflow:"visible"};class Rr extends as{constructor(e){super(e);h(this,"handleScroll",()=>{this.setState({offset:this.base.scrollTop})});h(this,"handleResize",()=>{this.resize()});this.focusElement=null,this.state={offset:0,height:0}}componentDidMount(){this.resize(),window.addEventListener("resize",this.handleResize)}componentWillUpdate(){this.base.contains(document.activeElement)&&(this.focusElement=document.activeElement)}componentDidUpdate(){var e;(e=this.focusElement)!=null&&e.parentNode&&document.activeElement!==this.focusElement&&this.focusElement.focus(),this.focusElement=null,this.resize()}componentWillUnmount(){window.removeEventListener("resize",this.handleResize)}resize(){const{height:e}=this.state;e!==this.base.offsetHeight&&this.setState({height:this.base.offsetHeight})}render({data:e,rowHeight:s,renderRow:n,overscanCount:o=10,...r}){const{offset:a,height:d}=this.state;let p=Math.floor(a/s),c=Math.floor(d/s);o&&(p=Math.max(0,p-p%o),c+=o);const m=p+c+4,v=e.slice(p,m),w={...kr,height:e.length*s},C={...Mr,top:p*s};return l("div",{onScroll:this.handleScroll,...r,children:l("div",{role:"presentation",style:w,children:l("div",{role:"presentation",style:C,children:v.map(n)})})})}}function Dr(){return l("svg",{"aria-hidden":"true",focusable:"false",width:"30",height:"30",viewBox:"0 0 30 30",children:l("path",{d:"M15 30c8.284 0 15-6.716 15-15 0-8.284-6.716-15-15-15C6.716 0 0 6.716 0 15c0 8.284 6.716 15 15 15zm4.258-12.676v6.846h-8.426v-6.846H5.204l9.82-12.364 9.82 12.364H19.26z"})})}function di(i,t,e,s){return i===t?i:s===0?t:i+(t-i)*2**(-s/e)}const Ir="@uppy/status-bar",Or="A progress bar for Uppy, with many bells and whistles.",$r="4.2.2",Br="MIT",Lr="lib/index.js",zr="dist/style.min.css",jr="module",_r={build:"tsc --build tsconfig.build.json","build:css":"sass --load-path=../../ src/style.scss dist/style.css && postcss dist/style.css -u cssnano -o dist/style.min.css",typecheck:"tsc --build"},qr=["file uploader","uppy","uppy-plugin","progress bar","status bar","progress","upload","eta","speed"],Hr="https://uppy.io",Wr={url:"https://github.com/transloadit/uppy/issues"},Gr={type:"git",url:"git+https://github.com/transloadit/uppy.git"},Vr=["src","lib","dist","CHANGELOG.md"],Kr={"@transloadit/prettier-bytes":"^0.3.4","@uppy/utils":"^6.2.2",classnames:"^2.2.6",preact:"^10.5.13"},Xr={"@uppy/core":"^4.5.2"},Yr={cssnano:"^7.0.7",postcss:"^8.5.6","postcss-cli":"^11.0.1",sass:"^1.89.2",typescript:"^5.8.3"},Jr={name:Ir,description:Or,version:$r,license:Br,main:Lr,style:zr,type:jr,scripts:_r,keywords:qr,homepage:Hr,bugs:Wr,repository:Gr,files:Vr,dependencies:Kr,peerDependencies:Xr,devDependencies:Yr},Qr={strings:{uploading:"Uploading",complete:"Complete",uploadFailed:"Upload failed",paused:"Paused",retry:"Retry",cancel:"Cancel",pause:"Pause",resume:"Resume",done:"Done",filesUploadedOfTotal:{0:"%{complete} of %{smart_count} file uploaded",1:"%{complete} of %{smart_count} files uploaded"},dataUploadedOfTotal:"%{complete} of %{total}",dataUploadedOfUnknown:"%{complete} of unknown",xTimeLeft:"%{time} left",uploadXFiles:{0:"Upload %{smart_count} file",1:"Upload %{smart_count} files"},uploadXNewFiles:{0:"Upload +%{smart_count} file",1:"Upload +%{smart_count} files"},upload:"Upload",retryUpload:"Retry upload",xMoreFilesAdded:{0:"%{smart_count} more file added",1:"%{smart_count} more files added"},showErrorDetails:"Show error details"}},ae={STATE_ERROR:"error",STATE_WAITING:"waiting",STATE_PREPROCESSING:"preprocessing",STATE_UPLOADING:"uploading",STATE_POSTPROCESSING:"postprocessing",STATE_COMPLETE:"complete"};function Zr(i){const t=Math.floor(i/3600)%24,e=Math.floor(i/60)%60,s=Math.floor(i%60);return{hours:t,minutes:e,seconds:s}}function ea(i){const t=Zr(i),e=t.hours===0?"":`${t.hours}h`,s=t.minutes===0?"":`${t.hours===0?t.minutes:` ${t.minutes.toString(10).padStart(2,"0")}`}m`,n=t.hours!==0?"":`${t.minutes===0?t.seconds:` ${t.seconds.toString(10).padStart(2,"0")}`}s`;return`${e}${s}${n}`}const ta="Â·",ui=()=>` ${ta} `;function sa(i){const{newFiles:t,isUploadStarted:e,recoveredState:s,i18n:n,uploadState:o,isSomeGhost:r,startUpload:a}=i,d=ne("uppy-u-reset","uppy-c-btn","uppy-StatusBar-actionBtn","uppy-StatusBar-actionBtn--upload",{"uppy-c-btn-primary":o===ae.STATE_WAITING},{"uppy-StatusBar-actionBtn--disabled":r}),p=t&&e&&!s?n("uploadXNewFiles",{smart_count:t}):n("uploadXFiles",{smart_count:t});return l("button",{type:"button",className:d,"aria-label":n("uploadXFiles",{smart_count:t}),onClick:a,disabled:r,"data-uppy-super-focusable":!0,children:p})}function ia(i){const{i18n:t,uppy:e}=i;return l("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-StatusBar-actionBtn uppy-StatusBar-actionBtn--retry","aria-label":t("retryUpload"),onClick:()=>e.retryAll().catch(()=>{}),"data-uppy-super-focusable":!0,"data-cy":"retry",children:[l("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"8",height:"10",viewBox:"0 0 8 10",children:l("path",{d:"M4 2.408a2.75 2.75 0 1 0 2.75 2.75.626.626 0 0 1 1.25.018v.023a4 4 0 1 1-4-4.041V.25a.25.25 0 0 1 .389-.208l2.299 1.533a.25.25 0 0 1 0 .416l-2.3 1.533A.25.25 0 0 1 4 3.316v-.908z"})}),t("retry")]})}function na(i){const{i18n:t,uppy:e}=i;return l("button",{type:"button",className:"uppy-u-reset uppy-StatusBar-actionCircleBtn",title:t("cancel"),"aria-label":t("cancel"),onClick:()=>e.cancelAll(),"data-cy":"cancel","data-uppy-super-focusable":!0,children:l("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"16",height:"16",viewBox:"0 0 16 16",children:l("g",{fill:"none",fillRule:"evenodd",children:[l("circle",{fill:"#888",cx:"8",cy:"8",r:"8"}),l("path",{fill:"#FFF",d:"M9.283 8l2.567 2.567-1.283 1.283L8 9.283 5.433 11.85 4.15 10.567 6.717 8 4.15 5.433 5.433 4.15 8 6.717l2.567-2.567 1.283 1.283z"})]})})})}function oa(i){const{isAllPaused:t,i18n:e,isAllComplete:s,resumableUploads:n,uppy:o}=i,r=e(t?"resume":"pause");function a(){if(!s){if(!n){o.cancelAll();return}if(t){o.resumeAll();return}o.pauseAll()}}return l("button",{title:r,"aria-label":r,className:"uppy-u-reset uppy-StatusBar-actionCircleBtn",type:"button",onClick:a,"data-cy":"togglePauseResume","data-uppy-super-focusable":!0,children:l("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"16",height:"16",viewBox:"0 0 16 16",children:l("g",{fill:"none",fillRule:"evenodd",children:[l("circle",{fill:"#888",cx:"8",cy:"8",r:"8"}),l("path",{fill:"#FFF",d:t?"M6 4.25L11.5 8 6 11.75z":"M5 4.5h2v7H5v-7zm4 0h2v7H9v-7z"})]})})})}function ra(i){const{i18n:t,doneButtonHandler:e}=i;return l("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-StatusBar-actionBtn uppy-StatusBar-actionBtn--done",onClick:e,"data-uppy-super-focusable":!0,children:t("done")})}function Vi(){return l("svg",{className:"uppy-StatusBar-spinner","aria-hidden":"true",focusable:"false",width:"14",height:"14",children:l("path",{d:"M13.983 6.547c-.12-2.509-1.64-4.893-3.939-5.936-2.48-1.127-5.488-.656-7.556 1.094C.524 3.367-.398 6.048.162 8.562c.556 2.495 2.46 4.52 4.94 5.183 2.932.784 5.61-.602 7.256-3.015-1.493 1.993-3.745 3.309-6.298 2.868-2.514-.434-4.578-2.349-5.153-4.84a6.226 6.226 0 0 1 2.98-6.778C6.34.586 9.74 1.1 11.373 3.493c.407.596.693 1.282.842 1.988.127.598.073 1.197.161 1.794.078.525.543 1.257 1.15.864.525-.341.49-1.05.456-1.592-.007-.15.02.3 0 0",fillRule:"evenodd"})})}function aa(i){const{progress:t}=i,{value:e,mode:s,message:n}=t;return l("div",{className:"uppy-StatusBar-content",children:[l(Vi,{}),s==="determinate"?`${Math.round(e*100)}% Â· `:"",n]})}function la(i){const{numUploads:t,complete:e,totalUploadedSize:s,totalSize:n,totalETA:o,i18n:r}=i,a=t>1,d=Te(s);return l("div",{className:"uppy-StatusBar-statusSecondary",children:[a&&r("filesUploadedOfTotal",{complete:e,smart_count:t}),l("span",{className:"uppy-StatusBar-additionalInfo",children:[a&&ui(),n!=null?r("dataUploadedOfTotal",{complete:d,total:Te(n)}):r("dataUploadedOfUnknown",{complete:d}),ui(),o!=null&&r("xTimeLeft",{time:ea(o)})]})]})}function Ki(i){const{i18n:t,complete:e,numUploads:s}=i;return l("div",{className:"uppy-StatusBar-statusSecondary",children:t("filesUploadedOfTotal",{complete:e,smart_count:s})})}function da(i){const{i18n:t,newFiles:e,startUpload:s}=i,n=ne("uppy-u-reset","uppy-c-btn","uppy-StatusBar-actionBtn","uppy-StatusBar-actionBtn--uploadNewlyAdded");return l("div",{className:"uppy-StatusBar-statusSecondary",children:[l("div",{className:"uppy-StatusBar-statusSecondaryHint",children:t("xMoreFilesAdded",{smart_count:e})}),l("button",{type:"button",className:n,"aria-label":t("uploadXFiles",{smart_count:e}),onClick:s,children:t("upload")})]})}function ua(i){const{i18n:t,supportsUploadProgress:e,totalProgress:s,showProgressDetails:n,isUploadStarted:o,isAllComplete:r,isAllPaused:a,newFiles:d,numUploads:p,complete:c,totalUploadedSize:m,totalSize:v,totalETA:w,startUpload:C}=i,E=d&&o;if(!o||r)return null;const U=t(a?"paused":"uploading");function N(){return!a&&!E&&n?e?l(la,{numUploads:p,complete:c,totalUploadedSize:m,totalSize:v,totalETA:w,i18n:t}):l(Ki,{i18n:t,complete:c,numUploads:p}):null}return l("div",{className:"uppy-StatusBar-content",title:U,children:[a?null:l(Vi,{}),l("div",{className:"uppy-StatusBar-status",children:[l("div",{className:"uppy-StatusBar-statusPrimary",children:e&&s!==0?`${U}: ${s}%`:U}),N(),E?l(da,{i18n:t,newFiles:d,startUpload:C}):null]})]})}function ca(i){const{i18n:t}=i;return l("div",{className:"uppy-StatusBar-content",role:"status",title:t("complete"),children:l("div",{className:"uppy-StatusBar-status",children:l("div",{className:"uppy-StatusBar-statusPrimary",children:[l("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-StatusBar-statusIndicator uppy-c-icon",width:"15",height:"11",viewBox:"0 0 15 11",children:l("path",{d:"M.414 5.843L1.627 4.63l3.472 3.472L13.202 0l1.212 1.213L5.1 10.528z"})}),t("complete")]})})})}function pa(i){const{error:t,i18n:e,complete:s,numUploads:n}=i;function o(){const r=`${e("uploadFailed")} 

 ${t}`;alert(r)}return l("div",{className:"uppy-StatusBar-content",title:e("uploadFailed"),children:[l("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-StatusBar-statusIndicator uppy-c-icon",width:"11",height:"11",viewBox:"0 0 11 11",children:l("path",{d:"M4.278 5.5L0 1.222 1.222 0 5.5 4.278 9.778 0 11 1.222 6.722 5.5 11 9.778 9.778 11 5.5 6.722 1.222 11 0 9.778z"})}),l("div",{className:"uppy-StatusBar-status",children:[l("div",{className:"uppy-StatusBar-statusPrimary",children:[e("uploadFailed"),l("button",{className:"uppy-u-reset uppy-StatusBar-details","aria-label":e("showErrorDetails"),"data-microtip-position":"top-right","data-microtip-size":"medium",onClick:o,type:"button",children:"?"})]}),l(Ki,{i18n:e,complete:s,numUploads:n})]})]})}function cs(i){const t=[];let e="indeterminate",s;for(const{progress:o}of Object.values(i)){const{preprocess:r,postprocess:a}=o;s==null&&(r||a)&&({mode:e,message:s}=r||a),(r==null?void 0:r.mode)==="determinate"&&t.push(r.value),(a==null?void 0:a.mode)==="determinate"&&t.push(a.value)}const n=t.reduce((o,r)=>o+r/t.length,0);return{mode:e,message:s,value:n}}const{STATE_ERROR:ci,STATE_WAITING:ha,STATE_PREPROCESSING:ps,STATE_UPLOADING:$t,STATE_POSTPROCESSING:hs,STATE_COMPLETE:Bt}=ae;function ma({newFiles:i,allowNewUpload:t,isUploadInProgress:e,isAllPaused:s,resumableUploads:n,error:o,hideUploadButton:r=void 0,hidePauseResumeButton:a=!1,hideCancelButton:d=!1,hideRetryButton:p=!1,recoveredState:c,uploadState:m,totalProgress:v,files:w,supportsUploadProgress:C,hideAfterFinish:E=!1,isSomeGhost:U,doneButtonHandler:N=void 0,isUploadStarted:R,i18n:k,startUpload:A,uppy:O,isAllComplete:D,showProgressDetails:T=void 0,numUploads:z,complete:f,totalSize:P,totalETA:x,totalUploadedSize:I}){function $(){switch(m){case hs:case ps:{const It=cs(w);return It.mode==="determinate"?It.value*100:v}case ci:return null;case $t:return C?v:null;default:return v}}function M(){switch(m){case hs:case ps:{const{mode:It}=cs(w);return It==="indeterminate"}case $t:return!C;default:return!1}}const B=$(),L=B??100,V=!o&&i&&(!e&&!s||c)&&t&&!r,Y=!d&&m!==ha&&m!==Bt,Se=n&&!a&&m===$t,Ks=o&&!D&&!p,Xs=N&&m===Bt,En=ne("uppy-StatusBar-progress",{"is-indeterminate":M()}),Nn=ne("uppy-StatusBar",`is-${m}`,{"has-ghosts":U}),Ys=(()=>{switch(m){case ps:case hs:return l(aa,{progress:cs(w)});case Bt:return l(ca,{i18n:k});case ci:return l(pa,{error:o,i18n:k,numUploads:z,complete:f});case $t:return l(ua,{i18n:k,supportsUploadProgress:C,totalProgress:v,showProgressDetails:T,isUploadStarted:R,isAllComplete:D,isAllPaused:s,newFiles:i,numUploads:z,complete:f,totalUploadedSize:I,totalSize:P,totalETA:x,startUpload:A});default:return null}})();return!(V||Ks||Se||Y||Xs)&&!Ys||m===Bt&&E?null:l("div",{className:Nn,children:[l("div",{className:En,style:{width:`${L}%`},role:"progressbar","aria-label":`${L}%`,"aria-valuetext":`${L}%`,"aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":B}),Ys,l("div",{className:"uppy-StatusBar-actions",children:[V?l(sa,{newFiles:i,isUploadStarted:R,recoveredState:c,i18n:k,isSomeGhost:U,startUpload:A,uploadState:m}):null,Ks?l(ia,{i18n:k,uppy:O}):null,Se?l(oa,{isAllPaused:s,i18n:k,isAllComplete:D,resumableUploads:n,uppy:O}):null,Y?l(na,{i18n:k,uppy:O}):null,Xs?l(ra,{i18n:k,doneButtonHandler:N}):null]})]})}const fa=2e3,ga=2e3;function ya(i,t,e,s){if(i)return ae.STATE_ERROR;if(t)return ae.STATE_COMPLETE;if(e)return ae.STATE_WAITING;let n=ae.STATE_WAITING;const o=Object.keys(s);for(let r=0;r<o.length;r++){const{progress:a}=s[o[r]];if(a.uploadStarted&&!a.uploadComplete)return ae.STATE_UPLOADING;a.preprocess&&(n=ae.STATE_PREPROCESSING),a.postprocess&&n!==ae.STATE_PREPROCESSING&&(n=ae.STATE_POSTPROCESSING)}return n}const ba={hideUploadButton:!1,hideRetryButton:!1,hidePauseResumeButton:!1,hideCancelButton:!1,showProgressDetails:!1,hideAfterFinish:!0,doneButtonHandler:null};var vs,ve,we,Ue,pe,Yt,Xi,vt;let va=(vs=class extends at{constructor(e,s){super(e,{...ba,...s});y(this,Yt);y(this,ve);y(this,we);y(this,Ue);y(this,pe);h(this,"startUpload",()=>this.uppy.upload().catch(()=>{}));y(this,vt,()=>{const{recoveredState:e}=this.uppy.getState();if(F(this,Ue,null),F(this,pe,null),e){F(this,we,Object.values(e.files).reduce((s,{progress:n})=>s+n.bytesUploaded,0)),this.uppy.emit("restore-confirmed");return}F(this,ve,performance.now()),F(this,we,0)});this.id=this.opts.id||"StatusBar",this.title="StatusBar",this.type="progressindicator",this.defaultLocale=Qr,this.i18nInit(),this.render=this.render.bind(this),this.install=this.install.bind(this)}render(e){const{capabilities:s,files:n,allowNewUpload:o,totalProgress:r,error:a,recoveredState:d}=e,{newFiles:p,startedFiles:c,completeFiles:m,isUploadStarted:v,isAllComplete:w,isAllPaused:C,isUploadInProgress:E,isSomeGhost:U}=this.uppy.getObjectOfFilesPerState(),N=d?Object.values(n):p,R=!!s.resumableUploads,k=s.uploadProgress!==!1;let A=null,O=0;c.every(T=>T.progress.bytesTotal!=null&&T.progress.bytesTotal!==0)?(A=0,c.forEach(T=>{A+=T.progress.bytesTotal||0,O+=T.progress.bytesUploaded||0})):c.forEach(T=>{O+=T.progress.bytesUploaded||0});const D=b(this,Yt,Xi).call(this,{uploaded:O,total:A});return ma({error:a,uploadState:ya(a,w,d,e.files||{}),allowNewUpload:o,totalProgress:r,totalSize:A,totalUploadedSize:O,isAllComplete:!1,isAllPaused:C,isUploadStarted:v,isUploadInProgress:E,isSomeGhost:U,recoveredState:d,complete:m.length,newFiles:N.length,numUploads:c.length,totalETA:D,files:n,i18n:this.i18n,uppy:this.uppy,startUpload:this.startUpload,doneButtonHandler:this.opts.doneButtonHandler,resumableUploads:R,supportsUploadProgress:k,showProgressDetails:this.opts.showProgressDetails,hideUploadButton:this.opts.hideUploadButton,hideRetryButton:this.opts.hideRetryButton,hidePauseResumeButton:this.opts.hidePauseResumeButton,hideCancelButton:this.opts.hideCancelButton,hideAfterFinish:this.opts.hideAfterFinish})}onMount(){const e=this.el;Ii(e)||(e.dir="ltr")}install(){const{target:e}=this.opts;e&&this.mount(e,this),this.uppy.on("upload",u(this,vt)),F(this,ve,performance.now()),F(this,we,this.uppy.getFiles().reduce((s,n)=>s+n.progress.bytesUploaded,0))}uninstall(){this.unmount(),this.uppy.off("upload",u(this,vt))}},ve=new WeakMap,we=new WeakMap,Ue=new WeakMap,pe=new WeakMap,Yt=new WeakSet,Xi=function(e){if(e.total==null||e.total===0)return null;const s=e.total-e.uploaded;if(s<=0)return null;u(this,ve)??F(this,ve,performance.now());const n=performance.now()-u(this,ve);if(n===0)return Math.round((u(this,pe)??0)/100)/10;const o=e.uploaded-u(this,we);if(F(this,we,e.uploaded),o<=0)return Math.round((u(this,pe)??0)/100)/10;const r=o/n,a=u(this,Ue)==null?r:di(r,u(this,Ue),fa,n);F(this,Ue,a);const d=s/a,p=Math.max(u(this,pe)-n,0),c=u(this,pe)==null?d:di(d,p,ga,n);return F(this,pe,c),F(this,ve,performance.now()),Math.round(c/100)/10},vt=new WeakMap,h(vs,"VERSION",Jr.version),vs);const wa=/^data:([^/]+\/[^,;]+(?:[^,]*?))(;base64)?,([\s\S]*)$/;function Fa(i,t,e){const s=wa.exec(i),n=t.mimeType??(s==null?void 0:s[1])??"plain/text";let o;if((s==null?void 0:s[2])!=null){const r=atob(decodeURIComponent(s[3])),a=new Uint8Array(r.length);for(let d=0;d<r.length;d++)a[d]=r.charCodeAt(d);o=[a]}else(s==null?void 0:s[3])!=null&&(o=[decodeURIComponent(s[3])]);return new Blob(o,{type:n})}function pi(i){return i.startsWith("blob:")}function hi(i){return i?/^[^/]+\/(jpe?g|gif|png|svg|svg\+xml|bmp|webp|avif)$/.test(i):!1}const Ca="@uppy/thumbnail-generator",Sa="Uppy plugin that generates small previews of images to show on your upload UI.",Pa="4.2.2",Ta="MIT",xa="lib/index.js",Ea="module",Na={build:"tsc --build tsconfig.build.json",typecheck:"tsc --build",test:"vitest run --environment=jsdom --silent='passed-only'"},Ua=["file uploader","uppy","uppy-plugin","thumbnail","preview","resize"],Aa="https://uppy.io",ka={url:"https://github.com/transloadit/uppy/issues"},Ma={type:"git",url:"git+https://github.com/transloadit/uppy.git"},Ra=["src","lib","dist","CHANGELOG.md"],Da={"@uppy/utils":"^6.2.2",exifr:"^7.0.0"},Ia={jsdom:"^26.1.0","namespace-emitter":"2.0.1",typescript:"^5.8.3",vitest:"^3.2.4"},Oa={"@uppy/core":"^4.5.2"},$a={name:Ca,description:Sa,version:Pa,license:Ta,main:xa,type:Ea,scripts:Na,keywords:Ua,homepage:Aa,bugs:ka,repository:Ma,files:Ra,dependencies:Da,devDependencies:Ia,peerDependencies:Oa},Ba={strings:{generatingThumbnails:"Generating thumbnails..."}};function La(i,t,e){try{i.getContext("2d").getImageData(0,0,1,1)}catch(s){if(s.code===18)return Promise.reject(new Error("cannot read image, probably an svg with external resources"))}return i.toBlob?new Promise(s=>{i.toBlob(s,t,e)}).then(s=>{if(s===null)throw new Error("cannot read image, probably an svg with external resources");return s}):Promise.resolve().then(()=>Fa(i.toDataURL(t,e),{})).then(s=>{if(s===null)throw new Error("could not extract blob, probably an old browser");return s})}function za(i,t){let e=i.width,s=i.height;(t.deg===90||t.deg===270)&&(e=i.height,s=i.width);const n=document.createElement("canvas");n.width=e,n.height=s;const o=n.getContext("2d");return o.translate(e/2,s/2),t.canvas&&(o.rotate(t.rad),o.scale(t.scaleX,t.scaleY)),o.drawImage(i,-i.width/2,-i.height/2,i.width,i.height),n}function ja(i){const t=i.width/i.height,e=5e6,s=4096;let n=Math.floor(Math.sqrt(e*t)),o=Math.floor(e/Math.sqrt(e*t));if(n>s&&(n=s,o=Math.round(n/t)),o>s&&(o=s,n=Math.round(t*o)),i.width>n){const r=document.createElement("canvas");return r.width=n,r.height=o,r.getContext("2d").drawImage(i,0,0,n,o),r}return i}const _a={thumbnailWidth:null,thumbnailHeight:null,thumbnailType:"image/jpeg",waitForThumbnailsBeforeUpload:!1,lazy:!1};class Yi extends at{constructor(e,s){super(e,{..._a,...s});h(this,"queue");h(this,"queueProcessing");h(this,"defaultThumbnailDimension");h(this,"thumbnailType");h(this,"onFileAdded",e=>{!e.preview&&e.data&&hi(e.type)&&!e.isRemote&&this.addToQueue(e.id)});h(this,"onCancelRequest",e=>{const s=this.queue.indexOf(e.id);s!==-1&&this.queue.splice(s,1)});h(this,"onFileRemoved",e=>{const s=this.queue.indexOf(e.id);s!==-1&&this.queue.splice(s,1),e.preview&&pi(e.preview)&&URL.revokeObjectURL(e.preview)});h(this,"onRestored",()=>{this.uppy.getFiles().filter(s=>s.isRestored).forEach(s=>{(!s.preview||pi(s.preview))&&this.addToQueue(s.id)})});h(this,"onAllFilesRemoved",()=>{this.queue=[]});h(this,"waitUntilAllProcessed",e=>{e.forEach(n=>{const o=this.uppy.getFile(n);this.uppy.emit("preprocess-progress",o,{mode:"indeterminate",message:this.i18n("generatingThumbnails")})});const s=()=>{e.forEach(n=>{const o=this.uppy.getFile(n);this.uppy.emit("preprocess-complete",o)})};return new Promise(n=>{this.queueProcessing?this.uppy.once("thumbnail:all-generated",()=>{s(),n()}):(s(),n())})});if(this.type="modifier",this.id=this.opts.id||"ThumbnailGenerator",this.title="Thumbnail Generator",this.queue=[],this.queueProcessing=!1,this.defaultThumbnailDimension=200,this.thumbnailType=this.opts.thumbnailType,this.defaultLocale=Ba,this.i18nInit(),this.opts.lazy&&this.opts.waitForThumbnailsBeforeUpload)throw new Error("ThumbnailGenerator: The `lazy` and `waitForThumbnailsBeforeUpload` options are mutually exclusive. Please ensure at most one of them is set to `true`.")}createThumbnail(e,s,n){const o=URL.createObjectURL(e.data),r=new Promise((d,p)=>{const c=new Image;c.src=o,c.addEventListener("load",()=>{URL.revokeObjectURL(o),d(c)}),c.addEventListener("error",m=>{URL.revokeObjectURL(o),p(m.error||new Error("Could not create thumbnail"))})}),a=In(e.data).catch(()=>1);return Promise.all([r,a]).then(([d,p])=>{const c=this.getProportionalDimensions(d,s,n,p.deg),m=za(d,p),v=this.resizeImage(m,c.width,c.height);return La(v,this.thumbnailType,80)}).then(d=>URL.createObjectURL(d))}getProportionalDimensions(e,s,n,o){let r=e.width/e.height;return(o===90||o===270)&&(r=e.height/e.width),s!=null?{width:s,height:Math.round(s/r)}:n!=null?{width:Math.round(n*r),height:n}:{width:this.defaultThumbnailDimension,height:Math.round(this.defaultThumbnailDimension/r)}}resizeImage(e,s,n){let o=ja(e),r=Math.ceil(Math.log2(o.width/s));r<1&&(r=1);let a=s*2**(r-1),d=n*2**(r-1);const p=2;for(;r--;){const c=document.createElement("canvas");c.width=a,c.height=d,c.getContext("2d").drawImage(o,0,0,a,d),o=c,a=Math.round(a/p),d=Math.round(d/p)}return o}setPreviewURL(e,s){this.uppy.setFileState(e,{preview:s})}addToQueue(e){this.queue.push(e),this.queueProcessing===!1&&this.processQueue()}processQueue(){if(this.queueProcessing=!0,this.queue.length>0){const e=this.uppy.getFile(this.queue.shift());return e?this.requestThumbnail(e).catch(()=>{}).then(()=>this.processQueue()):(this.uppy.log("[ThumbnailGenerator] file was removed before a thumbnail could be generated, but not removed from the queue. This is probably a bug","error"),Promise.resolve())}return this.queueProcessing=!1,this.uppy.log("[ThumbnailGenerator] Emptied thumbnail queue"),this.uppy.emit("thumbnail:all-generated"),Promise.resolve()}requestThumbnail(e){return hi(e.type)&&!e.isRemote?this.createThumbnail(e,this.opts.thumbnailWidth,this.opts.thumbnailHeight).then(s=>{this.setPreviewURL(e.id,s),this.uppy.log(`[ThumbnailGenerator] Generated thumbnail for ${e.id}`),this.uppy.emit("thumbnail:generated",this.uppy.getFile(e.id),s)}).catch(s=>{this.uppy.log(`[ThumbnailGenerator] Failed thumbnail for ${e.id}:`,"warning"),this.uppy.log(s,"warning"),this.uppy.emit("thumbnail:error",this.uppy.getFile(e.id),s)}):Promise.resolve()}install(){this.uppy.on("file-removed",this.onFileRemoved),this.uppy.on("cancel-all",this.onAllFilesRemoved),this.opts.lazy?(this.uppy.on("thumbnail:request",this.onFileAdded),this.uppy.on("thumbnail:cancel",this.onCancelRequest)):(this.uppy.on("thumbnail:request",this.onFileAdded),this.uppy.on("file-added",this.onFileAdded),this.uppy.on("restored",this.onRestored)),this.opts.waitForThumbnailsBeforeUpload&&this.uppy.addPreProcessor(this.waitUntilAllProcessed)}uninstall(){this.uppy.off("file-removed",this.onFileRemoved),this.uppy.off("cancel-all",this.onAllFilesRemoved),this.opts.lazy?(this.uppy.off("thumbnail:request",this.onFileAdded),this.uppy.off("thumbnail:cancel",this.onCancelRequest)):(this.uppy.off("thumbnail:request",this.onFileAdded),this.uppy.off("file-added",this.onFileAdded),this.uppy.off("restored",this.onRestored)),this.opts.waitForThumbnailsBeforeUpload&&this.uppy.removePreProcessor(this.waitUntilAllProcessed)}}h(Yi,"VERSION",$a.version);function mi(i){if(typeof i=="string"){const t=document.querySelectorAll(i);return t.length===0?null:Array.from(t)}return typeof i=="object"&&Di(i)?[i]:null}const ht=Array.from;function qa(i){const t=ht(i.files);return Promise.resolve(t)}function Ji(i,t,e,{onSuccess:s}){i.readEntries(n=>{const o=[...t,...n];n.length?queueMicrotask(()=>{Ji(i,o,e,{onSuccess:s})}):s(o)},n=>{e(n),s(t)})}function Qi(i,t){return i==null?i:{kind:i.isFile?"file":i.isDirectory?"directory":void 0,name:i.name,getFile(){return new Promise((e,s)=>i.file(e,s))},async*values(){const e=i.createReader();yield*await new Promise(n=>{Ji(e,[],t,{onSuccess:o=>n(o.map(r=>Qi(r,t)))})})},isSameEntry:void 0}}async function*Zi(i,t,e=void 0){const s=()=>`${t}/${i.name}`;if(i.kind==="file"){const n=await i.getFile();n!=null?(n.relativePath=t?s():null,yield n):e!=null&&(yield e)}else if(i.kind==="directory")for await(const n of i.values())yield*Zi(n,t?s():i.name);else e!=null&&(yield e)}async function*Ha(i,t){const e=await Promise.all(Array.from(i.items,async s=>{let n;return n??(n=Qi(typeof s.getAsEntry=="function"?s.getAsEntry():s.webkitGetAsEntry(),t)),{fileSystemHandle:n,lastResortFile:s.getAsFile()}}));for(const{lastResortFile:s,fileSystemHandle:n}of e)if(n!=null)try{yield*Zi(n,"",s)}catch(o){s!=null?yield s:t(o)}else s!=null&&(yield s)}async function Wa(i,t){const e=(t==null?void 0:t.logDropError)??Function.prototype;try{const s=[];for await(const n of Ha(i,e))s.push(n);return s}catch{return qa(i)}}let Ga="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",en=(i=21)=>{let t="",e=i|0;for(;e--;)t+=Ga[Math.random()*64|0];return t};const Va="@uppy/dashboard",Ka="Universal UI plugin for Uppy.",Xa="4.4.2",Ya="MIT",Ja="lib/index.js",Qa="dist/style.min.css",Za="module",el={build:"tsc --build tsconfig.build.json","build:css":"sass --load-path=../../ src/style.scss dist/style.css && postcss dist/style.css -u cssnano -o dist/style.min.css",typecheck:"tsc --build",test:"vitest run --silent='passed-only'","test:e2e":"vitest watch --project browser --browser.headless false"},tl=["file uploader","uppy","uppy-plugin","dashboard","ui"],sl="https://uppy.io",il={url:"https://github.com/transloadit/uppy/issues"},nl={type:"git",url:"git+https://github.com/transloadit/uppy.git"},ol=["src","lib","dist","CHANGELOG.md"],rl={"@transloadit/prettier-bytes":"^0.3.4","@uppy/informer":"^4.3.2","@uppy/provider-views":"^4.5.2","@uppy/status-bar":"^4.2.2","@uppy/thumbnail-generator":"^4.2.2","@uppy/utils":"^6.2.2",classnames:"^2.2.6",lodash:"^4.17.21",nanoid:"^5.0.9",preact:"^10.5.13","shallow-equal":"^3.0.0"},al={"@uppy/core":"^4.5.2","@uppy/google-drive":"^4.4.2","@uppy/status-bar":"^4.2.2","@uppy/url":"^4.3.2","@uppy/webcam":"^4.3.2","@vitest/browser":"^3.2.4",cssnano:"^7.0.7",jsdom:"^26.1.0",postcss:"^8.5.6","postcss-cli":"^11.0.1","resize-observer-polyfill":"^1.5.0",sass:"^1.89.2",typescript:"^5.8.3",vitest:"^3.2.4"},ll={"@uppy/core":"^4.5.2"},dl={name:Va,description:Ka,version:Xa,license:Ya,main:Ja,style:Qa,type:Za,scripts:el,keywords:tl,homepage:sl,bugs:il,repository:nl,files:ol,dependencies:rl,devDependencies:al,peerDependencies:ll};function ul(){const i=document.body;return!(!("draggable"in i)||!("ondragstart"in i&&"ondrop"in i)||!("FormData"in window)||!("FileReader"in window))}class tn extends as{constructor(){super(...arguments);h(this,"fileInput",null);h(this,"folderInput",null);h(this,"mobilePhotoFileInput",null);h(this,"mobileVideoFileInput",null);h(this,"triggerFileInputClick",()=>{var e;(e=this.fileInput)==null||e.click()});h(this,"triggerFolderInputClick",()=>{var e;(e=this.folderInput)==null||e.click()});h(this,"triggerVideoCameraInputClick",()=>{var e;(e=this.mobileVideoFileInput)==null||e.click()});h(this,"triggerPhotoCameraInputClick",()=>{var e;(e=this.mobilePhotoFileInput)==null||e.click()});h(this,"onFileInputChange",e=>{this.props.handleInputChange(e),e.currentTarget.value=""});h(this,"renderHiddenInput",(e,s)=>{var n;return l("input",{className:"uppy-Dashboard-input",hidden:!0,"aria-hidden":"true",tabIndex:-1,webkitdirectory:e,type:"file",name:"files[]",multiple:this.props.maxNumberOfFiles!==1,onChange:this.onFileInputChange,accept:(n=this.props.allowedFileTypes)==null?void 0:n.join(", "),ref:s})});h(this,"renderHiddenCameraInput",(e,s,n)=>{const r={photo:"image/*",video:"video/*"}[e];return l("input",{className:"uppy-Dashboard-input",hidden:!0,"aria-hidden":"true",tabIndex:-1,type:"file",name:`camera-${e}`,onChange:this.onFileInputChange,capture:s===""?"environment":s,accept:r,ref:n})});h(this,"renderMyDeviceAcquirer",()=>l("div",{className:"uppy-DashboardTab",role:"presentation","data-uppy-acquirer-id":"MyDevice",children:l("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-DashboardTab-btn",role:"tab",tabIndex:0,"data-uppy-super-focusable":!0,onClick:this.triggerFileInputClick,children:[l("div",{className:"uppy-DashboardTab-inner",children:l("svg",{className:"uppy-DashboardTab-iconMyDevice","aria-hidden":"true",focusable:"false",width:"32",height:"32",viewBox:"0 0 32 32",children:l("path",{d:"M8.45 22.087l-1.305-6.674h17.678l-1.572 6.674H8.45zm4.975-12.412l1.083 1.765a.823.823 0 00.715.386h7.951V13.5H8.587V9.675h4.838zM26.043 13.5h-1.195v-2.598c0-.463-.336-.75-.798-.75h-8.356l-1.082-1.766A.823.823 0 0013.897 8H7.728c-.462 0-.815.256-.815.718V13.5h-.956a.97.97 0 00-.746.37.972.972 0 00-.19.81l1.724 8.565c.095.44.484.755.933.755H24c.44 0 .824-.3.929-.727l2.043-8.568a.972.972 0 00-.176-.825.967.967 0 00-.753-.38z",fill:"currentcolor","fill-rule":"evenodd"})})}),l("div",{className:"uppy-DashboardTab-name",children:this.props.i18n("myDevice")})]})}));h(this,"renderPhotoCamera",()=>l("div",{className:"uppy-DashboardTab",role:"presentation","data-uppy-acquirer-id":"MobilePhotoCamera",children:l("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-DashboardTab-btn",role:"tab",tabIndex:0,"data-uppy-super-focusable":!0,onClick:this.triggerPhotoCameraInputClick,children:[l("div",{className:"uppy-DashboardTab-inner",children:l("svg",{"aria-hidden":"true",focusable:"false",width:"32",height:"32",viewBox:"0 0 32 32",children:l("path",{d:"M23.5 9.5c1.417 0 2.5 1.083 2.5 2.5v9.167c0 1.416-1.083 2.5-2.5 2.5h-15c-1.417 0-2.5-1.084-2.5-2.5V12c0-1.417 1.083-2.5 2.5-2.5h2.917l1.416-2.167C13 7.167 13.25 7 13.5 7h5c.25 0 .5.167.667.333L20.583 9.5H23.5zM16 11.417a4.706 4.706 0 00-4.75 4.75 4.704 4.704 0 004.75 4.75 4.703 4.703 0 004.75-4.75c0-2.663-2.09-4.75-4.75-4.75zm0 7.825c-1.744 0-3.076-1.332-3.076-3.074 0-1.745 1.333-3.077 3.076-3.077 1.744 0 3.074 1.333 3.074 3.076s-1.33 3.075-3.074 3.075z",fill:"#02B383","fill-rule":"nonzero"})})}),l("div",{className:"uppy-DashboardTab-name",children:this.props.i18n("takePictureBtn")})]})}));h(this,"renderVideoCamera",()=>l("div",{className:"uppy-DashboardTab",role:"presentation","data-uppy-acquirer-id":"MobileVideoCamera",children:l("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-DashboardTab-btn",role:"tab",tabIndex:0,"data-uppy-super-focusable":!0,onClick:this.triggerVideoCameraInputClick,children:[l("div",{className:"uppy-DashboardTab-inner",children:l("svg",{"aria-hidden":"true",width:"32",height:"32",viewBox:"0 0 32 32",children:l("path",{fill:"#FF675E",fillRule:"nonzero",d:"m21.254 14.277 2.941-2.588c.797-.313 1.243.818 1.09 1.554-.01 2.094.02 4.189-.017 6.282-.126.915-1.145 1.08-1.58.34l-2.434-2.142c-.192.287-.504 1.305-.738.468-.104-1.293-.028-2.596-.05-3.894.047-.312.381.823.426 1.069.063-.384.206-.744.362-1.09zm-12.939-3.73c3.858.013 7.717-.025 11.574.02.912.129 1.492 1.237 1.351 2.217-.019 2.412.04 4.83-.03 7.239-.17 1.025-1.166 1.59-2.029 1.429-3.705-.012-7.41.025-11.114-.019-.913-.129-1.492-1.237-1.352-2.217.018-2.404-.036-4.813.029-7.214.136-.82.83-1.473 1.571-1.454z "})})}),l("div",{className:"uppy-DashboardTab-name",children:this.props.i18n("recordVideoBtn")})]})}));h(this,"renderBrowseButton",(e,s)=>{const n=this.props.acquirers.length;return l("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-Dashboard-browse",onClick:s,"data-uppy-super-focusable":n===0,children:e})});h(this,"renderDropPasteBrowseTagline",e=>{const s=this.renderBrowseButton(this.props.i18n("browseFiles"),this.triggerFileInputClick),n=this.renderBrowseButton(this.props.i18n("browseFolders"),this.triggerFolderInputClick),o=this.props.fileManagerSelectionType,r=o.charAt(0).toUpperCase()+o.slice(1);return l("div",{class:"uppy-Dashboard-AddFiles-title",children:this.props.disableLocalFiles?this.props.i18n("importFiles"):e>0?this.props.i18nArray(`dropPasteImport${r}`,{browseFiles:s,browseFolders:n,browse:s}):this.props.i18nArray(`dropPaste${r}`,{browseFiles:s,browseFolders:n,browse:s})})});h(this,"renderAcquirer",e=>{var s;return l("div",{className:"uppy-DashboardTab",role:"presentation","data-uppy-acquirer-id":e.id,children:l("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-DashboardTab-btn",role:"tab",tabIndex:0,"data-cy":e.id,"aria-controls":`uppy-DashboardContent-panel--${e.id}`,"aria-selected":((s=this.props.activePickerPanel)==null?void 0:s.id)===e.id,"data-uppy-super-focusable":!0,onClick:()=>this.props.showPanel(e.id),children:[l("div",{className:"uppy-DashboardTab-inner",children:e.icon()}),l("div",{className:"uppy-DashboardTab-name",children:e.name})]})})});h(this,"renderAcquirers",e=>{const s=[...e],n=s.splice(e.length-2,e.length);return l(dt,{children:[s.map(o=>this.renderAcquirer(o)),l("span",{role:"presentation",style:{"white-space":"nowrap"},children:n.map(o=>this.renderAcquirer(o))})]})});h(this,"renderSourcesList",(e,s)=>{const{showNativePhotoCameraButton:n,showNativeVideoCameraButton:o}=this.props;let r=[];const a="myDevice";s||r.push({key:a,elements:this.renderMyDeviceAcquirer()}),n&&r.push({key:"nativePhotoCameraButton",elements:this.renderPhotoCamera()}),o&&r.push({key:"nativePhotoCameraButton",elements:this.renderVideoCamera()}),r.push(...e.map(m=>({key:m.id,elements:this.renderAcquirer(m)}))),r.length===1&&r[0].key===a&&(r=[]);const p=[...r],c=p.splice(r.length-2,r.length);return l(dt,{children:[this.renderDropPasteBrowseTagline(r.length),l("div",{className:"uppy-Dashboard-AddFiles-list",role:"tablist",children:[p.map(({key:m,elements:v})=>l(dt,{children:v},m)),l("span",{role:"presentation",style:{"white-space":"nowrap"},children:c.map(({key:m,elements:v})=>l(dt,{children:v},m))})]})]})})}[Symbol.for("uppy test: disable unused locale key warning")](){this.props.i18nArray("dropPasteBoth"),this.props.i18nArray("dropPasteFiles"),this.props.i18nArray("dropPasteFolders"),this.props.i18nArray("dropPasteImportBoth"),this.props.i18nArray("dropPasteImportFiles"),this.props.i18nArray("dropPasteImportFolders")}renderPoweredByUppy(){const{i18nArray:e}=this.props,s=l("span",{children:[l("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon uppy-Dashboard-poweredByIcon",width:"11",height:"11",viewBox:"0 0 11 11",children:l("path",{d:"M7.365 10.5l-.01-4.045h2.612L5.5.806l-4.467 5.65h2.604l.01 4.044h3.718z",fillRule:"evenodd"})}),l("span",{className:"uppy-Dashboard-poweredByUppy",children:"Uppy"})]}),n=e("poweredBy",{uppy:s});return l("a",{tabIndex:-1,href:"https://uppy.io",rel:"noreferrer noopener",target:"_blank",className:"uppy-Dashboard-poweredBy",children:n})}render(){const{showNativePhotoCameraButton:e,showNativeVideoCameraButton:s,nativeCameraFacingMode:n}=this.props;return l("div",{className:"uppy-Dashboard-AddFiles",children:[this.renderHiddenInput(!1,o=>{this.fileInput=o}),this.renderHiddenInput(!0,o=>{this.folderInput=o}),e&&this.renderHiddenCameraInput("photo",n,o=>{this.mobilePhotoFileInput=o}),s&&this.renderHiddenCameraInput("video",n,o=>{this.mobileVideoFileInput=o}),this.renderSourcesList(this.props.acquirers,this.props.disableLocalFiles),l("div",{className:"uppy-Dashboard-AddFiles-info",children:[this.props.note&&l("div",{className:"uppy-Dashboard-note",children:this.props.note}),this.props.proudlyDisplayPoweredByUppy&&this.renderPoweredByUppy()]})]})}}const cl=i=>l("div",{className:ne("uppy-Dashboard-AddFilesPanel",i.className),"data-uppy-panelType":"AddFiles","aria-hidden":!i.showAddFilesPanel,children:[l("div",{className:"uppy-DashboardContent-bar",children:[l("div",{className:"uppy-DashboardContent-title",role:"heading","aria-level":1,children:i.i18n("addingMoreFiles")}),l("button",{className:"uppy-DashboardContent-back",type:"button",onClick:()=>i.toggleAddFilesPanel(!1),children:i.i18n("back")})]}),l(tn,{...i})]});function pl(i){const t=i.files[i.fileCardFor],e=()=>{i.uppy.emit("file-editor:cancel",t),i.closeFileEditor()};return l("div",{className:ne("uppy-DashboardContent-panel",i.className),role:"tabpanel","data-uppy-panelType":"FileEditor",id:"uppy-DashboardContent-panel--editor",children:[l("div",{className:"uppy-DashboardContent-bar",children:[l("div",{className:"uppy-DashboardContent-title",role:"heading","aria-level":1,children:i.i18nArray("editing",{file:l("span",{className:"uppy-DashboardContent-titleFile",children:t.meta?t.meta.name:t.name})})}),l("button",{className:"uppy-DashboardContent-back",type:"button",onClick:e,children:i.i18n("cancel")}),l("button",{className:"uppy-DashboardContent-save",type:"button",onClick:i.saveFileEditor,children:i.i18n("save")})]}),l("div",{className:"uppy-DashboardContent-panelBody",children:i.editors.map(s=>i.uppy.getPlugin(s.id).render(i.state))})]})}function hl(){return l("svg",{"aria-hidden":"true",focusable:"false",width:"25",height:"25",viewBox:"0 0 25 25",children:l("g",{fill:"#686DE0",fillRule:"evenodd",children:[l("path",{d:"M5 7v10h15V7H5zm0-1h15a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1z",fillRule:"nonzero"}),l("path",{d:"M6.35 17.172l4.994-5.026a.5.5 0 0 1 .707 0l2.16 2.16 3.505-3.505a.5.5 0 0 1 .707 0l2.336 2.31-.707.72-1.983-1.97-3.505 3.505a.5.5 0 0 1-.707 0l-2.16-2.159-3.938 3.939-1.409.026z",fillRule:"nonzero"}),l("circle",{cx:"7.5",cy:"9.5",r:"1.5"})]})})}function ml(){return l("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"25",height:"25",viewBox:"0 0 25 25",children:l("path",{d:"M9.5 18.64c0 1.14-1.145 2-2.5 2s-2.5-.86-2.5-2c0-1.14 1.145-2 2.5-2 .557 0 1.079.145 1.5.396V7.25a.5.5 0 0 1 .379-.485l9-2.25A.5.5 0 0 1 18.5 5v11.64c0 1.14-1.145 2-2.5 2s-2.5-.86-2.5-2c0-1.14 1.145-2 2.5-2 .557 0 1.079.145 1.5.396V8.67l-8 2v7.97zm8-11v-2l-8 2v2l8-2zM7 19.64c.855 0 1.5-.484 1.5-1s-.645-1-1.5-1-1.5.484-1.5 1 .645 1 1.5 1zm9-2c.855 0 1.5-.484 1.5-1s-.645-1-1.5-1-1.5.484-1.5 1 .645 1 1.5 1z",fill:"#049BCF",fillRule:"nonzero"})})}function fl(){return l("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"25",height:"25",viewBox:"0 0 25 25",children:l("path",{d:"M16 11.834l4.486-2.691A1 1 0 0 1 22 10v6a1 1 0 0 1-1.514.857L16 14.167V17a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V9a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v2.834zM15 9H5v8h10V9zm1 4l5 3v-6l-5 3z",fill:"#19AF67",fillRule:"nonzero"})})}function gl(){return l("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"25",height:"25",viewBox:"0 0 25 25",children:l("path",{d:"M9.766 8.295c-.691-1.843-.539-3.401.747-3.726 1.643-.414 2.505.938 2.39 3.299-.039.79-.194 1.662-.537 3.148.324.49.66.967 1.055 1.51.17.231.382.488.629.757 1.866-.128 3.653.114 4.918.655 1.487.635 2.192 1.685 1.614 2.84-.566 1.133-1.839 1.084-3.416.249-1.141-.604-2.457-1.634-3.51-2.707a13.467 13.467 0 0 0-2.238.426c-1.392 4.051-4.534 6.453-5.707 4.572-.986-1.58 1.38-4.206 4.914-5.375.097-.322.185-.656.264-1.001.08-.353.306-1.31.407-1.737-.678-1.059-1.2-2.031-1.53-2.91zm2.098 4.87c-.033.144-.068.287-.104.427l.033-.01-.012.038a14.065 14.065 0 0 1 1.02-.197l-.032-.033.052-.004a7.902 7.902 0 0 1-.208-.271c-.197-.27-.38-.526-.555-.775l-.006.028-.002-.003c-.076.323-.148.632-.186.8zm5.77 2.978c1.143.605 1.832.632 2.054.187.26-.519-.087-1.034-1.113-1.473-.911-.39-2.175-.608-3.55-.608.845.766 1.787 1.459 2.609 1.894zM6.559 18.789c.14.223.693.16 1.425-.413.827-.648 1.61-1.747 2.208-3.206-2.563 1.064-4.102 2.867-3.633 3.62zm5.345-10.97c.088-1.793-.351-2.48-1.146-2.28-.473.119-.564 1.05-.056 2.405.213.566.52 1.188.908 1.859.18-.858.268-1.453.294-1.984z",fill:"#E2514A",fillRule:"nonzero"})})}function yl(){return l("svg",{"aria-hidden":"true",focusable:"false",width:"25",height:"25",viewBox:"0 0 25 25",children:l("path",{d:"M10.45 2.05h1.05a.5.5 0 0 1 .5.5v.024a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5V2.55a.5.5 0 0 1 .5-.5zm2.05 1.024h1.05a.5.5 0 0 1 .5.5V3.6a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5v-.001zM10.45 0h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5V.5a.5.5 0 0 1 .5-.5zm2.05 1.025h1.05a.5.5 0 0 1 .5.5v.024a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.024a.5.5 0 0 1 .5-.5zm-2.05 3.074h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5zm2.05 1.025h1.05a.5.5 0 0 1 .5.5v.024a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.024a.5.5 0 0 1 .5-.5zm-2.05 1.024h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5zm2.05 1.025h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5zm-2.05 1.025h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5zm2.05 1.025h1.05a.5.5 0 0 1 .5.5v.024a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.024a.5.5 0 0 1 .5-.5zm-1.656 3.074l-.82 5.946c.52.302 1.174.458 1.976.458.803 0 1.455-.156 1.975-.458l-.82-5.946h-2.311zm0-1.025h2.312c.512 0 .946.378 1.015.885l.82 5.946c.056.412-.142.817-.501 1.026-.686.398-1.515.597-2.49.597-.974 0-1.804-.199-2.49-.597a1.025 1.025 0 0 1-.5-1.026l.819-5.946c.07-.507.503-.885 1.015-.885zm.545 6.6a.5.5 0 0 1-.397-.561l.143-.999a.5.5 0 0 1 .495-.429h.74a.5.5 0 0 1 .495.43l.143.998a.5.5 0 0 1-.397.561c-.404.08-.819.08-1.222 0z",fill:"#00C469",fillRule:"nonzero"})})}function bl(){return l("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"25",height:"25",viewBox:"0 0 25 25",children:l("g",{fill:"#A7AFB7",fillRule:"nonzero",children:[l("path",{d:"M5.5 22a.5.5 0 0 1-.5-.5v-18a.5.5 0 0 1 .5-.5h10.719a.5.5 0 0 1 .367.16l3.281 3.556a.5.5 0 0 1 .133.339V21.5a.5.5 0 0 1-.5.5h-14zm.5-1h13V7.25L16 4H6v17z"}),l("path",{d:"M15 4v3a1 1 0 0 0 1 1h3V7h-3V4h-1z"})]})})}function vl(){return l("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"25",height:"25",viewBox:"0 0 25 25",children:l("path",{d:"M4.5 7h13a.5.5 0 1 1 0 1h-13a.5.5 0 0 1 0-1zm0 3h15a.5.5 0 1 1 0 1h-15a.5.5 0 1 1 0-1zm0 3h15a.5.5 0 1 1 0 1h-15a.5.5 0 1 1 0-1zm0 3h10a.5.5 0 1 1 0 1h-10a.5.5 0 1 1 0-1z",fill:"#5A5E69",fillRule:"nonzero"})})}function Vs(i){const t={color:"#838999",icon:bl()};if(!i)return t;const e=i.split("/")[0],s=i.split("/")[1];return e==="text"?{color:"#5a5e69",icon:vl()}:e==="image"?{color:"#686de0",icon:hl()}:e==="audio"?{color:"#068dbb",icon:ml()}:e==="video"?{color:"#19af67",icon:fl()}:e==="application"&&s==="pdf"?{color:"#e25149",icon:gl()}:e==="application"&&["zip","x-7z-compressed","x-zip-compressed","x-rar-compressed","x-tar","x-gzip","x-apple-diskimage"].indexOf(s)!==-1?{color:"#00C469",icon:yl()}:t}function Fe(i){const{tagName:t}=i.target;if(t==="INPUT"||t==="TEXTAREA"){i.stopPropagation();return}i.preventDefault(),i.stopPropagation()}function sn(i){const{file:t}=i;if(t.preview)return l("img",{draggable:!1,className:"uppy-Dashboard-Item-previewImg",alt:t.name,src:t.preview});const{color:e,icon:s}=Vs(t.type);return l("div",{className:"uppy-Dashboard-Item-previewIconWrap",children:[l("span",{className:"uppy-Dashboard-Item-previewIcon",style:{color:e},children:s}),l("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-Dashboard-Item-previewIconBg",width:"58",height:"76",viewBox:"0 0 58 76",children:l("rect",{fill:"#FFF",width:"58",height:"76",rx:"3",fillRule:"evenodd"})})]})}function wl(i){const{computedMetaFields:t,requiredMetaFields:e,updateMeta:s,form:n,formState:o}=i,r={text:"uppy-u-reset uppy-c-textInput uppy-Dashboard-FileCard-input"};return t.map(a=>{const d=`uppy-Dashboard-FileCard-input-${a.id}`,p=e.includes(a.id);return l("fieldset",{className:"uppy-Dashboard-FileCard-fieldset",children:[l("label",{className:"uppy-Dashboard-FileCard-label",htmlFor:d,children:a.name}),a.render!==void 0?a.render({value:o[a.id],onChange:c=>s(c,a.id),fieldCSSClasses:r,required:p,form:n.id},On):l("input",{className:r.text,id:d,form:n.id,type:a.type||"text",required:p,value:o[a.id],placeholder:a.placeholder,onInput:c=>s(c.target.value,a.id),"data-uppy-super-focusable":!0})]},a.id)})}function Fl(i){const{files:t,fileCardFor:e,toggleFileCard:s,saveFileCard:n,metaFields:o,requiredMetaFields:r,openFileEditor:a,i18n:d,i18nArray:p,className:c,canEditFile:m}=i,v=()=>typeof o=="function"?o(t[e]):o,w=t[e],C=v()??[],E=m(w),U={};C.forEach(T=>{U[T.id]=w.meta[T.id]??""});const[N,R]=Wt(U),k=$n(T=>{T.preventDefault(),n(N,e)},[n,N,e]),A=(T,z)=>{R({...N,[z]:T})},O=()=>{s(!1)},[D]=Wt(()=>{const T=document.createElement("form");return T.setAttribute("tabindex","-1"),T.id=en(),T});return Ps(()=>(document.body.appendChild(D),D.addEventListener("submit",k),()=>{D.removeEventListener("submit",k),document.body.removeChild(D)}),[D,k]),l("div",{className:ne("uppy-Dashboard-FileCard",c),"data-uppy-panelType":"FileCard",onDragOver:Fe,onDragLeave:Fe,onDrop:Fe,onPaste:Fe,children:[l("div",{className:"uppy-DashboardContent-bar",children:[l("div",{className:"uppy-DashboardContent-title",role:"heading","aria-level":1,children:p("editing",{file:l("span",{className:"uppy-DashboardContent-titleFile",children:w.meta?w.meta.name:w.name})})}),l("button",{className:"uppy-DashboardContent-back",type:"button",form:D.id,title:d("finishEditingFile"),onClick:O,children:d("cancel")})]}),l("div",{className:"uppy-Dashboard-FileCard-inner",children:[l("div",{className:"uppy-Dashboard-FileCard-preview",style:{backgroundColor:Vs(w.type).color},children:[l(sn,{file:w}),E&&l("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-Dashboard-FileCard-edit",onClick:T=>{k(T),a(w)},children:d("editImage")})]}),l("div",{className:"uppy-Dashboard-FileCard-info",children:l(wl,{computedMetaFields:C,requiredMetaFields:r,updateMeta:A,form:D,formState:N})}),l("div",{className:"uppy-Dashboard-FileCard-actions",children:[l("button",{className:"uppy-u-reset uppy-c-btn uppy-c-btn-primary uppy-Dashboard-FileCard-actionsBtn",type:"submit",form:D.id,children:d("saveChanges")}),l("button",{className:"uppy-u-reset uppy-c-btn uppy-c-btn-link uppy-Dashboard-FileCard-actionsBtn",type:"button",onClick:O,form:D.id,children:d("cancel")})]})]})]})}function Cl(i,t){if(i===t)return!0;if(!i||!t)return!1;const e=Object.keys(i),s=Object.keys(t),n=e.length;if(s.length!==n)return!1;for(let o=0;o<n;o++){const r=e[o];if(i[r]!==t[r]||!Object.prototype.hasOwnProperty.call(t,r))return!1}return!0}function Sl(i,t="Copy the URL below"){return new Promise(e=>{const s=document.createElement("textarea");s.setAttribute("style",{position:"fixed",top:0,left:0,width:"2em",height:"2em",padding:0,border:"none",outline:"none",boxShadow:"none",background:"transparent"}),s.value=i,document.body.appendChild(s),s.select();const n=()=>{document.body.removeChild(s),window.prompt(t,i),e()};try{return document.execCommand("copy")?(document.body.removeChild(s),e()):n()}catch{return document.body.removeChild(s),n()}})}function Pl({file:i,uploadInProgressOrComplete:t,metaFields:e,canEditFile:s,i18n:n,onClick:o}){return!t&&e&&e.length>0||!t&&s(i)?l("button",{className:"uppy-u-reset uppy-c-btn uppy-Dashboard-Item-action uppy-Dashboard-Item-action--edit",type:"button","aria-label":n("editFileWithFilename",{file:i.meta.name}),title:n("editFileWithFilename",{file:i.meta.name}),onClick:()=>o(),children:l("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"14",height:"14",viewBox:"0 0 14 14",children:l("g",{fillRule:"evenodd",children:[l("path",{d:"M1.5 10.793h2.793A1 1 0 0 0 5 10.5L11.5 4a1 1 0 0 0 0-1.414L9.707.793a1 1 0 0 0-1.414 0l-6.5 6.5A1 1 0 0 0 1.5 8v2.793zm1-1V8L9 1.5l1.793 1.793-6.5 6.5H2.5z",fillRule:"nonzero"}),l("rect",{x:"1",y:"12.293",width:"11",height:"1",rx:".5"}),l("path",{fillRule:"nonzero",d:"M6.793 2.5L9.5 5.207l.707-.707L7.5 1.793z"})]})})}):null}function Tl({i18n:i,onClick:t,file:e}){return l("button",{className:"uppy-u-reset uppy-Dashboard-Item-action uppy-Dashboard-Item-action--remove",type:"button","aria-label":i("removeFile",{file:e.meta.name}),title:i("removeFile",{file:e.meta.name}),onClick:()=>t(),children:l("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"18",height:"18",viewBox:"0 0 18 18",children:[l("path",{d:"M9 0C4.034 0 0 4.034 0 9s4.034 9 9 9 9-4.034 9-9-4.034-9-9-9z"}),l("path",{fill:"#FFF",d:"M13 12.222l-.778.778L9 9.778 5.778 13 5 12.222 8.222 9 5 5.778 5.778 5 9 8.222 12.222 5l.778.778L9.778 9z"})]})})}function xl({file:i,uppy:t,i18n:e}){const s=n=>{Sl(i.uploadURL,e("copyLinkToClipboardFallback")).then(()=>{t.log("Link copied to clipboard."),t.info(e("copyLinkToClipboardSuccess"),"info",3e3)}).catch(t.log).then(()=>n.target.focus({preventScroll:!0}))};return l("button",{className:"uppy-u-reset uppy-Dashboard-Item-action uppy-Dashboard-Item-action--copyLink",type:"button","aria-label":e("copyLink"),title:e("copyLink"),onClick:n=>s(n),children:l("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"14",height:"14",viewBox:"0 0 14 12",children:l("path",{d:"M7.94 7.703a2.613 2.613 0 0 1-.626 2.681l-.852.851a2.597 2.597 0 0 1-1.849.766A2.616 2.616 0 0 1 2.764 7.54l.852-.852a2.596 2.596 0 0 1 2.69-.625L5.267 7.099a1.44 1.44 0 0 0-.833.407l-.852.851a1.458 1.458 0 0 0 1.03 2.486c.39 0 .755-.152 1.03-.426l.852-.852c.231-.231.363-.522.406-.824l1.04-1.038zm4.295-5.937A2.596 2.596 0 0 0 10.387 1c-.698 0-1.355.272-1.849.766l-.852.851a2.614 2.614 0 0 0-.624 2.688l1.036-1.036c.041-.304.173-.6.407-.833l.852-.852c.275-.275.64-.426 1.03-.426a1.458 1.458 0 0 1 1.03 2.486l-.852.851a1.442 1.442 0 0 1-.824.406l-1.04 1.04a2.596 2.596 0 0 0 2.683-.628l.851-.85a2.616 2.616 0 0 0 0-3.697zm-6.88 6.883a.577.577 0 0 0 .82 0l3.474-3.474a.579.579 0 1 0-.819-.82L5.355 7.83a.579.579 0 0 0 0 .819z"})})})}function El(i){const{uppy:t,file:e,uploadInProgressOrComplete:s,canEditFile:n,metaFields:o,showLinkToFileUploadResult:r,showRemoveButton:a,i18n:d,toggleFileCard:p,openFileEditor:c}=i;return l("div",{className:"uppy-Dashboard-Item-actionWrapper",children:[l(Pl,{i18n:d,file:e,uploadInProgressOrComplete:s,canEditFile:n,metaFields:o,onClick:()=>{o&&o.length>0?p(!0,e.id):c(e)}}),r&&e.uploadURL?l(xl,{file:e,uppy:t,i18n:d}):null,a?l(Tl,{i18n:d,file:e,onClick:()=>t.removeFile(e.id)}):null]})}const ms="...";function nn(i,t){if(t===0)return"";if(i.length<=t)return i;if(t<=ms.length+1)return`${i.slice(0,t-1)}â€¦`;const e=t-ms.length,s=Math.ceil(e/2),n=Math.floor(e/2);return i.slice(0,s)+ms+i.slice(-n)}const Nl=(i,t)=>(typeof t=="function"?t():t).filter(n=>n.id===i)[0].name;function on(i){const{file:t,toggleFileCard:e,i18n:s,metaFields:n}=i,{missingRequiredMetaFields:o}=t;if(!(o!=null&&o.length))return null;const r=o.map(a=>Nl(a,n)).join(", ");return l("div",{className:"uppy-Dashboard-Item-errorMessage",children:[s("missingRequiredMetaFields",{smart_count:o.length,fields:r})," ",l("button",{type:"button",class:"uppy-u-reset uppy-Dashboard-Item-errorMessageBtn",onClick:()=>e(!0,t.id),children:s("editFile")})]})}const Ul=i=>{const{author:t,name:e}=i.file.meta;function s(){return i.isSingleFile&&i.containerHeight>=350?90:i.containerWidth<=352?35:i.containerWidth<=576?60:t?20:30}return l("div",{className:"uppy-Dashboard-Item-name",title:e,children:nn(e,s())})},Al=i=>{var n;const{author:t}=i.file.meta,e=(n=i.file.remote)==null?void 0:n.providerName,s="Â·";return t?l("div",{className:"uppy-Dashboard-Item-author",children:[l("a",{href:`${t.url}?utm_source=Companion&utm_medium=referral`,target:"_blank",rel:"noopener noreferrer",children:nn(t.name,13)}),e?l(dt,{children:[` ${s} `,e,` ${s} `]}):null]}):null},kl=i=>i.file.size&&l("div",{className:"uppy-Dashboard-Item-statusSize",children:Te(i.file.size)}),Ml=i=>i.file.isGhost&&l("span",{children:[" â€¢ ",l("button",{className:"uppy-u-reset uppy-c-btn uppy-Dashboard-Item-reSelect",type:"button",onClick:()=>i.toggleAddFilesPanel(!0),children:i.i18n("reSelect")})]}),Rl=({file:i,onClick:t})=>i.error?l("button",{className:"uppy-u-reset uppy-c-btn uppy-Dashboard-Item-errorDetails","aria-label":i.error,"data-microtip-position":"bottom","data-microtip-size":"medium",onClick:t,type:"button",children:"?"}):null;function Dl(i){const{file:t,i18n:e,toggleFileCard:s,metaFields:n,toggleAddFilesPanel:o,isSingleFile:r,containerHeight:a,containerWidth:d}=i;return l("div",{className:"uppy-Dashboard-Item-fileInfo","data-uppy-file-source":t.source,children:[l("div",{className:"uppy-Dashboard-Item-fileName",children:[Ul({file:t,isSingleFile:r,containerHeight:a,containerWidth:d}),l(Rl,{file:t,onClick:()=>alert(t.error)})]}),l("div",{className:"uppy-Dashboard-Item-status",children:[Al({file:t}),kl({file:t}),Ml({file:t,toggleAddFilesPanel:o,i18n:e})]}),l(on,{file:t,i18n:e,toggleFileCard:s,metaFields:n})]})}function Il(i){const{file:t,i18n:e,toggleFileCard:s,metaFields:n,showLinkToFileUploadResult:o}=i,a=t.preview?"rgba(255, 255, 255, 0.5)":Vs(t.type).color;return l("div",{className:"uppy-Dashboard-Item-previewInnerWrap",style:{backgroundColor:a},children:[o&&t.uploadURL&&l("a",{className:"uppy-Dashboard-Item-previewLink",href:t.uploadURL,rel:"noreferrer noopener",target:"_blank","aria-label":t.meta.name,children:l("span",{hidden:!0,children:t.meta.name})}),l(sn,{file:t}),l(on,{file:t,i18n:e,toggleFileCard:s,metaFields:n})]})}function Ol(i){if(!i.isUploaded){if(i.error&&!i.hideRetryButton){i.uppy.retryUpload(i.file.id);return}i.resumableUploads&&!i.hidePauseResumeButton?i.uppy.pauseResume(i.file.id):i.individualCancellation&&!i.hideCancelButton&&i.uppy.removeFile(i.file.id)}}function fi(i){return i.isUploaded?i.i18n("uploadComplete"):i.error?i.i18n("retryUpload"):i.resumableUploads?i.file.isPaused?i.i18n("resumeUpload"):i.i18n("pauseUpload"):i.individualCancellation?i.i18n("cancelUpload"):""}function fs(i){return l("div",{className:"uppy-Dashboard-Item-progress",children:l("button",{className:"uppy-u-reset uppy-c-btn uppy-Dashboard-Item-progressIndicator",type:"button","aria-label":fi(i),title:fi(i),onClick:()=>Ol(i),children:i.children})})}function Lt({children:i}){return l("svg",{"aria-hidden":"true",focusable:"false",width:"70",height:"70",viewBox:"0 0 36 36",className:"uppy-c-icon uppy-Dashboard-Item-progressIcon--circle",children:i})}function gs({progress:i}){const t=2*Math.PI*15;return l("g",{children:[l("circle",{className:"uppy-Dashboard-Item-progressIcon--bg",r:"15",cx:"18",cy:"18","stroke-width":"2",fill:"none"}),l("circle",{className:"uppy-Dashboard-Item-progressIcon--progress",r:"15",cx:"18",cy:"18",transform:"rotate(-90, 18, 18)",fill:"none","stroke-width":"2","stroke-dasharray":t,"stroke-dashoffset":t-t/100*i})]})}function $l(i){return!i.file.progress.uploadStarted||i.file.progress.percentage===void 0?null:i.isUploaded?l("div",{className:"uppy-Dashboard-Item-progress",children:l("div",{className:"uppy-Dashboard-Item-progressIndicator",children:l(Lt,{children:[l("circle",{r:"15",cx:"18",cy:"18",fill:"#1bb240"}),l("polygon",{className:"uppy-Dashboard-Item-progressIcon--check",transform:"translate(2, 3)",points:"14 22.5 7 15.2457065 8.99985857 13.1732815 14 18.3547104 22.9729883 9 25 11.1005634"})]})})}):i.recoveredState?null:i.error&&!i.hideRetryButton?l(fs,{...i,children:l("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon uppy-Dashboard-Item-progressIcon--retry",width:"28",height:"31",viewBox:"0 0 16 19",children:[l("path",{d:"M16 11a8 8 0 1 1-8-8v2a6 6 0 1 0 6 6h2z"}),l("path",{d:"M7.9 3H10v2H7.9z"}),l("path",{d:"M8.536.5l3.535 3.536-1.414 1.414L7.12 1.914z"}),l("path",{d:"M10.657 2.621l1.414 1.415L8.536 7.57 7.12 6.157z"})]})}):i.resumableUploads&&!i.hidePauseResumeButton?l(fs,{...i,children:l(Lt,{children:[l(gs,{progress:i.file.progress.percentage}),i.file.isPaused?l("polygon",{className:"uppy-Dashboard-Item-progressIcon--play",transform:"translate(3, 3)",points:"12 20 12 10 20 15"}):l("g",{className:"uppy-Dashboard-Item-progressIcon--pause",transform:"translate(14.5, 13)",children:[l("rect",{x:"0",y:"0",width:"2",height:"10",rx:"0"}),l("rect",{x:"5",y:"0",width:"2",height:"10",rx:"0"})]})]})}):!i.resumableUploads&&i.individualCancellation&&!i.hideCancelButton?l(fs,{...i,children:l(Lt,{children:[l(gs,{progress:i.file.progress.percentage}),l("polygon",{className:"cancel",transform:"translate(2, 2)",points:"19.8856516 11.0625 16 14.9481516 12.1019737 11.0625 11.0625 12.1143484 14.9481516 16 11.0625 19.8980263 12.1019737 20.9375 16 17.0518484 19.8856516 20.9375 20.9375 19.8980263 17.0518484 16 20.9375 12"})]})}):l("div",{className:"uppy-Dashboard-Item-progress",children:l("div",{className:"uppy-Dashboard-Item-progressIndicator",children:l(Lt,{children:l(gs,{progress:i.file.progress.percentage})})})})}class Bl extends as{componentDidMount(){const{file:t}=this.props;t.preview||this.props.handleRequestThumbnail(t)}shouldComponentUpdate(t){return!Cl(this.props,t)}componentDidUpdate(){const{file:t}=this.props;t.preview||this.props.handleRequestThumbnail(t)}componentWillUnmount(){const{file:t}=this.props;t.preview||this.props.handleCancelThumbnail(t)}render(){const{file:t}=this.props,e=t.progress.preprocess||t.progress.postprocess,s=!!t.progress.uploadComplete&&!e&&!t.error,n=!!t.progress.uploadStarted||!!e,o=t.progress.uploadStarted&&!t.progress.uploadComplete||e,r=t.error||!1,{isGhost:a}=t;let d=(this.props.individualCancellation||!o)&&!s;s&&this.props.showRemoveButtonAfterComplete&&(d=!0);const p=ne({"uppy-Dashboard-Item":!0,"is-inprogress":o&&!this.props.recoveredState,"is-processing":e,"is-complete":s,"is-error":!!r,"is-resumable":this.props.resumableUploads,"is-noIndividualCancellation":!this.props.individualCancellation,"is-ghost":a});return l("div",{className:p,id:`uppy_${t.id}`,role:this.props.role,children:[l("div",{className:"uppy-Dashboard-Item-preview",children:[l(Il,{file:t,showLinkToFileUploadResult:this.props.showLinkToFileUploadResult,i18n:this.props.i18n,toggleFileCard:this.props.toggleFileCard,metaFields:this.props.metaFields}),l($l,{uppy:this.props.uppy,file:t,error:r,isUploaded:s,hideRetryButton:this.props.hideRetryButton,hideCancelButton:this.props.hideCancelButton,hidePauseResumeButton:this.props.hidePauseResumeButton,recoveredState:this.props.recoveredState,resumableUploads:this.props.resumableUploads,individualCancellation:this.props.individualCancellation,i18n:this.props.i18n})]}),l("div",{className:"uppy-Dashboard-Item-fileInfoAndButtons",children:[l(Dl,{file:t,containerWidth:this.props.containerWidth,containerHeight:this.props.containerHeight,i18n:this.props.i18n,toggleAddFilesPanel:this.props.toggleAddFilesPanel,toggleFileCard:this.props.toggleFileCard,metaFields:this.props.metaFields,isSingleFile:this.props.isSingleFile}),l(El,{file:t,metaFields:this.props.metaFields,showLinkToFileUploadResult:this.props.showLinkToFileUploadResult,showRemoveButton:d,canEditFile:this.props.canEditFile,uploadInProgressOrComplete:n,toggleFileCard:this.props.toggleFileCard,openFileEditor:this.props.openFileEditor,uppy:this.props.uppy,i18n:this.props.i18n})]})]})}}function Ll(i,t){const e=[];let s=[];return i.forEach(n=>{s.length<t?s.push(n):(e.push(s),s=[n])}),s.length&&e.push(s),e}function zl({id:i,i18n:t,uppy:e,files:s,resumableUploads:n,hideRetryButton:o,hidePauseResumeButton:r,hideCancelButton:a,showLinkToFileUploadResult:d,showRemoveButtonAfterComplete:p,metaFields:c,isSingleFile:m,toggleFileCard:v,handleRequestThumbnail:w,handleCancelThumbnail:C,recoveredState:E,individualCancellation:U,itemsPerRow:N,openFileEditor:R,canEditFile:k,toggleAddFilesPanel:A,containerWidth:O,containerHeight:D}){const T=N===1?71:200,z=Bn(()=>{const P=(I,$)=>Number(s[$].isGhost)-Number(s[I].isGhost),x=Object.keys(s);return E&&x.sort(P),Ll(x,N)},[s,N,E]),f=P=>l("div",{class:"uppy-Dashboard-filesInner",role:"presentation",children:P.map(x=>l(Bl,{uppy:e,id:i,i18n:t,resumableUploads:n,individualCancellation:U,hideRetryButton:o,hidePauseResumeButton:r,hideCancelButton:a,showLinkToFileUploadResult:d,showRemoveButtonAfterComplete:p,metaFields:c,recoveredState:E,isSingleFile:m,containerWidth:O,containerHeight:D,toggleFileCard:v,handleRequestThumbnail:w,handleCancelThumbnail:C,role:"listitem",openFileEditor:R,canEditFile:k,toggleAddFilesPanel:A,file:s[x]},x))},P[0]);return m?l("div",{class:"uppy-Dashboard-files",children:f(z[0])}):l(Rr,{class:"uppy-Dashboard-files",role:"list",data:z,renderRow:f,rowHeight:T})}function jl({activePickerPanel:i,className:t,hideAllPanels:e,i18n:s,state:n,uppy:o}){const r=jt(null);return l("div",{className:ne("uppy-DashboardContent-panel",t),role:"tabpanel","data-uppy-panelType":"PickerPanel",id:`uppy-DashboardContent-panel--${i.id}`,onDragOver:Fe,onDragLeave:Fe,onDrop:Fe,onPaste:Fe,children:[l("div",{className:"uppy-DashboardContent-bar",children:[l("div",{className:"uppy-DashboardContent-title",role:"heading","aria-level":1,children:s("importFrom",{name:i.name})}),l("button",{className:"uppy-DashboardContent-back",type:"button",onClick:e,children:s("cancel")})]}),l("div",{ref:r,className:"uppy-DashboardContent-panelBody",children:o.getPlugin(i.id).render(n,r.current)})]})}const re={STATE_ERROR:"error",STATE_WAITING:"waiting",STATE_PREPROCESSING:"preprocessing",STATE_UPLOADING:"uploading",STATE_POSTPROCESSING:"postprocessing",STATE_COMPLETE:"complete",STATE_PAUSED:"paused"};function _l(i,t,e,s={}){if(i)return re.STATE_ERROR;if(t)return re.STATE_COMPLETE;if(e)return re.STATE_PAUSED;let n=re.STATE_WAITING;const o=Object.keys(s);for(let r=0;r<o.length;r++){const{progress:a}=s[o[r]];if(a.uploadStarted&&!a.uploadComplete)return re.STATE_UPLOADING;a.preprocess&&n!==re.STATE_UPLOADING&&(n=re.STATE_PREPROCESSING),a.postprocess&&n!==re.STATE_UPLOADING&&n!==re.STATE_PREPROCESSING&&(n=re.STATE_POSTPROCESSING)}return n}function ql({files:i,i18n:t,isAllComplete:e,isAllErrored:s,isAllPaused:n,inProgressNotPausedFiles:o,newFiles:r,processingFiles:a}){switch(_l(s,e,n,i)){case"uploading":return t("uploadingXFiles",{smart_count:o.length});case"preprocessing":case"postprocessing":return t("processingXFiles",{smart_count:a.length});case"paused":return t("uploadPaused");case"waiting":return t("xFilesSelected",{smart_count:r.length});case"complete":return t("uploadComplete");case"error":return t("error")}}function Hl(i){const{i18n:t,isAllComplete:e,hideCancelButton:s,maxNumberOfFiles:n,toggleAddFilesPanel:o,uppy:r}=i;let{allowNewUpload:a}=i;return a&&n&&(a=i.totalFileCount<i.maxNumberOfFiles),l("div",{className:"uppy-DashboardContent-bar",children:[!e&&!s?l("button",{className:"uppy-DashboardContent-back",type:"button",onClick:()=>r.cancelAll(),children:t("cancel")}):l("div",{}),l("div",{className:"uppy-DashboardContent-title",children:l(ql,{...i})}),a?l("button",{className:"uppy-DashboardContent-addMore",type:"button","aria-label":t("addMoreFiles"),title:t("addMoreFiles"),onClick:()=>o(!0),children:[l("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"15",height:"15",viewBox:"0 0 15 15",children:l("path",{d:"M8 6.5h6a.5.5 0 0 1 .5.5v.5a.5.5 0 0 1-.5.5H8v6a.5.5 0 0 1-.5.5H7a.5.5 0 0 1-.5-.5V8h-6a.5.5 0 0 1-.5-.5V7a.5.5 0 0 1 .5-.5h6v-6A.5.5 0 0 1 7 0h.5a.5.5 0 0 1 .5.5v6z"})}),l("span",{className:"uppy-DashboardContent-addMoreCaption",children:t("addMore")})]}):l("div",{})]})}const Be="uppy-transition-slideDownUp",gi=250;function zt({children:i}){const[t,e]=Wt(null),[s,n]=Wt(""),o=jt(),r=jt(),a=jt(),d=()=>{n(`${Be}-enter`),cancelAnimationFrame(a.current),clearTimeout(r.current),r.current=void 0,a.current=requestAnimationFrame(()=>{n(`${Be}-enter ${Be}-enter-active`),o.current=setTimeout(()=>{n("")},gi)})},p=()=>{n(`${Be}-leave`),cancelAnimationFrame(a.current),clearTimeout(o.current),o.current=void 0,a.current=requestAnimationFrame(()=>{n(`${Be}-leave ${Be}-leave-active`),r.current=setTimeout(()=>{e(null),n("")},gi)})};return Ps(()=>{const c=Ln(i)[0];t!==c&&(c&&!t?d():t&&!c&&!r.current&&p(),e(c))},[i,t]),Ps(()=>()=>{clearTimeout(o.current),clearTimeout(r.current),cancelAnimationFrame(a.current)},[]),t?zn(t,{className:ne(s,t.props.className)}):null}const yi=900,bi=700,ys=576,vi=330;function Wl(i){const t=i.totalFileCount===0,e=i.totalFileCount===1,s=i.containerWidth>ys,n=i.containerHeight>vi,o=ne({"uppy-Dashboard":!0,"uppy-Dashboard--isDisabled":i.disabled,"uppy-Dashboard--animateOpenClose":i.animateOpenClose,"uppy-Dashboard--isClosing":i.isClosing,"uppy-Dashboard--isDraggingOver":i.isDraggingOver,"uppy-Dashboard--modal":!i.inline,"uppy-size--md":i.containerWidth>ys,"uppy-size--lg":i.containerWidth>bi,"uppy-size--xl":i.containerWidth>yi,"uppy-size--height-md":i.containerHeight>vi,"uppy-Dashboard--isAddFilesPanelVisible":i.showAddFilesPanel,"uppy-Dashboard--isInnerWrapVisible":i.areInsidesReadyToBeVisible,"uppy-Dashboard--singleFile":i.singleFileFullScreen&&e&&n});let r=1;i.containerWidth>yi?r=5:i.containerWidth>bi?r=4:i.containerWidth>ys&&(r=3);const a=i.showSelectedFiles&&!t,d=i.recoveredState?Object.keys(i.recoveredState.files).length:null,p=i.files?Object.keys(i.files).filter(v=>i.files[v].isGhost).length:0,c=()=>p>0?i.i18n("recoveredXFiles",{smart_count:p}):i.i18n("recoveredAllFiles");return l("div",{className:o,"data-uppy-theme":i.theme,"data-uppy-num-acquirers":i.acquirers.length,"data-uppy-drag-drop-supported":!i.disableLocalFiles&&ul(),"aria-hidden":i.inline?"false":i.isHidden,"aria-disabled":i.disabled,"aria-label":i.inline?i.i18n("dashboardTitle"):i.i18n("dashboardWindowTitle"),onPaste:i.handlePaste,onDragOver:i.handleDragOver,onDragLeave:i.handleDragLeave,onDrop:i.handleDrop,children:[l("div",{"aria-hidden":"true",className:"uppy-Dashboard-overlay",tabIndex:-1,onClick:i.handleClickOutside}),l("div",{className:"uppy-Dashboard-inner",role:i.inline?void 0:"dialog",style:{width:i.inline&&i.width?i.width:"",height:i.inline&&i.height?i.height:""},children:[i.inline?null:l("button",{className:"uppy-u-reset uppy-Dashboard-close",type:"button","aria-label":i.i18n("closeModal"),title:i.i18n("closeModal"),onClick:i.closeModal,children:l("span",{"aria-hidden":"true",children:"Ã—"})}),l("div",{className:"uppy-Dashboard-innerWrap",children:[l("div",{className:"uppy-Dashboard-dropFilesHereHint",children:i.i18n("dropHint")}),a&&l(Hl,{...i}),d&&l("div",{className:"uppy-Dashboard-serviceMsg",children:[l("svg",{className:"uppy-Dashboard-serviceMsg-icon","aria-hidden":"true",focusable:"false",width:"21",height:"16",viewBox:"0 0 24 19",children:l("g",{transform:"translate(0 -1)",fill:"none",fillRule:"evenodd",children:[l("path",{d:"M12.857 1.43l10.234 17.056A1 1 0 0122.234 20H1.766a1 1 0 01-.857-1.514L11.143 1.429a1 1 0 011.714 0z",fill:"#FFD300"}),l("path",{fill:"#000",d:"M11 6h2l-.3 8h-1.4z"}),l("circle",{fill:"#000",cx:"12",cy:"17",r:"1"})]})}),l("strong",{className:"uppy-Dashboard-serviceMsg-title",children:i.i18n("sessionRestored")}),l("div",{className:"uppy-Dashboard-serviceMsg-text",children:c()})]}),a?l(zl,{id:i.id,i18n:i.i18n,uppy:i.uppy,files:i.files,resumableUploads:i.resumableUploads,hideRetryButton:i.hideRetryButton,hidePauseResumeButton:i.hidePauseResumeButton,hideCancelButton:i.hideCancelButton,showLinkToFileUploadResult:i.showLinkToFileUploadResult,showRemoveButtonAfterComplete:i.showRemoveButtonAfterComplete,metaFields:i.metaFields,toggleFileCard:i.toggleFileCard,handleRequestThumbnail:i.handleRequestThumbnail,handleCancelThumbnail:i.handleCancelThumbnail,recoveredState:i.recoveredState,individualCancellation:i.individualCancellation,openFileEditor:i.openFileEditor,canEditFile:i.canEditFile,toggleAddFilesPanel:i.toggleAddFilesPanel,isSingleFile:e,itemsPerRow:r,containerWidth:i.containerWidth,containerHeight:i.containerHeight}):l(tn,{i18n:i.i18n,i18nArray:i.i18nArray,acquirers:i.acquirers,handleInputChange:i.handleInputChange,maxNumberOfFiles:i.maxNumberOfFiles,allowedFileTypes:i.allowedFileTypes,showNativePhotoCameraButton:i.showNativePhotoCameraButton,showNativeVideoCameraButton:i.showNativeVideoCameraButton,nativeCameraFacingMode:i.nativeCameraFacingMode,showPanel:i.showPanel,activePickerPanel:i.activePickerPanel,disableLocalFiles:i.disableLocalFiles,fileManagerSelectionType:i.fileManagerSelectionType,note:i.note,proudlyDisplayPoweredByUppy:i.proudlyDisplayPoweredByUppy}),l(zt,{children:i.showAddFilesPanel?l(cl,{...i,isSizeMD:s},"AddFiles"):null}),l(zt,{children:i.fileCardFor?l(Fl,{...i},"FileCard"):null}),l(zt,{children:i.activePickerPanel?l(jl,{...i},"Picker"):null}),l(zt,{children:i.showFileEditor?l(pl,{...i},"Editor"):null}),l("div",{className:"uppy-Dashboard-progressindicators",children:i.progressindicators.map(v=>i.uppy.getPlugin(v.id).render(i.state))})]})]})]})}const Gl={strings:{closeModal:"Close Modal",addMoreFiles:"Add more files",addingMoreFiles:"Adding more files",importFrom:"Import from %{name}",dashboardWindowTitle:"Uppy Dashboard Window (Press escape to close)",dashboardTitle:"Uppy Dashboard",copyLinkToClipboardSuccess:"Link copied to clipboard.",copyLinkToClipboardFallback:"Copy the URL below",copyLink:"Copy link",back:"Back",removeFile:"Remove file",editFile:"Edit file",editImage:"Edit image",editing:"Editing %{file}",error:"Error",finishEditingFile:"Finish editing file",saveChanges:"Save changes",myDevice:"My Device",dropHint:"Drop your files here",uploadComplete:"Upload complete",uploadPaused:"Upload paused",resumeUpload:"Resume upload",pauseUpload:"Pause upload",retryUpload:"Retry upload",cancelUpload:"Cancel upload",xFilesSelected:{0:"%{smart_count} file selected",1:"%{smart_count} files selected"},uploadingXFiles:{0:"Uploading %{smart_count} file",1:"Uploading %{smart_count} files"},processingXFiles:{0:"Processing %{smart_count} file",1:"Processing %{smart_count} files"},poweredBy:"Powered by %{uppy}",addMore:"Add more",editFileWithFilename:"Edit file %{file}",save:"Save",cancel:"Cancel",dropPasteFiles:"Drop files here or %{browseFiles}",dropPasteFolders:"Drop files here or %{browseFolders}",dropPasteBoth:"Drop files here, %{browseFiles} or %{browseFolders}",dropPasteImportFiles:"Drop files here, %{browseFiles} or import from:",dropPasteImportFolders:"Drop files here, %{browseFolders} or import from:",dropPasteImportBoth:"Drop files here, %{browseFiles}, %{browseFolders} or import from:",importFiles:"Import files from:",browseFiles:"browse files",browseFolders:"browse folders",recoveredXFiles:{0:"We could not fully recover 1 file. Please re-select it and resume the upload.",1:"We could not fully recover %{smart_count} files. Please re-select them and resume the upload."},recoveredAllFiles:"We restored all files. You can now resume the upload.",sessionRestored:"Session restored",reSelect:"Re-select",missingRequiredMetaFields:{0:"Missing required meta field: %{fields}.",1:"Missing required meta fields: %{fields}."},takePictureBtn:"Take Picture",recordVideoBtn:"Record Video"}},rn=['a[href]:not([tabindex^="-"]):not([inert]):not([aria-hidden])','area[href]:not([tabindex^="-"]):not([inert]):not([aria-hidden])',"input:not([disabled]):not([inert]):not([aria-hidden])","select:not([disabled]):not([inert]):not([aria-hidden])","textarea:not([disabled]):not([inert]):not([aria-hidden])","button:not([disabled]):not([inert]):not([aria-hidden])",'iframe:not([tabindex^="-"]):not([inert]):not([aria-hidden])','object:not([tabindex^="-"]):not([inert]):not([aria-hidden])','embed:not([tabindex^="-"]):not([inert]):not([aria-hidden])','[contenteditable]:not([tabindex^="-"]):not([inert]):not([aria-hidden])','[tabindex]:not([tabindex^="-"]):not([inert]):not([aria-hidden])'];function an(i,t){if(t){const e=i.querySelector(`[data-uppy-paneltype="${t}"]`);if(e)return e}return i}function Vl(){let i=!1;return oo((e,s)=>{const n=an(e,s),o=n.contains(document.activeElement);if(o&&i)return;const r=n.querySelector("[data-uppy-super-focusable]");if(!(o&&!r))if(r)r.focus({preventScroll:!0}),i=!0;else{const a=n.querySelector(rn);a==null||a.focus({preventScroll:!0}),i=!1}},260)}function wi(i,t){const e=t[0];e&&(e.focus(),i.preventDefault())}function Kl(i,t){const e=t[t.length-1];e&&(e.focus(),i.preventDefault())}function Xl(i){return i.contains(document.activeElement)}function ln(i,t,e){const s=an(e,t),n=ht(s.querySelectorAll(rn)),o=n.indexOf(document.activeElement);Xl(s)?i.shiftKey&&o===0?Kl(i,n):!i.shiftKey&&o===n.length-1&&wi(i,n):wi(i,n)}function Yl(i,t,e){t===null||ln(i,t,e)}const Fi=9,Jl=27;function Ci(){const i={};return i.promise=new Promise((t,e)=>{i.resolve=t,i.reject=e}),i}const Ql={target:"body",metaFields:[],thumbnailWidth:280,thumbnailType:"image/jpeg",waitForThumbnailsBeforeUpload:!1,defaultPickerIcon:Dr,showLinkToFileUploadResult:!1,showProgressDetails:!1,hideUploadButton:!1,hideCancelButton:!1,hideRetryButton:!1,hidePauseResumeButton:!1,hideProgressAfterFinish:!1,note:null,singleFileFullScreen:!0,disableStatusBar:!1,disableInformer:!1,disableThumbnailGenerator:!1,fileManagerSelectionType:"files",proudlyDisplayPoweredByUppy:!0,showSelectedFiles:!0,showRemoveButtonAfterComplete:!1,showNativePhotoCameraButton:!1,showNativeVideoCameraButton:!1,theme:"light",autoOpen:null,disabled:!1,disableLocalFiles:!1,nativeCameraFacingMode:"",onDragLeave:()=>{},onDragOver:()=>{},onDrop:()=>{},plugins:[],doneButtonHandler:void 0,onRequestCloseModal:null,inline:!1,animateOpenClose:!0,browserBackButtonClose:!1,closeAfterFinish:!1,closeModalOnClickOutside:!1,disablePageScrollWhenModalOpen:!0,trigger:null,width:750,height:550};var ws,He,Ae,wt,We,Jt,Qt,Zt,ke,es,ts,Ge,_,Ds,Is,dn,Os,$s,un;let Zl=(ws=class extends at{constructor(e,s){var o;const n=(s==null?void 0:s.autoOpen)??null;super(e,{...Ql,...s,autoOpen:n});y(this,_);y(this,He);h(this,"modalName",`uppy-Dashboard-${en()}`);h(this,"superFocus",Vl());h(this,"ifFocusedOnUppyRecently",!1);h(this,"dashboardIsDisabled");h(this,"savedScrollPosition");h(this,"savedActiveElement");h(this,"resizeObserver");h(this,"darkModeMediaQuery");h(this,"makeDashboardInsidesVisibleAnywayTimeout");h(this,"removeTarget",e=>{const n=this.getPluginState().targets.filter(o=>o.id!==e.id);this.setPluginState({targets:n})});h(this,"addTarget",e=>{const s=e.id||e.constructor.name,n=e.title||s,o=e.type;if(o!=="acquirer"&&o!=="progressindicator"&&o!=="editor")return this.uppy.log("Dashboard: can only be targeted by plugins of types: acquirer, progressindicator, editor","error"),null;const r={id:s,name:n,type:o},d=this.getPluginState().targets.slice();return d.push(r),this.setPluginState({targets:d}),this.el});h(this,"hideAllPanels",()=>{var n;const e=this.getPluginState(),s={activePickerPanel:void 0,showAddFilesPanel:!1,activeOverlayType:null,fileCardFor:null,showFileEditor:!1};e.activePickerPanel===s.activePickerPanel&&e.showAddFilesPanel===s.showAddFilesPanel&&e.showFileEditor===s.showFileEditor&&e.activeOverlayType===s.activeOverlayType||(this.setPluginState(s),this.uppy.emit("dashboard:close-panel",(n=e.activePickerPanel)==null?void 0:n.id))});h(this,"showPanel",e=>{const{targets:s}=this.getPluginState(),n=s.find(o=>o.type==="acquirer"&&o.id===e);this.setPluginState({activePickerPanel:n,activeOverlayType:"PickerPanel"}),this.uppy.emit("dashboard:show-panel",e)});h(this,"canEditFile",e=>{const{targets:s}=this.getPluginState();return u(this,ke).call(this,s).some(o=>this.uppy.getPlugin(o.id).canEditFile(e))});h(this,"openFileEditor",e=>{const{targets:s}=this.getPluginState(),n=u(this,ke).call(this,s);this.setPluginState({showFileEditor:!0,fileCardFor:e.id||null,activeOverlayType:"FileEditor"}),n.forEach(o=>{this.uppy.getPlugin(o.id).selectFile(e)})});h(this,"closeFileEditor",()=>{const{metaFields:e}=this.getPluginState();e&&e.length>0?this.setPluginState({showFileEditor:!1,activeOverlayType:"FileCard"}):this.setPluginState({showFileEditor:!1,fileCardFor:null,activeOverlayType:"AddFiles"})});h(this,"saveFileEditor",()=>{const{targets:e}=this.getPluginState();u(this,ke).call(this,e).forEach(n=>{this.uppy.getPlugin(n.id).save()}),this.closeFileEditor()});h(this,"openModal",()=>{const{promise:e,resolve:s}=Ci();if(this.savedScrollPosition=window.pageYOffset,this.savedActiveElement=document.activeElement,this.opts.disablePageScrollWhenModalOpen&&document.body.classList.add("uppy-Dashboard-isFixed"),this.opts.animateOpenClose&&this.getPluginState().isClosing){const n=()=>{this.setPluginState({isHidden:!1}),this.el.removeEventListener("animationend",n,!1),s()};this.el.addEventListener("animationend",n,!1)}else this.setPluginState({isHidden:!1}),s();return this.opts.browserBackButtonClose&&this.updateBrowserHistory(),document.addEventListener("keydown",this.handleKeyDownInModal),this.uppy.emit("dashboard:modal-open"),e});h(this,"closeModal",e=>{var d;const s=(e==null?void 0:e.manualClose)??!0,{isHidden:n,isClosing:o}=this.getPluginState();if(n||o)return;const{promise:r,resolve:a}=Ci();if(this.opts.disablePageScrollWhenModalOpen&&document.body.classList.remove("uppy-Dashboard-isFixed"),this.opts.animateOpenClose){this.setPluginState({isClosing:!0});const p=()=>{this.setPluginState({isHidden:!0,isClosing:!1}),this.superFocus.cancel(),this.savedActiveElement.focus(),this.el.removeEventListener("animationend",p,!1),a()};this.el.addEventListener("animationend",p,!1)}else this.setPluginState({isHidden:!0}),this.superFocus.cancel(),this.savedActiveElement.focus(),a();return document.removeEventListener("keydown",this.handleKeyDownInModal),s&&this.opts.browserBackButtonClose&&(d=history.state)!=null&&d[this.modalName]&&history.back(),this.uppy.emit("dashboard:modal-closed"),r});h(this,"isModalOpen",()=>!this.getPluginState().isHidden||!1);h(this,"requestCloseModal",()=>this.opts.onRequestCloseModal?this.opts.onRequestCloseModal():this.closeModal());h(this,"setDarkModeCapability",e=>{const{capabilities:s}=this.uppy.getState();this.uppy.setState({capabilities:{...s,darkMode:e}})});h(this,"handleSystemDarkModeChange",e=>{const s=e.matches;this.uppy.log(`[Dashboard] Dark mode is ${s?"on":"off"}`),this.setDarkModeCapability(s)});h(this,"toggleFileCard",(e,s)=>{const n=this.uppy.getFile(s);e?this.uppy.emit("dashboard:file-edit-start",n):this.uppy.emit("dashboard:file-edit-complete",n),this.setPluginState({fileCardFor:e?s:null,activeOverlayType:e?"FileCard":null})});h(this,"toggleAddFilesPanel",e=>{this.setPluginState({showAddFilesPanel:e,activeOverlayType:e?"AddFiles":null})});h(this,"addFiles",e=>{const s=e.map(n=>({source:this.id,name:n.name,type:n.type,data:n,meta:{relativePath:n.relativePath||n.webkitRelativePath||null}}));try{this.uppy.addFiles(s)}catch(n){this.uppy.log(n)}});h(this,"startListeningToResize",()=>{this.resizeObserver=new ResizeObserver(e=>{const s=e[0],{width:n,height:o}=s.contentRect;this.setPluginState({containerWidth:n,containerHeight:o,areInsidesReadyToBeVisible:!0})}),this.resizeObserver.observe(this.el.querySelector(".uppy-Dashboard-inner")),this.makeDashboardInsidesVisibleAnywayTimeout=setTimeout(()=>{const e=this.getPluginState(),s=!this.opts.inline&&e.isHidden;!e.areInsidesReadyToBeVisible&&!s&&(this.uppy.log("[Dashboard] resize event didnâ€™t fire on time: defaulted to mobile layout","warning"),this.setPluginState({areInsidesReadyToBeVisible:!0}))},1e3)});h(this,"stopListeningToResize",()=>{this.resizeObserver.disconnect(),clearTimeout(this.makeDashboardInsidesVisibleAnywayTimeout)});h(this,"recordIfFocusedOnUppyRecently",e=>{this.el.contains(e.target)?this.ifFocusedOnUppyRecently=!0:(this.ifFocusedOnUppyRecently=!1,this.superFocus.cancel())});h(this,"disableInteractiveElements",e=>{const s=["a[href]","input:not([disabled])","select:not([disabled])","textarea:not([disabled])","button:not([disabled])",'[role="button"]:not([disabled])'],n=u(this,He)??ht(this.el.querySelectorAll(s)).filter(o=>!o.classList.contains("uppy-Dashboard-close"));for(const o of n)o.tagName==="A"?o.setAttribute("aria-disabled",e):o.disabled=e;e?F(this,He,n):F(this,He,null),this.dashboardIsDisabled=e});h(this,"updateBrowserHistory",()=>{var e;(e=history.state)!=null&&e[this.modalName]||history.pushState({...history.state,[this.modalName]:!0},""),window.addEventListener("popstate",this.handlePopState,!1)});h(this,"handlePopState",e=>{var s;this.isModalOpen()&&(!e.state||!e.state[this.modalName])&&this.closeModal({manualClose:!1}),!this.isModalOpen()&&((s=e.state)!=null&&s[this.modalName])&&history.back()});h(this,"handleKeyDownInModal",e=>{e.keyCode===Jl&&this.requestCloseModal(),e.keyCode===Fi&&ln(e,this.getPluginState().activeOverlayType,this.el)});h(this,"handleClickOutside",()=>{this.opts.closeModalOnClickOutside&&this.requestCloseModal()});h(this,"handlePaste",e=>{this.uppy.iteratePlugins(n=>{var o;n.type==="acquirer"&&((o=n.handleRootPaste)==null||o.call(n,e))});const s=ht(e.clipboardData.files);s.length>0&&(this.uppy.log("[Dashboard] Files pasted"),this.addFiles(s))});h(this,"handleInputChange",e=>{e.preventDefault();const s=ht(e.currentTarget.files||[]);s.length>0&&(this.uppy.log("[Dashboard] Files selected through input"),this.addFiles(s))});h(this,"handleDragOver",e=>{e.preventDefault(),e.stopPropagation();const s=()=>{let a=!0;return this.uppy.iteratePlugins(d=>{var p;(p=d.canHandleRootDrop)!=null&&p.call(d,e)&&(a=!0)}),a},n=()=>{const{types:a}=e.dataTransfer;return a.some(d=>d==="Files")},o=s(),r=n();if(!o&&!r||this.opts.disabled||this.opts.disableLocalFiles&&(r||!o)||!this.uppy.getState().allowNewUpload){e.dataTransfer.dropEffect="none";return}e.dataTransfer.dropEffect="copy",this.setPluginState({isDraggingOver:!0}),this.opts.onDragOver(e)});h(this,"handleDragLeave",e=>{e.preventDefault(),e.stopPropagation(),this.setPluginState({isDraggingOver:!1}),this.opts.onDragLeave(e)});h(this,"handleDrop",async e=>{e.preventDefault(),e.stopPropagation(),this.setPluginState({isDraggingOver:!1}),this.uppy.iteratePlugins(r=>{var a;r.type==="acquirer"&&((a=r.handleRootDrop)==null||a.call(r,e))});let s=!1;const n=r=>{this.uppy.log(r,"error"),s||(this.uppy.info(r.message,"error"),s=!0)};this.uppy.log("[Dashboard] Processing dropped files");const o=await Wa(e.dataTransfer,{logDropError:n});o.length>0&&(this.uppy.log("[Dashboard] Files dropped"),this.addFiles(o)),this.opts.onDrop(e)});h(this,"handleRequestThumbnail",e=>{this.opts.waitForThumbnailsBeforeUpload||this.uppy.emit("thumbnail:request",e)});h(this,"handleCancelThumbnail",e=>{this.opts.waitForThumbnailsBeforeUpload||this.uppy.emit("thumbnail:cancel",e)});h(this,"handleKeyDownInInline",e=>{e.keyCode===Fi&&Yl(e,this.getPluginState().activeOverlayType,this.el)});h(this,"handlePasteOnBody",e=>{this.el.contains(document.activeElement)&&this.handlePaste(e)});h(this,"handleComplete",({failed:e})=>{this.opts.closeAfterFinish&&!(e!=null&&e.length)&&this.requestCloseModal()});h(this,"handleCancelRestore",()=>{this.uppy.emit("restore-canceled")});y(this,Ae,()=>{if(this.opts.disableThumbnailGenerator)return;const e=600,s=this.uppy.getFiles();if(s.length===1){const n=this.uppy.getPlugin(`${this.id}:ThumbnailGenerator`);n==null||n.setOptions({thumbnailWidth:e});const o={...s[0],preview:void 0};n==null||n.requestThumbnail(o).then(()=>{n==null||n.setOptions({thumbnailWidth:this.opts.thumbnailWidth})})}});y(this,wt,e=>{const s=e[0],{metaFields:n}=this.getPluginState(),o=n&&n.length>0,r=this.canEditFile(s);o&&this.opts.autoOpen==="metaEditor"?this.toggleFileCard(!0,s.id):r&&this.opts.autoOpen==="imageEditor"&&this.openFileEditor(s)});h(this,"initEvents",()=>{if(this.opts.trigger&&!this.opts.inline){const e=mi(this.opts.trigger);e?e.forEach(s=>s.addEventListener("click",this.openModal)):this.uppy.log("Dashboard modal trigger not found. Make sure `trigger` is set in Dashboard options, unless you are planning to call `dashboard.openModal()` method yourself","warning")}this.startListeningToResize(),document.addEventListener("paste",this.handlePasteOnBody),this.uppy.on("plugin-added",u(this,Ge)),this.uppy.on("plugin-remove",this.removeTarget),this.uppy.on("file-added",this.hideAllPanels),this.uppy.on("dashboard:modal-closed",this.hideAllPanels),this.uppy.on("complete",this.handleComplete),this.uppy.on("files-added",u(this,Ae)),this.uppy.on("file-removed",u(this,Ae)),document.addEventListener("focus",this.recordIfFocusedOnUppyRecently,!0),document.addEventListener("click",this.recordIfFocusedOnUppyRecently,!0),this.opts.inline&&this.el.addEventListener("keydown",this.handleKeyDownInInline),this.opts.autoOpen&&this.uppy.on("files-added",u(this,wt))});h(this,"removeEvents",()=>{const e=mi(this.opts.trigger);!this.opts.inline&&e&&e.forEach(s=>s.removeEventListener("click",this.openModal)),this.stopListeningToResize(),document.removeEventListener("paste",this.handlePasteOnBody),window.removeEventListener("popstate",this.handlePopState,!1),this.uppy.off("plugin-added",u(this,Ge)),this.uppy.off("plugin-remove",this.removeTarget),this.uppy.off("file-added",this.hideAllPanels),this.uppy.off("dashboard:modal-closed",this.hideAllPanels),this.uppy.off("complete",this.handleComplete),this.uppy.off("files-added",u(this,Ae)),this.uppy.off("file-removed",u(this,Ae)),document.removeEventListener("focus",this.recordIfFocusedOnUppyRecently),document.removeEventListener("click",this.recordIfFocusedOnUppyRecently),this.opts.inline&&this.el.removeEventListener("keydown",this.handleKeyDownInInline),this.opts.autoOpen&&this.uppy.off("files-added",u(this,wt))});h(this,"superFocusOnEachUpdate",()=>{const e=this.el.contains(document.activeElement),s=document.activeElement===document.body||document.activeElement===null,n=this.uppy.getState().info.length===0,o=!this.opts.inline;n&&(o||e||s&&this.ifFocusedOnUppyRecently)?this.superFocus(this.el,this.getPluginState().activeOverlayType):this.superFocus.cancel()});h(this,"afterUpdate",()=>{if(this.opts.disabled&&!this.dashboardIsDisabled){this.disableInteractiveElements(!0);return}!this.opts.disabled&&this.dashboardIsDisabled&&this.disableInteractiveElements(!1),this.superFocusOnEachUpdate()});h(this,"saveFileCard",(e,s)=>{this.uppy.setFileMeta(s,e),this.toggleFileCard(!1,s)});y(this,We,e=>{const s=this.uppy.getPlugin(e.id);return{...e,icon:s.icon||this.opts.defaultPickerIcon,render:s.render}});y(this,Jt,e=>{const s=this.uppy.getPlugin(e.id);return typeof s.isSupported!="function"?!0:s.isSupported()});y(this,Qt,e=>e.filter(s=>s.type==="acquirer"&&u(this,Jt).call(this,s)).map(u(this,We)));y(this,Zt,e=>e.filter(s=>s.type==="progressindicator").map(u(this,We)));y(this,ke,e=>e.filter(s=>s.type==="editor").map(u(this,We)));h(this,"render",e=>{const s=this.getPluginState(),{files:n,capabilities:o,allowNewUpload:r}=e,{newFiles:a,uploadStartedFiles:d,completeFiles:p,erroredFiles:c,inProgressFiles:m,inProgressNotPausedFiles:v,processingFiles:w,isUploadStarted:C,isAllComplete:E,isAllPaused:U}=this.uppy.getObjectOfFilesPerState(),N=u(this,Qt).call(this,s.targets),R=u(this,Zt).call(this,s.targets),k=u(this,ke).call(this,s.targets);let A;return this.opts.theme==="auto"?A=o.darkMode?"dark":"light":A=this.opts.theme,["files","folders","both"].indexOf(this.opts.fileManagerSelectionType)<0&&(this.opts.fileManagerSelectionType="files",console.warn(`Unsupported option for "fileManagerSelectionType". Using default of "${this.opts.fileManagerSelectionType}".`)),Wl({state:e,isHidden:s.isHidden,files:n,newFiles:a,uploadStartedFiles:d,completeFiles:p,erroredFiles:c,inProgressFiles:m,inProgressNotPausedFiles:v,processingFiles:w,isUploadStarted:C,isAllComplete:E,isAllPaused:U,totalFileCount:Object.keys(n).length,totalProgress:e.totalProgress,allowNewUpload:r,acquirers:N,theme:A,disabled:this.opts.disabled,disableLocalFiles:this.opts.disableLocalFiles,direction:this.opts.direction,activePickerPanel:s.activePickerPanel,showFileEditor:s.showFileEditor,saveFileEditor:this.saveFileEditor,closeFileEditor:this.closeFileEditor,disableInteractiveElements:this.disableInteractiveElements,animateOpenClose:this.opts.animateOpenClose,isClosing:s.isClosing,progressindicators:R,editors:k,autoProceed:this.uppy.opts.autoProceed,id:this.id,closeModal:this.requestCloseModal,handleClickOutside:this.handleClickOutside,handleInputChange:this.handleInputChange,handlePaste:this.handlePaste,inline:this.opts.inline,showPanel:this.showPanel,hideAllPanels:this.hideAllPanels,i18n:this.i18n,i18nArray:this.i18nArray,uppy:this.uppy,note:this.opts.note,recoveredState:e.recoveredState,metaFields:s.metaFields,resumableUploads:o.resumableUploads||!1,individualCancellation:o.individualCancellation,isMobileDevice:o.isMobileDevice,fileCardFor:s.fileCardFor,toggleFileCard:this.toggleFileCard,toggleAddFilesPanel:this.toggleAddFilesPanel,showAddFilesPanel:s.showAddFilesPanel,saveFileCard:this.saveFileCard,openFileEditor:this.openFileEditor,canEditFile:this.canEditFile,width:this.opts.width,height:this.opts.height,showLinkToFileUploadResult:this.opts.showLinkToFileUploadResult,fileManagerSelectionType:this.opts.fileManagerSelectionType,proudlyDisplayPoweredByUppy:this.opts.proudlyDisplayPoweredByUppy,hideCancelButton:this.opts.hideCancelButton,hideRetryButton:this.opts.hideRetryButton,hidePauseResumeButton:this.opts.hidePauseResumeButton,showRemoveButtonAfterComplete:this.opts.showRemoveButtonAfterComplete,containerWidth:s.containerWidth,containerHeight:s.containerHeight,areInsidesReadyToBeVisible:s.areInsidesReadyToBeVisible,parentElement:this.el,allowedFileTypes:this.uppy.opts.restrictions.allowedFileTypes,maxNumberOfFiles:this.uppy.opts.restrictions.maxNumberOfFiles,requiredMetaFields:this.uppy.opts.restrictions.requiredMetaFields,showSelectedFiles:this.opts.showSelectedFiles,showNativePhotoCameraButton:this.opts.showNativePhotoCameraButton,showNativeVideoCameraButton:this.opts.showNativeVideoCameraButton,nativeCameraFacingMode:this.opts.nativeCameraFacingMode,singleFileFullScreen:this.opts.singleFileFullScreen,handleCancelRestore:this.handleCancelRestore,handleRequestThumbnail:this.handleRequestThumbnail,handleCancelThumbnail:this.handleCancelThumbnail,isDraggingOver:s.isDraggingOver,handleDragOver:this.handleDragOver,handleDragLeave:this.handleDragLeave,handleDrop:this.handleDrop})});y(this,es,()=>{const{plugins:e}=this.opts;e.forEach(s=>{const n=this.uppy.getPlugin(s);n?n.mount(this,n):this.uppy.log(`[Uppy] Dashboard could not find plugin '${s}', make sure to uppy.use() the plugins you are specifying`,"warning")})});y(this,ts,()=>{this.uppy.iteratePlugins(u(this,Ge))});y(this,Ge,e=>{var n;const s=["acquirer","editor"];e&&!((n=e.opts)!=null&&n.target)&&s.includes(e.type)&&(this.getPluginState().targets.some(r=>e.id===r.id)||e.mount(this,e))});h(this,"install",()=>{var d;this.setPluginState({isHidden:!0,fileCardFor:null,activeOverlayType:null,showAddFilesPanel:!1,activePickerPanel:void 0,showFileEditor:!1,metaFields:this.opts.metaFields,targets:[],areInsidesReadyToBeVisible:!1,isDraggingOver:!1});const{inline:e,closeAfterFinish:s}=this.opts;if(e&&s)throw new Error("[Dashboard] `closeAfterFinish: true` cannot be used on an inline Dashboard, because an inline Dashboard cannot be closed at all. Either set `inline: false`, or disable the `closeAfterFinish` option.");const{allowMultipleUploads:n,allowMultipleUploadBatches:o}=this.uppy.opts;(n||o)&&s&&this.uppy.log("[Dashboard] When using `closeAfterFinish`, we recommended setting the `allowMultipleUploadBatches` option to `false` in the Uppy constructor. See https://uppy.io/docs/uppy/#allowMultipleUploads-true","warning");const{target:r}=this.opts;r&&this.mount(r,this),this.opts.disableStatusBar||this.uppy.use(va,{id:b(this,_,Os).call(this),target:this,...b(this,_,Ds).call(this)}),this.opts.disableInformer||this.uppy.use(Gi,{id:b(this,_,un).call(this),target:this,...b(this,_,dn).call(this)}),this.opts.disableThumbnailGenerator||this.uppy.use(Yi,{id:b(this,_,$s).call(this),...b(this,_,Is).call(this)}),this.darkModeMediaQuery=typeof window<"u"&&window.matchMedia?window.matchMedia("(prefers-color-scheme: dark)"):null;const a=this.darkModeMediaQuery?this.darkModeMediaQuery.matches:!1;this.uppy.log(`[Dashboard] Dark mode is ${a?"on":"off"}`),this.setDarkModeCapability(a),this.opts.theme==="auto"&&((d=this.darkModeMediaQuery)==null||d.addListener(this.handleSystemDarkModeChange)),u(this,es).call(this),u(this,ts).call(this),this.initEvents()});h(this,"uninstall",()=>{var s;if(!this.opts.disableInformer){const n=this.uppy.getPlugin(`${this.id}:Informer`);n&&this.uppy.removePlugin(n)}if(!this.opts.disableStatusBar){const n=this.uppy.getPlugin(`${this.id}:StatusBar`);n&&this.uppy.removePlugin(n)}if(!this.opts.disableThumbnailGenerator){const n=this.uppy.getPlugin(`${this.id}:ThumbnailGenerator`);n&&this.uppy.removePlugin(n)}const{plugins:e}=this.opts;e.forEach(n=>{const o=this.uppy.getPlugin(n);o&&o.unmount()}),this.opts.theme==="auto"&&((s=this.darkModeMediaQuery)==null||s.removeListener(this.handleSystemDarkModeChange)),this.opts.disablePageScrollWhenModalOpen&&document.body.classList.remove("uppy-Dashboard-isFixed"),this.unmount(),this.removeEvents()});this.id=this.opts.id||"Dashboard",this.title="Dashboard",this.type="orchestrator",this.defaultLocale=Gl,this.opts.doneButtonHandler===void 0&&(this.opts.doneButtonHandler=()=>{this.uppy.clear(),this.requestCloseModal()}),(o=this.opts).onRequestCloseModal??(o.onRequestCloseModal=()=>this.closeModal()),this.i18nInit()}setOptions(e){var s,n;super.setOptions(e),(s=this.uppy.getPlugin(b(this,_,Os).call(this)))==null||s.setOptions(b(this,_,Ds).call(this)),(n=this.uppy.getPlugin(b(this,_,$s).call(this)))==null||n.setOptions(b(this,_,Is).call(this))}},He=new WeakMap,Ae=new WeakMap,wt=new WeakMap,We=new WeakMap,Jt=new WeakMap,Qt=new WeakMap,Zt=new WeakMap,ke=new WeakMap,es=new WeakMap,ts=new WeakMap,Ge=new WeakMap,_=new WeakSet,Ds=function(){const{hideUploadButton:e,hideRetryButton:s,hidePauseResumeButton:n,hideCancelButton:o,showProgressDetails:r,hideProgressAfterFinish:a,locale:d,doneButtonHandler:p}=this.opts;return{hideUploadButton:e,hideRetryButton:s,hidePauseResumeButton:n,hideCancelButton:o,showProgressDetails:r,hideAfterFinish:a,locale:d,doneButtonHandler:p}},Is=function(){const{thumbnailWidth:e,thumbnailHeight:s,thumbnailType:n,waitForThumbnailsBeforeUpload:o}=this.opts;return{thumbnailWidth:e,thumbnailHeight:s,thumbnailType:n,waitForThumbnailsBeforeUpload:o,lazy:!o}},dn=function(){return{}},Os=function(){return`${this.id}:StatusBar`},$s=function(){return`${this.id}:ThumbnailGenerator`},un=function(){return`${this.id}:Informer`},h(ws,"VERSION",dl.version),ws);const ed=["defaultChecked","defaultValue","suppressContentEditableWarning","suppressHydrationWarning","dangerouslySetInnerHTML","accessKey","className","contentEditable","contextMenu","dir","draggable","hidden","id","lang","placeholder","slot","spellCheck","style","tabIndex","title","translate","radioGroup","role","about","datatype","inlist","prefix","property","resource","typeof","vocab","autoCapitalize","autoCorrect","autoSave","color","itemProp","itemScope","itemType","itemID","itemRef","results","security","unselectable","inputMode","is","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],td=/^(aria-|data-)/,cn=i=>Object.fromEntries(Object.entries(i).filter(([t])=>td.test(t)||ed.includes(t)));function sd(i,t){const e=cn(i);return Object.keys(i).some(s=>!Object.hasOwn(e,s)&&i[s]!==t[s])}class pn extends G.Component{constructor(){super(...arguments);h(this,"container");h(this,"plugin")}componentDidMount(){this.installPlugin()}componentDidUpdate(e){const{uppy:s,open:n,onRequestClose:o}=this.props;if(e.uppy!==s)this.uninstallPlugin(e),this.installPlugin();else if(sd(this.props,e)){const{uppy:r,...a}={...this.props,inline:!1,onRequestCloseModal:o};this.plugin.setOptions(a)}e.open&&!n?this.plugin.closeModal():!e.open&&n&&this.plugin.openModal()}componentWillUnmount(){this.uninstallPlugin()}installPlugin(){const{target:e=this.container,open:s,onRequestClose:n,uppy:o,...r}=this.props,a={id:"DashboardModal",...r,inline:!1,target:e,open:s,onRequestCloseModal:n};o.use(Zl,a),this.plugin=o.getPlugin(a.id),s&&this.plugin.openModal()}uninstallPlugin(e=this.props){const{uppy:s}=e;s.removePlugin(this.plugin)}render(){return G.createElement("div",{className:"uppy-Container",ref:e=>{this.container=e},...cn(this.props)})}}h(pn,"defaultProps",{open:void 0,onRequestClose:void 0});function hn(i,t){return Object.hasOwn(i,t)}class id extends Error{constructor(e,s){super(e);h(this,"isNetworkError");h(this,"cause");this.cause=s==null?void 0:s.cause,this.cause&&hn(this.cause,"isNetworkError")?this.isNetworkError=this.cause.isNetworkError:this.isNetworkError=!1}}class nd extends Error{constructor(e,s=null){super("This looks like a network error, the endpoint might be blocked by an internet provider or a firewall.");h(this,"cause");h(this,"isNetworkError");h(this,"request");this.cause=e,this.isNetworkError=!0,this.request=s}}function od(...i){return fetch(...i).catch(t=>{throw t.name==="AbortError"?t:new nd(t)})}function rd(i){var n;const e=(n=/^(?:https?:\/\/|\/\/)?(?:[^@\n]+@)?([^\n]+)/i.exec(i))==null?void 0:n[1];return`${/^http:\/\//i.test(i)?"ws":"wss"}://${e}`}class ad extends Error{constructor(){super(...arguments);h(this,"name","UserFacingApiError")}}var mn={};function X(i,t){typeof t=="boolean"&&(t={forever:t}),this._originalTimeouts=JSON.parse(JSON.stringify(i)),this._timeouts=i,this._options=t||{},this._maxRetryTime=t&&t.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}var ld=X;X.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)};X.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null};X.prototype.retry=function(i){if(this._timeout&&clearTimeout(this._timeout),!i)return!1;var t=new Date().getTime();if(i&&t-this._operationStart>=this._maxRetryTime)return this._errors.push(i),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(i);var e=this._timeouts.shift();if(e===void 0)if(this._cachedTimeouts)this._errors.splice(0,this._errors.length-1),e=this._cachedTimeouts.slice(-1);else return!1;var s=this;return this._timer=setTimeout(function(){s._attempts++,s._operationTimeoutCb&&(s._timeout=setTimeout(function(){s._operationTimeoutCb(s._attempts)},s._operationTimeout),s._options.unref&&s._timeout.unref()),s._fn(s._attempts)},e),this._options.unref&&this._timer.unref(),!0};X.prototype.attempt=function(i,t){this._fn=i,t&&(t.timeout&&(this._operationTimeout=t.timeout),t.cb&&(this._operationTimeoutCb=t.cb));var e=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){e._operationTimeoutCb()},e._operationTimeout)),this._operationStart=new Date().getTime(),this._fn(this._attempts)};X.prototype.try=function(i){console.log("Using RetryOperation.try() is deprecated"),this.attempt(i)};X.prototype.start=function(i){console.log("Using RetryOperation.start() is deprecated"),this.attempt(i)};X.prototype.start=X.prototype.try;X.prototype.errors=function(){return this._errors};X.prototype.attempts=function(){return this._attempts};X.prototype.mainError=function(){if(this._errors.length===0)return null;for(var i={},t=null,e=0,s=0;s<this._errors.length;s++){var n=this._errors[s],o=n.message,r=(i[o]||0)+1;i[o]=r,r>=e&&(t=n,e=r)}return t};(function(i){var t=ld;i.operation=function(e){var s=i.timeouts(e);return new t(s,{forever:e&&(e.forever||e.retries===1/0),unref:e&&e.unref,maxRetryTime:e&&e.maxRetryTime})},i.timeouts=function(e){if(e instanceof Array)return[].concat(e);var s={retries:10,factor:2,minTimeout:1*1e3,maxTimeout:1/0,randomize:!1};for(var n in e)s[n]=e[n];if(s.minTimeout>s.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var o=[],r=0;r<s.retries;r++)o.push(this.createTimeout(r,s));return e&&e.forever&&!o.length&&o.push(this.createTimeout(r,s)),o.sort(function(a,d){return a-d}),o},i.createTimeout=function(e,s){var n=s.randomize?Math.random()+1:1,o=Math.round(n*Math.max(s.minTimeout,1)*Math.pow(s.factor,e));return o=Math.min(o,s.maxTimeout),o},i.wrap=function(e,s,n){if(s instanceof Array&&(n=s,s=null),!n){n=[];for(var o in e)typeof e[o]=="function"&&n.push(o)}for(var r=0;r<n.length;r++){var a=n[r],d=e[a];e[a]=(function(c){var m=i.operation(s),v=Array.prototype.slice.call(arguments,1),w=v.pop();v.push(function(C){m.retry(C)||(C&&(arguments[0]=m.mainError()),w.apply(this,arguments))}),m.attempt(function(){c.apply(e,v)})}).bind(e,d),e[a].options=s}}})(mn);var dd=mn;const ud=rs(dd),cd=Object.prototype.toString,pd=i=>cd.call(i)==="[object Error]",hd=new Set(["network error","Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Load failed","Network request failed","fetch failed","terminated"]);function md(i){return i&&pd(i)&&i.name==="TypeError"&&typeof i.message=="string"?i.message==="Load failed"?i.stack===void 0:hd.has(i.message):!1}class Bs extends Error{constructor(t){super(),t instanceof Error?(this.originalError=t,{message:t}=t):(this.originalError=new Error(t),this.originalError.stack=this.stack),this.name="AbortError",this.message=t}}const Si=(i,t,e)=>{const s=e.retries-(t-1);return i.attemptNumber=t,i.retriesLeft=s,i};async function Pi(i,t){return new Promise((e,s)=>{t={...t},t.onFailedAttempt??(t.onFailedAttempt=()=>{}),t.shouldRetry??(t.shouldRetry=()=>!0),t.retries??(t.retries=10);const n=ud.operation(t),o=()=>{var a;n.stop(),s((a=t.signal)==null?void 0:a.reason)};t.signal&&!t.signal.aborted&&t.signal.addEventListener("abort",o,{once:!0});const r=()=>{var a;(a=t.signal)==null||a.removeEventListener("abort",o),n.stop()};n.attempt(async a=>{try{const d=await i(a);r(),e(d)}catch(d){try{if(!(d instanceof Error))throw new TypeError(`Non-error was thrown: "${d}". You should only throw errors.`);if(d instanceof Bs)throw d.originalError;if(d instanceof TypeError&&!md(d))throw d;if(Si(d,a,t),await t.shouldRetry(d)||(n.stop(),s(d)),await t.onFailedAttempt(d),!n.retry(d))throw n.mainError()}catch(p){Si(p,a,t),r(),s(p)}}})})}const fd="@uppy/companion-client",gd="Client library for communication with Companion. Intended for use in Uppy plugins.",yd="4.5.2",bd="MIT",vd="lib/index.js",wd="module",Fd={build:"tsc --build tsconfig.build.json",typecheck:"tsc --build",test:"vitest run --environment=jsdom --silent='passed-only'"},Cd=["file uploader","uppy","uppy-plugin","companion","provider"],Sd="https://uppy.io",Pd={url:"https://github.com/transloadit/uppy/issues"},Td={type:"git",url:"git+https://github.com/transloadit/uppy.git"},xd=["src","lib","dist","CHANGELOG.md"],Ed={"@uppy/utils":"^6.2.2","namespace-emitter":"^2.0.1","p-retry":"^6.1.0"},Nd={jsdom:"^26.1.0",typescript:"^5.8.3",vitest:"^3.2.4"},Ud={"@uppy/core":"^4.5.2"},Ad={name:fd,description:gd,version:yd,license:bd,main:vd,type:wd,scripts:Fd,keywords:Cd,homepage:Sd,bugs:Pd,repository:Td,files:xd,dependencies:Ed,devDependencies:Nd,peerDependencies:Ud};class kd extends Error{constructor(){super("Authorization required");h(this,"isAuthError");this.name="AuthError",this.isAuthError=!0}}function Md(i){return i.replace(/\/$/,"")}const Ti=10,Rd=5*60*1e3,Dd=401;class Id extends Error{constructor({statusCode:e,message:s}){super(s);h(this,"statusCode");this.name="HttpError",this.statusCode=e}}async function Od(i){if(i.status===Dd)throw new kd;if(i.ok)return i.json();let t=`Failed request with status: ${i.status}. ${i.statusText}`,e;try{e=await i.json(),e.message&&(t=`${t} message: ${e.message}`),e.requestId&&(t=`${t} request-Id: ${e.requestId}`)}catch(s){throw new Error(t,{cause:s})}throw i.status>=400&&i.status<=499&&e.message?new ad(e.message):new Id({statusCode:i.status,message:t})}function $d(i,t,e){const{progress:s,bytesUploaded:n,bytesTotal:o}=t;s&&(i.uppy.log(`Upload progress: ${s}`),i.uppy.emit("upload-progress",e,{uploadStarted:e.progress.uploadStarted??0,bytesUploaded:n,bytesTotal:o}))}var Me,Ce,Ls,ss,zs;class fn{constructor(t,e){y(this,Ce);y(this,Me);h(this,"uppy");h(this,"opts");y(this,ss,async({file:t,postBody:e,signal:s})=>{var o;if(((o=t.remote)==null?void 0:o.url)==null)throw new Error("Cannot connect to an undefined URL");return(await this.post(t.remote.url,{...t.remote.body,...e},{signal:s})).token});this.uppy=t,this.opts=e,this.onReceiveResponse=this.onReceiveResponse.bind(this),F(this,Me,e.companionHeaders)}setCompanionHeaders(t){F(this,Me,t)}[Symbol.for("uppy test: getCompanionHeaders")](){return u(this,Me)}get hostname(){const{companion:t}=this.uppy.getState(),e=this.opts.companionUrl;return Md(t!=null&&t[e]?t[e]:e)}async headers(t=!1){return{...{Accept:"application/json",...t?void 0:{"Content-Type":"application/json"}},...u(this,Me)}}onReceiveResponse(t){const{headers:e}=t,n=this.uppy.getState().companion||{},o=this.opts.companionUrl;e.has("i-am")&&e.get("i-am")!==n[o]&&this.uppy.setState({companion:{...n,[o]:e.get("i-am")}})}async request({path:t,method:e="GET",data:s,skipPostResponse:n,signal:o}){try{const r=await this.headers(!s),a=await od(b(this,Ce,Ls).call(this,t),{method:e,signal:o,headers:r,credentials:this.opts.companionCookiesRule||"same-origin",body:s?JSON.stringify(s):null});return n||this.onReceiveResponse(a),await Od(a)}catch(r){throw r.isAuthError||r.name==="UserFacingApiError"||r.name==="AbortError"?r:new id(`Could not ${e} ${b(this,Ce,Ls).call(this,t)}`,{cause:r})}}async get(t,e){return this.request({...e,path:t})}async post(t,e,s){return this.request({...s,path:t,method:"POST",data:e})}async delete(t,e,s){return this.request({...s,path:t,method:"DELETE",data:e})}async uploadRemoteFile(t,e,s){try{const{signal:n,getQueue:o}=s||{};return await Pi(async()=>{var p;const r=(p=this.uppy.getFile(t.id))==null?void 0:p.serverToken;if(r!=null)return this.uppy.log(`Connecting to exiting websocket ${r}`),b(this,Ce,zs).call(this,{file:t,queue:o(),signal:n});const d=await o().wrapPromiseFunction(async(...c)=>{try{return await u(this,ss).call(this,...c)}catch(m){if(m.isAuthError)throw new Bs(m);if(m.cause==null)throw m;const v=m.cause,w=()=>[408,409,429,418,423].includes(v.statusCode)||v.statusCode>=500&&v.statusCode<=599&&![501,505].includes(v.statusCode);throw v.name==="HttpError"&&!w()?new Bs(v):v}},{priority:-1})({file:t,postBody:e,signal:n}).abortOn(n);if(this.uppy.getFile(t.id))return this.uppy.setFileState(t.id,{serverToken:d}),b(this,Ce,zs).call(this,{file:this.uppy.getFile(t.id),queue:o(),signal:n})},{retries:Ti,signal:n,onFailedAttempt:r=>this.uppy.log(`Retrying upload due to: ${r.message}`,"warning")})}catch(n){if(n.name==="AbortError")return;throw this.uppy.emit("upload-error",t,n),n}}}Me=new WeakMap,Ce=new WeakSet,Ls=function(t){return/^(https?:|)\/\//.test(t)?t:`${this.hostname}/${t}`},ss=new WeakMap,zs=async function({file:t,queue:e,signal:s}){let n;const{capabilities:o}=this.uppy.getState();try{return await new Promise((r,a)=>{const d=t.serverToken,p=rd(t.remote.companionUrl);let c,m,v,{isPaused:w}=t;const C=(T,z)=>{if(c==null||c.readyState!==c.OPEN){this.uppy.log(`Cannot send "${T}" to socket ${t.id} because the socket state was ${String(c==null?void 0:c.readyState)}`,"warning");return}c.send(JSON.stringify({action:T,payload:z??{}}))};function E(){o.resumableUploads&&C(w?"pause":"resume")}const U=async()=>{m&&m.abort(),m=new AbortController;const T=f=>{var P;this.uppy.setFileState(t.id,{serverToken:null}),(P=m==null?void 0:m.abort)==null||P.call(m),a(f)};function z(){clearTimeout(v),!w&&(v=setTimeout(()=>T(new Error("Timeout waiting for message from Companion socket")),Rd))}try{await e.wrapPromiseFunction(async()=>{await Pi(async()=>new Promise((P,x)=>{c=new WebSocket(`${p}/api/${d}`),z(),c.addEventListener("close",()=>{c=void 0,x(new Error("Socket closed unexpectedly"))}),c.addEventListener("error",$=>{this.uppy.log(`Companion socket error ${JSON.stringify($)}, closing socket`,"warning"),c==null||c.close()}),c.addEventListener("open",()=>{E()}),c.addEventListener("message",$=>{var M,B,L;z();try{const{action:V,payload:Y}=JSON.parse($.data);switch(V){case"progress":{$d(this,Y,this.uppy.getFile(t.id));break}case"success":{const Se=(M=Y.response)==null?void 0:M.responseText;this.uppy.emit("upload-success",this.uppy.getFile(t.id),{uploadURL:Y.url,status:((B=Y.response)==null?void 0:B.status)??200,body:Se?JSON.parse(Se):void 0}),(L=m==null?void 0:m.abort)==null||L.call(m),r();break}case"error":{const{message:Se}=Y.error;throw Object.assign(new Error(Se),{cause:Y.error})}default:this.uppy.log(`Companion socket unknown action ${V}`,"warning")}}catch(V){T(V)}});const I=()=>{this.uppy.log(`Closing socket ${t.id}`),clearTimeout(v),c&&c.close(),c=void 0};m.signal.addEventListener("abort",()=>{I()})}),{retries:Ti,signal:m.signal,onFailedAttempt:()=>{m.signal.aborted||this.uppy.log(`Retrying websocket ${t.id}`)}})})().abortOn(m.signal)}catch(f){if(m.signal.aborted)return;T(f)}},N=T=>{o.resumableUploads&&(w=T,c&&E())},R=T=>{var z;o.individualCancellation&&T.id===t.id&&(C("cancel"),(z=m==null?void 0:m.abort)==null||z.call(m),this.uppy.log(`upload ${t.id} was removed`),r())},k=()=>{var T;C("cancel"),(T=m==null?void 0:m.abort)==null||T.call(m),this.uppy.log(`upload ${t.id} was canceled`),r()},A=(T,z)=>{(T==null?void 0:T.id)===t.id&&N(z)},O=()=>N(!0),D=()=>N(!1);this.uppy.on("file-removed",R),this.uppy.on("cancel-all",k),this.uppy.on("upload-pause",A),this.uppy.on("pause-all",O),this.uppy.on("resume-all",D),n=()=>{this.uppy.off("file-removed",R),this.uppy.off("cancel-all",k),this.uppy.off("upload-pause",A),this.uppy.off("pause-all",O),this.uppy.off("resume-all",D)},s.addEventListener("abort",()=>{m==null||m.abort()}),U()})}finally{n==null||n()}},h(fn,"VERSION",Ad.version);var le,Ft;class Bd{constructor(t){y(this,le);y(this,Ft,[]);F(this,le,t)}on(t,e){return u(this,Ft).push([t,e]),u(this,le).on(t,e)}remove(){for(const[t,e]of u(this,Ft).splice(0))u(this,le).off(t,e)}onFilePause(t,e){this.on("upload-pause",(s,n)=>{t===(s==null?void 0:s.id)&&e(n)})}onFileRemove(t,e){this.on("file-removed",s=>{t===s.id&&e(s.id)})}onPause(t,e){this.on("upload-pause",(s,n)=>{t===(s==null?void 0:s.id)&&e(n)})}onRetry(t,e){this.on("upload-retry",s=>{t===(s==null?void 0:s.id)&&e()})}onRetryAll(t,e){this.on("retry-all",()=>{u(this,le).getFile(t)&&e()})}onPauseAll(t,e){this.on("pause-all",()=>{u(this,le).getFile(t)&&e()})}onCancelAll(t,e){this.on("cancel-all",(...s)=>{u(this,le).getFile(t)&&e(...s)})}onResumeAll(t,e){this.on("resume-all",()=>{u(this,le).getFile(t)&&e()})}}le=new WeakMap,Ft=new WeakMap;const{AbortController:bs}=globalThis,gn=(i="Aborted",t)=>{const e=new DOMException(i,"AbortError");return t!=null&&hn(t,"cause")&&Object.defineProperty(e,"cause",{__proto__:null,configurable:!0,writable:!0,value:t.cause}),e};function Ld(i){const t=e=>"error"in e&&!!e.error;return i.filter(e=>!t(e))}function zd(i){return i.filter(t=>{var e;return!((e=t.progress)!=null&&e.uploadStarted)||!t.isRestored})}function xi(i,t){return i===!0?Object.keys(t):Array.isArray(i)?i:[]}function jd(i){return new Error("Cancelled",{cause:i})}function Ei(i){var t;if(i!=null){const e=()=>this.abort(i.reason);i.addEventListener("abort",e,{once:!0});const s=()=>{i.removeEventListener("abort",e)};(t=this.then)==null||t.call(this,s,s)}return this}var he,de,me,Ve,ue,Ke,Re,H,js,pt,yn,bn,vn,is,Xe;class _d{constructor(t){y(this,H);y(this,he,0);y(this,de,[]);y(this,me,!1);y(this,Ve);y(this,ue,1);y(this,Ke);y(this,Re);h(this,"limit");y(this,is,()=>this.resume());y(this,Xe,()=>{if(u(this,me)){F(this,Re,setTimeout(u(this,Xe),0));return}F(this,ue,this.limit),this.limit=Math.ceil((u(this,Ke)+u(this,ue))/2);for(let t=u(this,ue);t<=this.limit;t++)b(this,H,pt).call(this);u(this,Ke)-u(this,ue)>3?F(this,Re,setTimeout(u(this,Xe),2e3)):F(this,ue,Math.floor(u(this,ue)/2))});typeof t!="number"||t===0?this.limit=1/0:this.limit=t}run(t,e){return!u(this,me)&&u(this,he)<this.limit?b(this,H,js).call(this,t):b(this,H,bn).call(this,t,e)}wrapSyncFunction(t,e){return(...s)=>{const n=this.run(()=>(t(...s),queueMicrotask(()=>n.done()),()=>{}),e);return{abortOn:Ei,abort(){n.abort()}}}}wrapPromiseFunction(t,e){return(...s)=>{let n;const o=new Promise((r,a)=>{n=this.run(()=>{let d,p;try{p=Promise.resolve(t(...s))}catch(c){p=Promise.reject(c)}return p.then(c=>{d?a(d):(n.done(),r(c))},c=>{d?a(d):(n.done(),a(c))}),c=>{d=jd(c)}},e)});return o.abort=r=>{n.abort(r)},o.abortOn=Ei,o}}resume(){F(this,me,!1),clearTimeout(u(this,Ve));for(let t=0;t<this.limit;t++)b(this,H,pt).call(this)}pause(t=null){F(this,me,!0),clearTimeout(u(this,Ve)),t!=null&&F(this,Ve,setTimeout(u(this,is),t))}rateLimit(t){clearTimeout(u(this,Re)),this.pause(t),this.limit>1&&Number.isFinite(this.limit)&&(F(this,Ke,this.limit-1),this.limit=u(this,ue),F(this,Re,setTimeout(u(this,Xe),t)))}get isPaused(){return u(this,me)}}he=new WeakMap,de=new WeakMap,me=new WeakMap,Ve=new WeakMap,ue=new WeakMap,Ke=new WeakMap,Re=new WeakMap,H=new WeakSet,js=function(t){F(this,he,u(this,he)+1);let e=!1,s;try{s=t()}catch(n){throw F(this,he,u(this,he)-1),n}return{abort:n=>{e||(e=!0,F(this,he,u(this,he)-1),s==null||s(n),b(this,H,pt).call(this))},done:()=>{e||(e=!0,F(this,he,u(this,he)-1),b(this,H,pt).call(this))}}},pt=function(){queueMicrotask(()=>b(this,H,yn).call(this))},yn=function(){if(u(this,me)||u(this,he)>=this.limit||u(this,de).length===0)return;const t=u(this,de).shift();if(t==null)throw new Error("Invariant violation: next is null");const e=b(this,H,js).call(this,t.fn);t.abort=e.abort,t.done=e.done},bn=function(t,e){const s={fn:t,priority:(e==null?void 0:e.priority)||0,abort:()=>{b(this,H,vn).call(this,s)},done:()=>{throw new Error("Cannot mark a queued request as done: this indicates a bug")}},n=u(this,de).findIndex(o=>s.priority>o.priority);return n===-1?u(this,de).push(s):u(this,de).splice(n,0,s),s},vn=function(t){const e=u(this,de).indexOf(t);e!==-1&&u(this,de).splice(e,1)},is=new WeakMap,Xe=new WeakMap;const qd="@uppy/aws-s3",Hd="Upload to Amazon S3 with Uppy",Wd="4.3.2",Gd="MIT",Vd="lib/index.js",Kd="module",Xd={build:"tsc --build tsconfig.build.json",typecheck:"tsc --build",test:"vitest run --environment=jsdom --silent='passed-only'"},Yd=["file uploader","aws s3","amazon s3","s3","uppy","uppy-plugin","multipart"],Jd="https://uppy.io",Qd={url:"https://github.com/transloadit/uppy/issues"},Zd={type:"git",url:"git+https://github.com/transloadit/uppy.git"},eu=["src","lib","dist","CHANGELOG.md"],tu={"@uppy/companion-client":"^4.5.2","@uppy/utils":"^6.2.2"},su={"@aws-sdk/client-s3":"^3.362.0","@aws-sdk/s3-request-presigner":"^3.362.0","@uppy/core":"^4.5.2",jsdom:"^26.1.0",nock:"^13.1.0",typescript:"^5.8.3",vitest:"^3.2.4","whatwg-fetch":"3.6.2"},iu={"@uppy/core":"^4.5.2"},nu={name:qd,description:Hd,version:Wd,license:Gd,main:Vd,type:Kd,scripts:Xd,keywords:Yd,homepage:Jd,bugs:Qd,repository:Zd,files:eu,dependencies:tu,devDependencies:su,peerDependencies:iu},ou=1024*1024,Ni={getChunkSize(i){return Math.ceil(i.size/1e4)},onProgress(){},onPartComplete(){},onSuccess(){},onError(i){throw i}};function ru(i){if(typeof i=="string")return parseInt(i,10);if(typeof i=="number")return i;throw new TypeError("Expected a number")}const Ht=Symbol("pausing upload, not an actual error");var Z,K,ce,fe,ge,Ct,St,Ye,De,Je,Pt,Qe,Tt,oe,wn,Fn,_s,xt,Et,Cn;class au{constructor(t,e){y(this,oe);h(this,"options");y(this,Z,new bs);y(this,K,[]);y(this,ce,[]);y(this,fe);y(this,ge);y(this,Ct,!1);y(this,St);y(this,Ye);y(this,De);y(this,Je);y(this,Pt,t=>(t==null?void 0:t.cause)===Ht?null:u(this,St).call(this,t));y(this,Qe,1e4);y(this,Tt,5*ou);y(this,xt,t=>e=>{if(!e.lengthComputable)return;u(this,ce)[t].uploaded=ru(e.loaded);const s=u(this,ce).reduce((n,o)=>n+o.uploaded,0);this.options.onProgress(s,u(this,fe).size)});y(this,Et,t=>e=>{u(this,K)[t]=null,u(this,ce)[t].etag=e,u(this,ce)[t].done=!0;const s={PartNumber:t+1,ETag:e};this.options.onPartComplete(s)});var s;this.options={...Ni,...e},(s=this.options).getChunkSize??(s.getChunkSize=Ni.getChunkSize),F(this,fe,t),F(this,ge,e.file),F(this,Ye,this.options.onSuccess),F(this,St,this.options.onError),F(this,De,this.options.shouldUseMultipart),F(this,Je,e.uploadId&&e.key),b(this,oe,wn).call(this)}start(){u(this,Ct)?(u(this,Z).signal.aborted||u(this,Z).abort(Ht),F(this,Z,new bs),b(this,oe,_s).call(this)):u(this,Je)?(this.options.companionComm.restoreUploadFile(u(this,ge),{uploadId:this.options.uploadId,key:this.options.key}),b(this,oe,_s).call(this)):b(this,oe,Fn).call(this)}pause(){u(this,Z).abort(Ht),F(this,Z,new bs)}abort(t){t!=null&&t.really?b(this,oe,Cn).call(this):this.pause()}[Symbol.for("uppy test: getChunkState")](){return u(this,ce)}}Z=new WeakMap,K=new WeakMap,ce=new WeakMap,fe=new WeakMap,ge=new WeakMap,Ct=new WeakMap,St=new WeakMap,Ye=new WeakMap,De=new WeakMap,Je=new WeakMap,Pt=new WeakMap,Qe=new WeakMap,Tt=new WeakMap,oe=new WeakSet,wn=function(){const t=u(this,fe).size,e=typeof u(this,De)=="function"?u(this,De).call(this,u(this,ge)):!!u(this,De);if(e&&t>u(this,Tt)){let s=Math.max(this.options.getChunkSize(u(this,fe)),u(this,Tt)),n=Math.floor(t/s);n>u(this,Qe)&&(n=u(this,Qe),s=t/u(this,Qe)),F(this,K,Array(n));for(let o=0,r=0;o<t;o+=s,r++){const a=Math.min(t,o+s),d=()=>{const p=o;return u(this,fe).slice(p,a)};if(u(this,K)[r]={getData:d,onProgress:u(this,xt).call(this,r),onComplete:u(this,Et).call(this,r),shouldUseMultipart:e},u(this,Je)){const p=o+s>t?t-o:s;u(this,K)[r].setAsUploaded=()=>{u(this,K)[r]=null,u(this,ce)[r].uploaded=p}}}}else F(this,K,[{getData:()=>u(this,fe),onProgress:u(this,xt).call(this,0),onComplete:u(this,Et).call(this,0),shouldUseMultipart:e}]);F(this,ce,u(this,K).map(()=>({uploaded:0})))},Fn=function(){this.options.companionComm.uploadFile(u(this,ge),u(this,K),u(this,Z).signal).then(u(this,Ye),u(this,Pt)),F(this,Ct,!0)},_s=function(){this.options.companionComm.resumeUploadFile(u(this,ge),u(this,K),u(this,Z).signal).then(u(this,Ye),u(this,Pt))},xt=new WeakMap,Et=new WeakMap,Cn=function(){u(this,Z).abort(),this.options.companionComm.abortFileUpload(u(this,ge)).catch(t=>this.options.log(t))};function q(i){if(i!=null&&i.aborted)throw gn("The operation was aborted",{cause:i.reason})}function lu(i){const t=new URL(i);return t.search="",t.hash="",t.href}var Nt,ee,Ut,At,kt,Mt,Ze,et,tt,st,Ie,it,te,$e,Sn,qs;class du{constructor(t,e,s,n){y(this,$e);y(this,Nt);y(this,ee,new WeakMap);y(this,Ut);y(this,At);y(this,kt);y(this,Mt);y(this,Ze);y(this,et);y(this,tt);y(this,st);y(this,Ie);y(this,it);y(this,te);F(this,et,t),F(this,Ie,s),F(this,te,n),this.setOptions(e)}setOptions(t){const e=u(this,et);"abortMultipartUpload"in t&&F(this,Nt,e.wrapPromiseFunction(t.abortMultipartUpload,{priority:1})),"createMultipartUpload"in t&&F(this,Ut,e.wrapPromiseFunction(t.createMultipartUpload,{priority:-1})),"signPart"in t&&F(this,At,e.wrapPromiseFunction(t.signPart)),"listParts"in t&&F(this,Mt,e.wrapPromiseFunction(t.listParts)),"completeMultipartUpload"in t&&F(this,st,e.wrapPromiseFunction(t.completeMultipartUpload,{priority:1})),"retryDelays"in t&&F(this,tt,t.retryDelays??[]),"uploadPartBytes"in t&&F(this,it,e.wrapPromiseFunction(t.uploadPartBytes,{priority:1/0})),"getUploadParameters"in t&&F(this,kt,e.wrapPromiseFunction(t.getUploadParameters))}async getUploadId(t,e){let s;for(;s=u(this,ee).get(t.data),s!=null;)try{return await s}catch{}const n=u(this,Ut).call(this,u(this,te).call(this,t),e),o=()=>{n.abort(e.reason),u(this,ee).delete(t.data)};return e.addEventListener("abort",o,{once:!0}),u(this,ee).set(t.data,n),n.then(async r=>{e.removeEventListener("abort",o),u(this,Ie).call(this,t,r),u(this,ee).set(t.data,r)},()=>{e.removeEventListener("abort",o),u(this,ee).delete(t.data)}),n}async abortFileUpload(t){const e=u(this,ee).get(t.data);if(e==null)return;u(this,ee).delete(t.data),u(this,Ie).call(this,t,Object.create(null));let s;try{s=await e}catch{return}await u(this,Nt).call(this,u(this,te).call(this,t),s)}async uploadFile(t,e,s){if(q(s),e.length===1&&!e[0].shouldUseMultipart)return b(this,$e,qs).call(this,t,e[0],s);const{uploadId:n,key:o}=await this.getUploadId(t,s);q(s);try{const r=await Promise.all(e.map((a,d)=>this.uploadChunk(t,d+1,a,s)));return q(s),await u(this,st).call(this,u(this,te).call(this,t),{key:o,uploadId:n,parts:r,signal:s},s).abortOn(s)}catch(r){throw(r==null?void 0:r.cause)!==Ht&&(r==null?void 0:r.name)!=="AbortError"&&this.abortFileUpload(t),r}}restoreUploadFile(t,e){u(this,ee).set(t.data,e)}async resumeUploadFile(t,e,s){if(q(s),e.length===1&&e[0]!=null&&!e[0].shouldUseMultipart)return b(this,$e,qs).call(this,t,e[0],s);const{uploadId:n,key:o}=await this.getUploadId(t,s);q(s);const r=await u(this,Mt).call(this,u(this,te).call(this,t),{uploadId:n,key:o,signal:s},s).abortOn(s);q(s);const a=await Promise.all(e.map((d,p)=>{var v;const c=p+1,m=r.find(({PartNumber:w})=>w===c);return m==null?this.uploadChunk(t,c,d,s):((v=d==null?void 0:d.setAsUploaded)==null||v.call(d),{PartNumber:c,ETag:m.ETag})}));return q(s),u(this,st).call(this,u(this,te).call(this,t),{key:o,uploadId:n,parts:a,signal:s},s).abortOn(s)}async uploadChunk(t,e,s,n){q(n);const{uploadId:o,key:r}=await this.getUploadId(t,n),a=u(this,tt).values(),d=u(this,tt).values(),p=()=>{const c=a.next();return c==null||c.done?null:c.value};for(;;){q(n);const c=s.getData(),{onProgress:m,onComplete:v}=s;let w;try{w=await u(this,At).call(this,u(this,te).call(this,t),{uploadId:o,key:r,partNumber:e,body:c,signal:n}).abortOn(n)}catch(C){const E=p();if(E==null||n.aborted)throw C;await new Promise(U=>setTimeout(U,E));continue}q(n);try{return{PartNumber:e,...await u(this,it).call(this,{signature:w,body:c,size:c.size,onProgress:m,onComplete:v,signal:n}).abortOn(n)}}catch(C){if(!await b(this,$e,Sn).call(this,C,d))throw C}}}}Nt=new WeakMap,ee=new WeakMap,Ut=new WeakMap,At=new WeakMap,kt=new WeakMap,Mt=new WeakMap,Ze=new WeakMap,et=new WeakMap,tt=new WeakMap,st=new WeakMap,Ie=new WeakMap,it=new WeakMap,te=new WeakMap,$e=new WeakSet,Sn=async function(t,e){var o;const s=u(this,et),n=(o=t==null?void 0:t.source)==null?void 0:o.status;if(n==null)return!1;if(n===403&&t.message==="Request has expired"){if(!s.isPaused){if(s.limit===1||u(this,Ze)==null){const r=e.next();if(r==null||r.done)return!1;F(this,Ze,r.value)}s.rateLimit(0),await new Promise(r=>setTimeout(r,u(this,Ze)))}}else if(n===429){if(!s.isPaused){const r=e.next();if(r==null||r.done)return!1;s.rateLimit(r.value)}}else{if(n>400&&n<500&&n!==409)return!1;if(typeof navigator<"u"&&navigator.onLine===!1)s.isPaused||(s.pause(),window.addEventListener("online",()=>{s.resume()},{once:!0}));else{const r=e.next();if(r==null||r.done)return!1;await new Promise(a=>setTimeout(a,r.value))}}return!0},qs=async function(t,e,s){const{method:n="POST",url:o,fields:r,headers:a}=await u(this,kt).call(this,u(this,te).call(this,t),{signal:s}).abortOn(s);let d;const p=e.getData();if(n.toUpperCase()==="POST"){const C=new FormData;Object.entries(r).forEach(([E,U])=>C.set(E,U)),C.set("file",p),d=C}else d=p;const{onProgress:c,onComplete:m}=e,v=await u(this,it).call(this,{signature:{url:o,headers:a,method:n},body:d,size:p.size,onProgress:c,onComplete:m,signal:s}).abortOn(s),w=r==null?void 0:r.key;return u(this,Ie).call(this,t,{key:w}),{...v,location:v.location??lu(o),bucket:r==null?void 0:r.bucket,key:w}};function Le(i){if(i!=null&&i.error){const t=new Error(i.message);throw Object.assign(t,i.error),t}return i}function Ui(i){const t=i.Expiration;if(t){const e=Math.floor((new Date(t)-Date.now())/1e3);if(e>9)return e}}function Ai({meta:i,allowedMetaFields:t,querify:e=!1}){const s=t??Object.keys(i);return i?Object.fromEntries(s.filter(n=>i[n]!=null).map(n=>{const o=e?`metadata[${n}]`:n,r=String(i[n]);return[o,r]})):{}}const uu={allowedMetaFields:!0,limit:6,getTemporarySecurityCredentials:!1,shouldUseMultipart:i=>(i.size||0)>100*1024*1024,retryDelays:[0,1e3,3e3,5e3]};var nt,W,j,Ws,ye,se,Pn,ns,ot,Tn,xn,Rt,rt,Oe,Dt;const os=class os extends Ri{constructor(e,s){super(e,{...uu,uploadPartBytes:os.uploadPartBytes,createMultipartUpload:null,listParts:null,abortMultipartUpload:null,completeMultipartUpload:null,signPart:null,getUploadParameters:null,...s});y(this,j);y(this,nt);y(this,W);h(this,"requests");h(this,"uploaderEvents");h(this,"uploaders");y(this,se);y(this,ns,(e,{key:s,uploadId:n})=>{const o=this.uppy.getFile(e.id);o!=null&&this.uppy.setFileState(e.id,{s3Multipart:{...o.s3Multipart,key:s,uploadId:n}})});y(this,ot,e=>this.uppy.getFile(e.id)||e);y(this,Rt,async e=>{if(e.length===0)return;const s=this.uppy.getFilesByIds(e),n=Ld(s),o=zd(n);this.uppy.emit("upload-start",o);const r=n.map(d=>{if(d.isRemote){const p=()=>this.requests;u(this,Oe).call(this,!1);const c=new AbortController,m=w=>{w.id===d.id&&c.abort()};this.uppy.on("file-removed",m);const v=this.uppy.getRequestClientForFile(d).uploadRemoteFile(d,b(this,j,xn).call(this,d),{signal:c.signal,getQueue:p});return this.requests.wrapSyncFunction(()=>{this.uppy.off("file-removed",m)},{priority:-1})(),v}return b(this,j,Tn).call(this,d)}),a=await Promise.allSettled(r);return u(this,Oe).call(this,!0),a});y(this,rt,()=>{var e;(e=u(this,W))==null||e.setCompanionHeaders(this.opts.headers)});y(this,Oe,e=>{const{capabilities:s}=this.uppy.getState();this.uppy.setState({capabilities:{...s,resumableUploads:e}})});y(this,Dt,()=>{u(this,Oe).call(this,!0)});this.type="uploader",this.id=this.opts.id||"AwsS3Multipart",b(this,j,Ws).call(this,s);const n={createMultipartUpload:this.createMultipartUpload,listParts:this.listParts,abortMultipartUpload:this.abortMultipartUpload,completeMultipartUpload:this.completeMultipartUpload,signPart:s!=null&&s.getTemporarySecurityCredentials?this.createSignedURL:this.signPart,getUploadParameters:s!=null&&s.getTemporarySecurityCredentials?this.createSignedURL:this.getUploadParameters};for(const o of Object.keys(n))this.opts[o]==null&&(this.opts[o]=n[o].bind(this));this.requests=this.opts.rateLimitedQueue??new _d(this.opts.limit),F(this,nt,new du(this.requests,this.opts,u(this,ns),u(this,ot))),this.uploaders=Object.create(null),this.uploaderEvents=Object.create(null)}[Symbol.for("uppy test: getClient")](){return u(this,W)}setOptions(e){u(this,nt).setOptions(e),super.setOptions(e),b(this,j,Ws).call(this,e)}resetUploaderReferences(e,s){this.uploaders[e]&&(this.uploaders[e].abort({really:(s==null?void 0:s.abort)||!1}),this.uploaders[e]=null),this.uploaderEvents[e]&&(this.uploaderEvents[e].remove(),this.uploaderEvents[e]=null)}createMultipartUpload(e,s){b(this,j,ye).call(this,"createMultipartUpload"),q(s);const n=xi(this.opts.allowedMetaFields,e.meta),o=Ai({meta:e.meta,allowedMetaFields:n});return u(this,W).post("s3/multipart",{filename:e.name,type:e.type,metadata:o},{signal:s}).then(Le)}listParts(e,{key:s,uploadId:n,signal:o},r){o??(o=r),b(this,j,ye).call(this,"listParts"),q(o);const a=encodeURIComponent(s);return u(this,W).get(`s3/multipart/${encodeURIComponent(n)}?key=${a}`,{signal:o}).then(Le)}completeMultipartUpload(e,{key:s,uploadId:n,parts:o,signal:r},a){r??(r=a),b(this,j,ye).call(this,"completeMultipartUpload"),q(r);const d=encodeURIComponent(s),p=encodeURIComponent(n);return u(this,W).post(`s3/multipart/${p}/complete?key=${d}`,{parts:o.map(({ETag:c,PartNumber:m})=>({ETag:c,PartNumber:m}))},{signal:r}).then(Le)}async createSignedURL(e,s){const n=await b(this,j,Pn).call(this,s),o=Ui(n.credentials)||604800,{uploadId:r,key:a,partNumber:d}=s;return{method:"PUT",expires:o,fields:{},url:`${await jn({accountKey:n.credentials.AccessKeyId,accountSecret:n.credentials.SecretAccessKey,sessionToken:n.credentials.SessionToken,expires:o,bucketName:n.bucket,Region:n.region,Key:a??`${crypto.randomUUID()}-${e.name}`,uploadId:r,partNumber:d})}`,headers:{"Content-Type":e.type}}}signPart(e,{uploadId:s,key:n,partNumber:o,signal:r}){if(b(this,j,ye).call(this,"signPart"),q(r),s==null||n==null||o==null)throw new Error("Cannot sign without a key, an uploadId, and a partNumber");const a=encodeURIComponent(n);return u(this,W).get(`s3/multipart/${encodeURIComponent(s)}/${o}?key=${a}`,{signal:r}).then(Le)}abortMultipartUpload(e,{key:s,uploadId:n,signal:o}){b(this,j,ye).call(this,"abortMultipartUpload");const r=encodeURIComponent(s),a=encodeURIComponent(n);return u(this,W).delete(`s3/multipart/${a}?key=${r}`,void 0,{signal:o}).then(Le)}getUploadParameters(e,s){b(this,j,ye).call(this,"getUploadParameters");const{meta:n}=e,{type:o,name:r}=n,a=xi(this.opts.allowedMetaFields,e.meta),d=Ai({meta:n,allowedMetaFields:a,querify:!0}),p=new URLSearchParams({filename:r,type:o,...d});return u(this,W).get(`s3/params?${p}`,s)}static async uploadPartBytes({signature:{url:e,expires:s,headers:n,method:o="PUT"},body:r,size:a=r.size,onProgress:d,onComplete:p,signal:c}){if(q(c),e==null)throw new Error("Cannot upload to an undefined URL");return new Promise((m,v)=>{const w=new XMLHttpRequest;w.open(o,e,!0),n&&Object.keys(n).forEach(U=>{w.setRequestHeader(U,n[U])}),w.responseType="text",typeof s=="number"&&(w.timeout=s*1e3);function C(){w.abort()}function E(){c==null||c.removeEventListener("abort",C)}c==null||c.addEventListener("abort",C),w.upload.addEventListener("progress",U=>{d(U)}),w.addEventListener("abort",()=>{E(),v(gn())}),w.addEventListener("timeout",()=>{E();const U=new Error("Request has expired");U.source={status:403},v(U)}),w.addEventListener("load",()=>{if(E(),w.status===403&&w.responseText.includes("<Message>Request has expired</Message>")){const A=new Error("Request has expired");A.source=w,v(A);return}if(w.status<200||w.status>=300){const A=new Error("Non 2xx");A.source=w,v(A);return}d==null||d({loaded:a,lengthComputable:!0});const U=w.getAllResponseHeaders().trim().split(/[\r\n]+/),N={__proto__:null};for(const A of U){const O=A.split(": "),D=O.shift(),T=O.join(": ");N[D]=T}const{etag:R,location:k}=N;if(o.toUpperCase()==="POST"&&k==null&&console.error("@uppy/aws-s3: Could not read the Location header. This likely means CORS is not configured correctly on the S3 Bucket. See https://uppy.io/docs/aws-s3/#setting-up-your-s3-bucket"),R==null){console.error("@uppy/aws-s3: Could not read the ETag header. This likely means CORS is not configured correctly on the S3 Bucket. See https://uppy.io/docs/aws-s3/#setting-up-your-s3-bucket");return}p==null||p(R),m({...N,ETag:R})}),w.addEventListener("error",U=>{E();const N=new Error("Unknown error");N.source=U.target,v(N)}),w.send(r)})}install(){u(this,Oe).call(this,!0),this.uppy.addPreProcessor(u(this,rt)),this.uppy.addUploader(u(this,Rt)),this.uppy.on("cancel-all",u(this,Dt))}uninstall(){this.uppy.removePreProcessor(u(this,rt)),this.uppy.removeUploader(u(this,Rt)),this.uppy.off("cancel-all",u(this,Dt))}};nt=new WeakMap,W=new WeakMap,j=new WeakSet,Ws=function(e){e==null||!("endpoint"in e||"companionUrl"in e||"headers"in e||"companionHeaders"in e||"cookiesRule"in e||"companionCookiesRule"in e)||("companionUrl"in e&&!("endpoint"in e)&&this.uppy.log("`companionUrl` option has been removed in @uppy/aws-s3, use `endpoint` instead.","warning"),"companionHeaders"in e&&!("headers"in e)&&this.uppy.log("`companionHeaders` option has been removed in @uppy/aws-s3, use `headers` instead.","warning"),"companionCookiesRule"in e&&!("cookiesRule"in e)&&this.uppy.log("`companionCookiesRule` option has been removed in @uppy/aws-s3, use `cookiesRule` instead.","warning"),"endpoint"in e?F(this,W,new fn(this.uppy,{pluginId:this.id,provider:"AWS",companionUrl:this.opts.endpoint,companionHeaders:this.opts.headers,companionCookiesRule:this.opts.cookiesRule})):("headers"in e&&u(this,rt).call(this),"cookiesRule"in e&&(u(this,W).opts.companionCookiesRule=e.cookiesRule)))},ye=function(e){if(!u(this,W))throw new Error(`Expected a \`endpoint\` option containing a URL, or if you are not using Companion, a custom \`${e}\` implementation.`)},se=new WeakMap,Pn=async function(e){if(q(e==null?void 0:e.signal),u(this,se)==null){const{getTemporarySecurityCredentials:s}=this.opts;s===!0?(b(this,j,ye).call(this,"getTemporarySecurityCredentials"),F(this,se,u(this,W).get("s3/sts",e).then(Le))):F(this,se,s(e)),F(this,se,await u(this,se)),setTimeout(()=>{F(this,se,null)},(Ui(u(this,se).credentials)||0)*500)}return u(this,se)},ns=new WeakMap,ot=new WeakMap,Tn=function(e){return new Promise((s,n)=>{const o=(c,m)=>{const v=this.uppy.getFile(e.id);this.uppy.emit("upload-progress",v,{uploadStarted:v.progress.uploadStarted??0,bytesUploaded:c,bytesTotal:m})},r=c=>{this.uppy.log(c),this.uppy.emit("upload-error",e,c),this.resetUploaderReferences(e.id),n(c)},a=c=>{const m={body:{...c},status:200,uploadURL:c.location};this.resetUploaderReferences(e.id),this.uppy.emit("upload-success",u(this,ot).call(this,e),m),c.location&&this.uppy.log(`Download ${e.name} from ${c.location}`),s(void 0)},d=new au(e.data,{companionComm:u(this,nt),log:(...c)=>this.uppy.log(...c),getChunkSize:this.opts.getChunkSize?this.opts.getChunkSize.bind(this):void 0,onProgress:o,onError:r,onSuccess:a,onPartComplete:c=>{this.uppy.emit("s3-multipart:part-uploaded",u(this,ot).call(this,e),c)},file:e,shouldUseMultipart:this.opts.shouldUseMultipart,...e.s3Multipart});this.uploaders[e.id]=d;const p=new Bd(this.uppy);this.uploaderEvents[e.id]=p,p.onFileRemove(e.id,c=>{d.abort(),this.resetUploaderReferences(e.id,{abort:!0}),s(`upload ${c} was removed`)}),p.onCancelAll(e.id,()=>{d.abort(),this.resetUploaderReferences(e.id,{abort:!0}),s(`upload ${e.id} was canceled`)}),p.onFilePause(e.id,c=>{c?d.pause():d.start()}),p.onPauseAll(e.id,()=>{d.pause()}),p.onResumeAll(e.id,()=>{d.start()}),d.start()})},xn=function(e){var s;return{...(s=e.remote)==null?void 0:s.body,protocol:"s3-multipart",size:e.data.size,metadata:e.meta}},Rt=new WeakMap,rt=new WeakMap,Oe=new WeakMap,Dt=new WeakMap,h(os,"VERSION",nu.version);let Hs=os;function cu({maxNumberOfFiles:i=1,maxFileSize:t=10485760,onGetUploadParameters:e,onComplete:s,buttonClassName:n,children:o}){const[r,a]=G.useState(!1),[d]=G.useState(()=>new xs({restrictions:{maxNumberOfFiles:i,maxFileSize:t},autoProceed:!1}).use(Hs,{shouldUseMultipart:!1,getUploadParameters:e}).on("complete",p=>{s==null||s(p)}));return g.jsxs("div",{children:[g.jsx("div",{onClick:()=>a(!0),className:`cursor-pointer inline-flex items-center justify-center rounded-md font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 ${n}`,children:o}),g.jsx(pn,{uppy:d,open:r,onRequestClose:()=>a(!1),proudlyDisplayPoweredByUppy:!1})]})}const pu=()=>`Welcome to Formul8.ai! ðŸŒ¿ I'm your AI cannabis consultant with access to specialized tools and documents.

**What I can help you with:**
â€¢ ðŸ§ª **Formulation** - Create recipes, calculate dosages, optimize extractions
â€¢ âš–ï¸ **Compliance** - Navigate regulations, permits, and legal requirements  
â€¢ ðŸ“„ **Documents** - Access SOPs, templates, and artifacts
â€¢ ðŸ“Š **Testing** - Run baseline assessments and evaluations
â€¢ ðŸ“ˆ **Analytics** - View dashboards and metrics
â€¢ ðŸ› **Issues** - Report problems or request features
â€¢ ðŸ’¼ **Workspace** - Manage files and folders

**Smart Tool Detection:**
Just mention what you need! I'll automatically suggest or open the right tool for you.

Try asking: "Help me formulate a new product" or "I need compliance info for California"`;function Fu(){const i=_n(),[t,e]=G.useState([{id:"welcome",role:"system",content:pu(),timestamp:new Date().toISOString(),agent:"system",confidence:100}]),[s,n]=G.useState(""),[o,r]=G.useState([]),[a]=G.useState(()=>`thread_${Date.now()}_${Math.random().toString(36).substr(2,9)}`),d=G.useRef(null),p=G.useRef(null),c=qn(),m=G.useContext(Hn);m||console.warn("WindowManagerContext not found in FormulaChatInterface");const v=()=>{var f;(f=d.current)==null||f.scrollIntoView({behavior:"smooth"})};G.useEffect(()=>{v()},[t]);const w=Wn({mutationFn:async f=>{const P=await fetch("/api/ai/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:f,agentType:"general",systemPrompt:"You are a helpful AI assistant for the cannabis industry platform Formul8.ai. Provide accurate, helpful responses. If you are creating documents, format them appropriately."})});if(!P.ok)throw new Error(`HTTP ${P.status}: ${P.statusText}`);return await P.json()},onSuccess:f=>{const P={id:`assistant_${Date.now()}`,role:"assistant",content:f.content||"No response received",timestamp:new Date().toISOString(),agent:"general",confidence:85,requiresHumanReview:!1,verificationCount:1};if(e(x=>[...x,P]),f.fileData&&(m!=null&&m.createWindow))try{const x=f.fileData.title||"Generated Document",I=f.fileData.content||"",M=window.innerWidth-56-720,B=80;m.createWindow({type:"document",title:x,content:{documentContent:I,documentType:f.fileData.documentType||"general",isAsciiDoc:I.includes("=")&&I.includes("::")},size:{width:700,height:500},position:{x:M,y:B}}),fetch("/api/documents",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:x,content:I,documentType:f.fileData.documentType||"general",position:{x:M,y:B}})}).then(L=>{L.ok&&c.invalidateQueries({queryKey:["/api/documents"]})}).catch(L=>{console.error("Error saving document:",L)})}catch(x){console.error("Error creating document window:",x)}typeof D=="function"&&D(f.content)},onError:f=>{console.error("Chat error:",f);const P={id:`error_${Date.now()}`,role:"system",content:"I apologize, but I encountered an error processing your request. Please try again or contact support if the issue persists.",timestamp:new Date().toISOString(),agent:"system",confidence:0};e(x=>[...x,P])}}),C=f=>{if(f.preventDefault(),!s.trim()&&o.length===0||w.isPending)return;const P={id:`user_${Date.now()}`,role:"user",content:s||(o.length>0?"ðŸ“Ž Shared files":""),timestamp:new Date().toISOString(),attachments:o.length>0?[...o]:void 0};e($=>[...$,P]);const x=R(s);if(x.length>0&&s.trim()){const $=x.map(M=>M.description).join(", ");setTimeout(()=>{const M={id:`system_tools_${Date.now()}`,role:"system",content:`I detected you might need: **${$}**

I can open these tools for you or provide information. Would you like me to launch any of these tools?`,timestamp:new Date().toISOString(),agent:"system",confidence:100};e(B=>[...B,M]),x.length===1&&(s.includes("open")||s.includes("launch")||s.includes("start"))&&x[0].action()},1e3)}const I=o.length>0?`${s}

Attached files: ${o.map($=>$.fileName).join(", ")}`:s;w.mutate(I),n(""),r([])},E=async()=>{try{return{method:"PUT",url:(await ii("/api/attachments/upload-url",{method:"POST"})).uploadURL}}catch(f){throw console.error("Failed to get upload parameters:",f),f}},U=async f=>{try{for(const P of f.successful)if(P.uploadURL){const x=await ii("/api/attachments",{method:"POST",body:JSON.stringify({fileName:P.name,fileUrl:P.uploadURL,fileType:P.type||"application/octet-stream",fileSize:P.size}),headers:{"Content-Type":"application/json"}});r(I=>[...I,x])}}catch(P){console.error("Failed to process attachment:",P)}},N=f=>{r(P=>P.filter(x=>x.id!==f))},R=f=>{const P=f.toLowerCase().trim();return[{patterns:["formulation","formulate","recipe","formula","extract","concentration","dosage"],tool:"formulation",description:"Formulation Wizard",route:"/design",icon:"ðŸ§ª",action:()=>{window.open("/design","_blank")}},{patterns:["issue","bug","problem","report","ticket","support"],tool:"issue",description:"Issue Tracker",route:"/roadmap",icon:"ðŸ›",action:()=>{window.open("/roadmap","_blank")}},{patterns:["compliance","regulation","legal","law","permit","license"],tool:"compliance",description:"Compliance Dashboard",route:"/pages/ComplianceAgent",icon:"âš–ï¸",action:()=>{window.open("/ComplianceAgent","_blank")}},{patterns:["artifact","document","template","form","sop","procedure"],tool:"artifacts",description:"Document Manager",route:"/artifacts",icon:"ðŸ“„",action:()=>{window.open("/artifacts","_blank")}},{patterns:["baseline","test","assessment","evaluation","metric"],tool:"baseline",description:"Baseline Testing",route:"/baseline-testing",icon:"ðŸ“Š",action:()=>{window.open("/BaselineAssessment","_blank")}},{patterns:["dashboard","overview","analytics","metrics","stats"],tool:"dashboard",description:"Main Dashboard",route:"/dashboard",icon:"ðŸ“ˆ",action:()=>{window.open("/dashboard","_blank")}},{patterns:["workspace","desktop","file","folder","files"],tool:"workspace",description:"File Workspace",route:"/workspace",icon:"ðŸ’¼",action:()=>{window.open("/workspace","_blank")}}].filter($=>$.patterns.some(M=>P.includes(M)))},k=f=>({compliance:"bg-formul8-primary",formulation:"bg-formul8-warning",patent:"bg-formul8-info",operations:"bg-formul8-tertiary",sourcing:"bg-formul8-secondary",marketing:"bg-formul8-success",spectra:"bg-formul8-error","customer-success":"bg-purple-500",system:"bg-gray-500"})[f]||"bg-gray-500",A=f=>({compliance:"Compliance Expert",formulation:"Formulation Specialist",patent:"IP Attorney",operations:"Operations Engineer",sourcing:"Sourcing Agent",marketing:"Marketing Strategist",spectra:"Analytical Chemist","customer-success":"Customer Success",system:"Formul8 Assistant"})[f]||"AI Assistant",O=(f,P,x)=>{m&&m.createWindow({type:"document",title:P,content:{mode:"document-viewer",url:f,fileType:x,fileName:P}})},D=f=>{const P=/```(\w*)\n([\s\S]*?)```/g,x=["asciidoc","adoc","txt","md","markdown","json","yaml","yml","csv","xml"];let I;const $=[];for(;(I=P.exec(f))!==null;){const[M,B,L]=I;if(x.includes(B.toLowerCase())||L.includes("= ")||L.includes("## ")||L.includes("title:")||L.length>200){const V=B.toLowerCase()||"adoc",Y=`Generated_${Date.now()}.${V}`;$.push({fileName:Y,content:L,language:V,fullMatch:M})}}if($.length>0&&m){const M=$[0];if(i)m.createWindow({type:"document",title:`ðŸ“„ ${M.fileName}`,content:{mode:"file-preview",fileName:M.fileName,fileContent:M.content,fileType:M.language,isGenerated:!0},size:{width:window.innerWidth,height:window.innerHeight},position:{x:0,y:0}});else{const L=(m.windows||[]).find(V=>V.type==="chat");L&&m.updateWindow({...L,width:Math.floor(window.innerWidth/2),height:window.innerHeight,x:0,y:0}),m.createWindow({type:"document",title:`ðŸ“„ ${M.fileName}`,content:{mode:"file-preview",fileName:M.fileName,fileContent:M.content,fileType:M.language,isGenerated:!0},size:{width:Math.floor(window.innerWidth/2),height:window.innerHeight},position:{x:Math.floor(window.innerWidth/2),y:0}})}}},T=f=>{const P=/```(\w*)\n([\s\S]*?)```/g,x=["asciidoc","adoc","txt","md","markdown","json","yaml","yml","csv","xml"],I=P.exec(f);if(!I)return null;const[$,M,B]=I;if(x.includes(M.toLowerCase())||B.includes("= ")||B.includes("## ")||B.includes("title:")||B.length>100){const L=M.toLowerCase()||"adoc";return g.jsxs("div",{className:"mt-4 border border-formul8-border rounded-lg bg-formul8-bg-dark",children:[g.jsxs("div",{className:"flex items-center justify-between p-3 border-b border-formul8-border bg-formul8-bg-card",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(Ss,{className:"w-4 h-4 text-formul8-primary"}),g.jsx("span",{className:"text-sm font-medium text-formul8-white",children:"Generated File Preview"}),g.jsx(ze,{variant:"outline",className:"text-xs border-formul8-primary text-formul8-primary",children:L.toUpperCase()})]}),g.jsxs(lt,{size:"sm",variant:"outline",onClick:()=>{window.open("/artifacts","_blank")},className:"text-xs border-formul8-border text-formul8-white hover:bg-formul8-bg-light",children:[g.jsx(ki,{className:"w-3 h-3 mr-1"}),"Open Full View"]})]}),g.jsx("div",{className:"p-3 max-h-40 overflow-y-auto",children:g.jsxs("pre",{className:"text-xs text-formul8-white font-mono whitespace-pre-wrap",children:[B.slice(0,300),B.length>300?"...":""]})})]})}return null},z={a:({href:f,children:P,...x})=>f&&(f.includes(".pdf")||f.includes(".doc")||f.includes(".docx")||f.includes(".xls")||f.includes(".xlsx")||f.includes(".ppt")||f.includes(".pptx")||f.includes("docs.google.com")||f.includes("drive.google.com")||f.includes("sharepoint.com")||f.includes("onedrive.com"))?g.jsx(lo,{url:f,title:(P==null?void 0:P.toString())||f.split("/").pop()||"Document",onOpenDocument:O}):g.jsx("a",{href:f,target:"_blank",rel:"noopener noreferrer",className:"text-formul8-primary hover:text-formul8-blue underline",...x,children:P})};return g.jsxs("div",{className:"flex flex-col h-full w-full bg-formul8-bg-dark",children:[g.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-formul8-border bg-formul8-bg-card",children:[g.jsxs("div",{className:"flex items-center space-x-3",children:[g.jsx("div",{className:"w-10 h-10 bg-formul8-primary rounded-lg flex items-center justify-center",children:g.jsx(Gn,{className:"w-6 h-6 text-white"})}),g.jsxs("div",{children:[g.jsx("h2",{className:"text-lg font-semibold text-formul8-white",children:"Formul8 AI Assistant"}),g.jsx("p",{className:"text-sm text-formul8-muted",children:"Multi-agent cannabis intelligence"})]})]}),g.jsxs(ze,{variant:"outline",className:"border-formul8-primary text-formul8-primary bg-formul8-bg-dark",children:["Thread: ",a.split("_")[1]]})]}),g.jsx(Vn,{className:"flex-1 px-4 py-4 bg-formul8-bg-dark",children:g.jsxs("div",{className:"space-y-4",children:[t.map(f=>{var P;return g.jsx("div",{className:`flex ${f.role==="user"?"justify-end":"justify-start"}`,children:g.jsxs("div",{className:`flex max-w-[80%] ${f.role==="user"?"flex-row-reverse":"flex-row"} items-start space-x-3`,children:[g.jsx(ei,{className:"w-8 h-8 mt-1",children:g.jsx(ti,{className:`${f.role==="user"?"bg-formul8-secondary":k(f.agent||"system")} text-white text-xs`,children:f.role==="user"?"U":((P=f.agent)==null?void 0:P.charAt(0).toUpperCase())||"F"})}),g.jsx(Fs,{className:`${f.role==="user"?"bg-formul8-primary text-white":"bg-formul8-bg-card border-formul8-border"} shadow-sm`,children:g.jsxs(Cs,{className:"p-3",children:[f.role!=="user"&&f.agent&&g.jsxs("div",{className:"flex items-center justify-between mb-2",children:[g.jsx("span",{className:"text-xs font-medium text-formul8-muted",children:A(f.agent)}),f.confidence!==void 0&&g.jsxs("div",{className:"flex items-center space-x-2",children:[f.confidence>80?g.jsx(Kn,{className:"w-3 h-3 text-formul8-success"}):f.confidence>60?g.jsx(si,{className:"w-3 h-3 text-formul8-warning"}):g.jsx(si,{className:"w-3 h-3 text-formul8-error"}),g.jsxs("span",{className:"text-xs text-formul8-muted",children:[f.confidence,"% confidence"]})]})]}),g.jsx("div",{className:`text-sm ${f.role==="user"?"text-white":"text-formul8-white"}`,children:g.jsx(Xn,{components:z,remarkPlugins:[Yn,Jn,Qn],rehypePlugins:[[Zn,{output:"htmlAndMathml"}]],children:f.content})}),f.attachments&&f.attachments.length>0&&g.jsx("div",{className:"mt-3 space-y-2",children:f.attachments.map(x=>g.jsxs("div",{className:"flex items-center gap-2 p-2 bg-formul8-bg-dark rounded-lg border border-formul8-border",children:[g.jsx(ni,{className:"w-4 h-4 text-formul8-muted"}),g.jsx("span",{className:"text-xs text-formul8-white truncate flex-1",children:x.fileName}),g.jsxs(ze,{variant:"outline",className:"text-xs border-formul8-muted text-formul8-muted",children:[Math.round(x.fileSize/1024),"KB"]})]},x.id))}),f.role==="system"&&f.content.includes("I detected you might need")&&g.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:R(s).map((x,I)=>g.jsxs(lt,{size:"sm",variant:"outline",onClick:()=>x.action(),className:"text-xs bg-formul8-primary/10 border-formul8-primary/30 text-formul8-primary hover:bg-formul8-primary/20",children:[x.icon," ",x.description]},I))}),f.role==="assistant"&&T(f.content),f.verificationCount!==void 0&&f.verificationCount>0&&g.jsx("div",{className:"mt-2 pt-2 border-t border-formul8-border",children:g.jsxs("span",{className:"text-xs text-formul8-muted",children:["Verified with ",f.verificationCount," additional agent",f.verificationCount>1?"s":""]})}),f.requiresHumanReview&&g.jsx("div",{className:"mt-2",children:g.jsx(ze,{variant:"outline",className:"text-xs border-formul8-warning text-formul8-warning bg-formul8-bg-card",children:"Human Review Requested"})})]})})]})},f.id)}),w.isPending&&g.jsx("div",{className:"flex justify-start",children:g.jsxs("div",{className:"flex items-start space-x-3 max-w-[80%]",children:[g.jsx(ei,{className:"w-8 h-8 mt-1",children:g.jsx(ti,{className:"bg-formul8-primary text-white",children:g.jsx(ds,{className:"w-4 h-4 animate-spin"})})}),g.jsx(Fs,{className:"bg-formul8-card border-formul8-border shadow-sm",children:g.jsx(Cs,{className:"p-3",children:g.jsxs("div",{className:"flex items-center space-x-2",children:[g.jsx(ds,{className:"w-4 h-4 animate-spin text-formul8-primary"}),g.jsx("span",{className:"text-sm text-formul8-gray",children:"Processing with multi-agent system..."})]})})})]})}),g.jsx("div",{ref:d})]})}),g.jsxs("div",{className:"px-4 py-4 border-t border-formul8-border bg-formul8-bg-dark",children:[o.length>0&&g.jsxs("div",{className:"mb-3 space-y-2",children:[g.jsx("p",{className:"text-xs text-formul8-muted",children:"Attached files:"}),o.map(f=>g.jsxs("div",{className:"flex items-center gap-2 p-2 bg-formul8-bg-dark rounded-lg border border-formul8-border",children:[g.jsx(ni,{className:"w-4 h-4 text-formul8-primary"}),g.jsx("span",{className:"text-xs text-formul8-white truncate flex-1",children:f.fileName}),g.jsxs(ze,{variant:"outline",className:"text-xs border-formul8-primary text-formul8-primary",children:[Math.round(f.fileSize/1024),"KB"]}),g.jsx(lt,{size:"sm",variant:"ghost",onClick:()=>N(f.id),className:"h-6 w-6 p-0 text-formul8-muted hover:text-formul8-white",children:g.jsx(eo,{className:"w-3 h-3"})})]},f.id))]}),g.jsxs("form",{onSubmit:C,className:"flex space-x-2",children:[g.jsx(to,{ref:p,value:s,onChange:f=>n(f.target.value),placeholder:"Ask about compliance, formulation, patents, operations, or more...",className:"flex-1 border-formul8-border focus:border-formul8-primary bg-formul8-bg-dark text-formul8-white placeholder:text-formul8-muted",disabled:w.isPending}),g.jsx(cu,{maxNumberOfFiles:3,maxFileSize:10485760,onGetUploadParameters:E,onComplete:U,buttonClassName:"bg-formul8-bg-dark border border-formul8-border hover:bg-formul8-bg-light text-formul8-white p-2 h-10 w-10",children:g.jsx(so,{className:"w-4 h-4"})}),g.jsx(lt,{type:"submit",disabled:!s.trim()&&o.length===0||w.isPending,className:"bg-formul8-primary hover:bg-formul8-blue text-white px-6",children:w.isPending?g.jsx(ds,{className:"w-4 h-4 animate-spin"}):g.jsx(io,{className:"w-4 h-4"})})]}),g.jsxs("p",{className:"text-xs text-formul8-text-gray mt-2 text-center",children:["Powered by multi-agent verification system with ",t.filter(f=>f.agent&&f.agent!=="system").length>0?"active":"ready"," cannabis industry experts"]})]})]})}export{Fu as default};
