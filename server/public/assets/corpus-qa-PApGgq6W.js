import{u as Z,t as ee,r as l,m as v,v as f,j as e,T as se,i as ae,k as N,l as y,C,a as b,b as S,a3 as U,c as z,d as w,X as n,Y as O,_ as E,$ as J,a0 as V,a1 as u,I as te,P as ne,B as q,R as ie,K as re,f as h,q as le,a5 as de,Q as ce,J as A}from"./index-B8YngC3q.js";import{C as $}from"./checkbox-DUaFzWWc.js";import{B as oe}from"./brain-DEV5rvKH.js";import{P as ue}from"./play-DCfOixJ6.js";import{D as me}from"./database-CI_RWL3T.js";function fe(){var K,L;const{toast:i}=Z(),g=ee(),[a,H]=l.useState(""),[Q,X]=l.useState(100),[F,Y]=l.useState("mixed"),[c,G]=l.useState([]),[D,_]=l.useState(!1),[m,p]=l.useState(!1),[P,o]=l.useState(0),{data:r,isLoading:xe}=v({queryKey:["/api/corpus-qa/domains"],enabled:!0}),{data:t}=v({queryKey:["/api/corpus-qa/status",a],enabled:!!a}),{data:j}=v({queryKey:["/api/corpus-qa/qa-files",a],enabled:!!a}),T=f({mutationFn:async s=>A("/api/corpus-qa/download",{method:"POST",body:JSON.stringify({agentDomain:s})}),onSuccess:()=>{i({title:"Corpus Downloaded",description:"Successfully downloaded corpus documents"}),g.invalidateQueries({queryKey:["/api/corpus-qa/status"]})},onError:s=>{i({title:"Download Failed",description:s.message||"Failed to download corpus",variant:"destructive"})}}),B=f({mutationFn:async s=>A("/api/corpus-qa/generate",{method:"POST",body:JSON.stringify(s)}),onSuccess:s=>{i({title:"Q&A Generated",description:`Generated ${s.data.totalQuestions} questions successfully`}),g.invalidateQueries({queryKey:["/api/corpus-qa/qa-files"]}),p(!1),o(0)},onError:s=>{i({title:"Generation Failed",description:s.message||"Failed to generate Q&A",variant:"destructive"}),p(!1),o(0)}}),k=f({mutationFn:async s=>A(`/api/corpus-qa/baseline/${s.agentDomain}`,{method:"POST",body:JSON.stringify({maxQuestions:s.maxQuestions})}),onSuccess:()=>{i({title:"Baseline Generated",description:"Successfully generated baseline corpus"}),g.invalidateQueries({queryKey:["/api/corpus-qa/qa-files"]})},onError:s=>{i({title:"Baseline Failed",description:s.message||"Failed to generate baseline",variant:"destructive"})}}),W=async()=>{if(!a){i({title:"Agent Required",description:"Please select an agent domain first",variant:"destructive"});return}p(!0),o(10);const s=setInterval(()=>{o(d=>Math.min(d+10,90))},2e3);try{await B.mutateAsync({agentDomain:a,maxQuestions:Q,difficulty:F,categories:c.length>0?c:void 0,refreshCorpus:D}),clearInterval(s),o(100)}catch{clearInterval(s)}},I=s=>(s/1024/1024).toFixed(2)+" MB",M=s=>new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return e.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx(oe,{className:"h-8 w-8 text-blue-600"}),e.jsx("h1",{className:"text-3xl font-bold",children:"Corpus Q&A Generator"})]}),e.jsx("p",{className:"text-muted-foreground mb-6",children:"Generate training questions and answers from regulatory corpus data for any agent. This system downloads real regulatory documents and creates high-quality Q&A pairs for training and testing."}),e.jsxs(se,{defaultValue:"generate",className:"space-y-6",children:[e.jsxs(ae,{className:"grid w-full grid-cols-3",children:[e.jsx(N,{value:"generate",children:"Generate Q&A"}),e.jsx(N,{value:"status",children:"Corpus Status"}),e.jsx(N,{value:"files",children:"Generated Files"})]}),e.jsx(y,{value:"generate",className:"space-y-6",children:e.jsxs(C,{children:[e.jsxs(b,{children:[e.jsxs(S,{className:"flex items-center gap-2",children:[e.jsx(U,{className:"h-5 w-5"}),"Generate Q&A from Corpus"]}),e.jsx(z,{children:"Create training questions and answers from regulatory documents"})]}),e.jsxs(w,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"agent-select",children:"Agent Domain"}),e.jsxs(O,{value:a,onValueChange:H,children:[e.jsx(E,{children:e.jsx(J,{placeholder:"Select an agent domain"})}),e.jsx(V,{children:(K=r==null?void 0:r.domains)==null?void 0:K.map(s=>e.jsxs(u,{value:s.domain,children:[s.domain.charAt(0).toUpperCase()+s.domain.slice(1)," Agent"]},s.domain))})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"max-questions",children:"Maximum Questions"}),e.jsx(te,{id:"max-questions",type:"number",min:"1",max:"500",value:Q,onChange:s=>X(Number(s.target.value))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"difficulty",children:"Difficulty Level"}),e.jsxs(O,{value:F,onValueChange:Y,children:[e.jsx(E,{children:e.jsx(J,{})}),e.jsxs(V,{children:[e.jsx(u,{value:"mixed",children:"Mixed Difficulty"}),e.jsx(u,{value:"basic",children:"Basic"}),e.jsx(u,{value:"intermediate",children:"Intermediate"}),e.jsx(u,{value:"advanced",children:"Advanced"})]})]})]})]}),a&&(r==null?void 0:r.domains)&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Categories (optional)"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:(L=r.domains.find(s=>s.domain===a))==null?void 0:L.config.categories.map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx($,{id:s,checked:c.includes(s),onCheckedChange:d=>{G(d?[...c,s]:c.filter(x=>x!==s))}}),e.jsx(n,{htmlFor:s,className:"text-sm",children:s})]},s))})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx($,{id:"refresh-corpus",checked:D,onCheckedChange:s=>_(s)}),e.jsx(n,{htmlFor:"refresh-corpus",children:"Refresh corpus (download latest documents)"})]}),m&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(n,{children:"Generation Progress"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[P,"%"]})]}),e.jsx(ne,{value:P})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(q,{onClick:W,disabled:!a||m||B.isPending,className:"flex items-center gap-2",children:[m?e.jsx(ie,{className:"h-4 w-4 animate-spin"}):e.jsx(ue,{className:"h-4 w-4"}),m?"Generating...":"Generate Q&A"]}),e.jsxs(q,{variant:"outline",onClick:()=>k.mutate({agentDomain:a,maxQuestions:100}),disabled:!a||k.isPending,className:"flex items-center gap-2",children:[e.jsx(re,{className:"h-4 w-4"}),"Generate Baseline"]})]})]})]})}),e.jsx(y,{value:"status",className:"space-y-6",children:a&&t&&e.jsxs(C,{children:[e.jsx(b,{children:e.jsxs(S,{className:"flex items-center gap-2",children:[e.jsx(me,{className:"h-5 w-5"}),"Corpus Status: ",a.charAt(0).toUpperCase()+a.slice(1)]})}),e.jsxs(w,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center p-4 bg-muted rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold",children:t.data.totalDocuments}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Documents"})]}),e.jsxs("div",{className:"text-center p-4 bg-muted rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold",children:t.data.sources.length}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Sources"})]}),e.jsxs("div",{className:"text-center p-4 bg-muted rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold",children:I(t.data.totalSize)}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Size"})]}),e.jsxs("div",{className:"text-center p-4 bg-muted rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold",children:t.data.lastUpdated?M(t.data.lastUpdated):"Never"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Last Updated"})]})]}),t.data.sources.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Available Sources"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:t.data.sources.map(s=>e.jsx(h,{variant:"secondary",children:s},s))})]}),t.data.availableCategories.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Available Categories"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:t.data.availableCategories.map(s=>e.jsx(h,{variant:"outline",children:s},s))})]}),!t.data.hasCorpus&&e.jsxs("div",{className:"flex items-center gap-2 p-4 bg-orange-50 border border-orange-200 rounded-lg",children:[e.jsx(le,{className:"h-5 w-5 text-orange-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-orange-800",children:"No Corpus Available"}),e.jsx("div",{className:"text-sm text-orange-700",children:"Download corpus documents to start generating Q&A pairs."})]}),e.jsxs(q,{variant:"outline",size:"sm",onClick:()=>T.mutate(a),disabled:T.isPending,className:"ml-auto",children:[e.jsx(de,{className:"h-4 w-4 mr-2"}),"Download"]})]})]})]})}),e.jsx(y,{value:"files",className:"space-y-6",children:a&&j&&e.jsxs(C,{children:[e.jsxs(b,{children:[e.jsxs(S,{className:"flex items-center gap-2",children:[e.jsx(U,{className:"h-5 w-5"}),"Generated Q&A Files: ",a.charAt(0).toUpperCase()+a.slice(1)]}),e.jsx(z,{children:"Previously generated question and answer files"})]}),e.jsx(w,{children:j.data.files.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No Q&A files generated yet for this agent."}):e.jsx(ce,{className:"h-96",children:e.jsx("div",{className:"space-y-4",children:j.data.files.map((s,d)=>{var x;return e.jsxs("div",{className:"p-4 border rounded-lg space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"font-medium",children:s.filename}),e.jsxs(h,{variant:"secondary",children:[s.totalQuestions," questions"]})]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Created: ",M(s.created)," â€¢ Size: ",I(s.size)]}),s.metadata&&e.jsx("div",{className:"flex flex-wrap gap-1",children:(x=s.metadata.categoriesCovered)==null?void 0:x.map(R=>e.jsx(h,{variant:"outline",className:"text-xs",children:R},R))})]},d)})})})})]})})]})]})}export{fe as default};
