import{r as o,j as e,aa as v,C as y,a as I,b as E,b$ as w,d as B,f as M,a3 as C,Z as O,I as q,B as W,G as A,K as G}from"./index-B8YngC3q.js";const H=[{name:"CBD Tincture",description:"10mg CBD per ml for therapeutic use",icon:v,query:"Create a CBD tincture formulation with 10mg CBD per ml using MCT oil carrier for sublingual administration"},{name:"THC Gummies",description:"5mg THC edibles with precise dosing",icon:w,query:"Formulate THC gummies with 5mg THC per piece, considering onset time, bioavailability, and taste masking"},{name:"Topical Cream",description:"Pain relief with cannabinoids and terpenes",icon:C,query:"Design a topical cream with CBD, CBG, and anti-inflammatory terpenes for localized pain relief"},{name:"Full Spectrum Oil",description:"Entourage effect formulation",icon:G,query:"Create a full-spectrum cannabis oil maintaining the natural cannabinoid and terpene profile for maximum entourage effect"}];function P(){const[l,m]=o.useState([{id:"1",role:"assistant",content:`Welcome to the **Cannabis Formulation Expert**! I'm your AI specialist for cannabis product development.

I can help you with:
🧪 **Formulation Design** - Create precise cannabis products with optimal cannabinoid profiles
📊 **Dosage Calculations** - Ensure accurate potency and serving sizes  
⚖️ **Compliance Analysis** - Navigate regulations across different states
🏭 **Manufacturing Guidance** - Scale formulations for production
🔬 **Extraction Methods** - Choose optimal techniques for your needs
💰 **Cost Optimization** - Balance quality with economic viability

Ask me anything about cannabis formulation, or try one of the suggestions below!`,timestamp:new Date,artifacts:[]}]),[u,x]=o.useState(""),[c,p]=o.useState(!1),h=o.useRef(null),S=()=>{var s;(s=h.current)==null||s.scrollIntoView({behavior:"smooth"})};o.useEffect(()=>{S()},[l]);const f=async s=>{var t;if(!s.trim()||c)return;const a={id:Date.now().toString(),role:"user",content:s.trim(),timestamp:new Date,artifacts:[]};m(n=>[...n,a]),x(""),p(!0);try{const n=await fetch("/api/agents/route",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:s,conversationHistory:l.slice(-5)})});if(!n.ok)throw new Error("Failed to get response from AI");const r=await n.json();let d=null,g=null;const j=r.response.match(/\[formulation:([^\]]+)\]/i);if(j)try{const i=JSON.parse(j[1]),b=await fetch("/api/formulation/calculate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(b.ok){const N=await b.json();d=N.formulation,g=(t=N.formulation)==null?void 0:t.totals}}catch(i){console.warn("Failed to process formulation data:",i)}const F={id:(Date.now()+1).toString(),role:"assistant",content:r.response,timestamp:new Date,formulation:d,calculations:g,artifacts:r.artifacts||[]};m(i=>[...i,F])}catch(n){console.error("Error sending message:",n);const r={id:(Date.now()+1).toString(),role:"assistant",content:"I apologize, but I encountered an error processing your request. Please try again or rephrase your question.",timestamp:new Date,artifacts:[]};m(d=>[...d,r])}finally{p(!1)}},T=s=>{f(s.query)},D=s=>{s.preventDefault(),f(u)},k=s=>s.split(`
`).map((a,t)=>a.startsWith("**")&&a.endsWith("**")?e.jsx("h4",{className:"font-semibold text-green-700 dark:text-green-400 mt-4 mb-2",children:a.slice(2,-2)},t):a.startsWith("🧪")||a.startsWith("📊")||a.startsWith("⚖️")||a.startsWith("🏭")||a.startsWith("🔬")||a.startsWith("💰")?e.jsx("p",{className:"mb-2 text-sm",children:a},t):a.trim()===""?e.jsx("br",{},t):e.jsx("p",{className:"mb-2",children:a},t));return e.jsxs("div",{className:"flex flex-col h-full max-w-4xl mx-auto",children:[e.jsx("div",{className:"flex-shrink-0 border-b border-border p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-2 bg-green-100 dark:bg-green-900 rounded-lg",children:e.jsx(v,{className:"h-5 w-5 text-green-600 dark:text-green-400"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Cannabis Formulation Expert"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"AI-powered cannabis product development"})]})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[l.map(s=>e.jsx("div",{className:`flex ${s.role==="user"?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`max-w-3xl ${s.role==="user"?"bg-green-600 text-white":"bg-muted"} rounded-lg p-4`,children:[e.jsx("div",{className:"whitespace-pre-wrap",children:typeof s.content=="string"?k(s.content):s.content}),s.calculations&&e.jsxs(y,{className:"mt-4",children:[e.jsx(I,{className:"pb-2",children:e.jsxs(E,{className:"text-sm flex items-center gap-2",children:[e.jsx(w,{className:"h-4 w-4"}),"Formulation Calculations"]})}),e.jsxs(B,{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Total Volume:"}),e.jsxs("span",{className:"font-mono",children:[s.calculations.volume.toFixed(2)," ml"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Total Mass:"}),e.jsxs("span",{className:"font-mono",children:[s.calculations.mass.toFixed(2)," g"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Total Cost:"}),e.jsxs("span",{className:"font-mono font-semibold",children:["$",s.calculations.cost.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Cost per Serving:"}),e.jsxs("span",{className:"font-mono",children:["$",s.calculations.costPerServing.toFixed(2)]})]})]})]}),s.artifacts&&s.artifacts.length>0&&e.jsxs("div",{className:"mt-3 space-y-2",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Generated Documents:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.artifacts.map((a,t)=>e.jsxs(M,{variant:"secondary",className:"text-xs",children:[e.jsx(C,{className:"h-3 w-3 mr-1"}),a]},t))})]}),e.jsx("div",{className:"text-xs text-muted-foreground mt-2 opacity-70",children:s.timestamp.toLocaleTimeString()})]})},s.id)),c&&e.jsx("div",{className:"flex justify-start",children:e.jsx("div",{className:"bg-muted rounded-lg p-4 max-w-3xl",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(O,{className:"h-4 w-4 animate-pulse text-green-600"}),e.jsx("span",{className:"text-sm",children:"Analyzing formulation..."})]})})}),e.jsx("div",{ref:h})]}),l.length===1&&e.jsxs("div",{className:"flex-shrink-0 p-4 border-t border-border",children:[e.jsx("h3",{className:"text-sm font-medium mb-3",children:"Try these formulation examples:"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:H.map((s,a)=>{const t=s.icon;return e.jsx(y,{className:"cursor-pointer hover:bg-accent transition-colors p-3",onClick:()=>T(s),children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 bg-green-100 dark:bg-green-900 rounded-md",children:e.jsx(t,{className:"h-4 w-4 text-green-600 dark:text-green-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-medium text-sm",children:s.name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.description})]})]})},a)})})]}),e.jsx("div",{className:"flex-shrink-0 border-t border-border p-4",children:e.jsxs("form",{onSubmit:D,className:"flex gap-2",children:[e.jsx(q,{value:u,onChange:s=>x(s.target.value),placeholder:"Ask about cannabis formulation, dosage calculations, compliance, or manufacturing...",disabled:c,className:"flex-1"}),e.jsx(W,{type:"submit",disabled:c||!u.trim(),children:e.jsx(A,{className:"h-4 w-4"})})]})})]})}function z(){return e.jsx("div",{className:"min-h-screen bg-background",children:e.jsx("div",{className:"container mx-auto h-screen flex flex-col",children:e.jsx(P,{})})})}export{z as default};
