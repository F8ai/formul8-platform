import{r as S,u as H,t as W,m as P,v,j as e,z as k,T as X,i as Y,k as T,l as R,C as l,a as o,b as m,W as ee,d as c,X as g,Y as se,_ as te,$ as ae,a0 as ie,a1 as re,f as d,E as I,B as x,q as y,n as b,Z as ne,p as z,J as N}from"./index-CDF1r-gK.js";import{A as le,a as ce}from"./alert-BR09JMnk.js";import{G as de}from"./git-branch-BC1FKsKt.js";import{P as oe}from"./play-CAoDg4G6.js";function pe(){var _,L,M,D,E,B;const[a,G]=S.useState(""),[t,f]=S.useState(null),[r,F]=S.useState(null),{toast:i}=H(),O=W(),{data:u}=P({queryKey:["/api/development-agent/repositories"]}),{data:h,isLoading:K}=P({queryKey:["/api/development-agent/issues",a],enabled:!!a}),{data:p,isLoading:J}=P({queryKey:["/api/development-agent/tasks"]}),w=v({mutationFn:async({repository:s,issueNumber:n})=>await N(`/api/development-agent/analyze/${s}/${n}`),onSuccess:s=>{F(s.analysis),i({title:"Analysis Complete",description:"Issue has been analyzed for automation suitability"})},onError:s=>{i({title:"Analysis Failed",description:"Failed to analyze issue",variant:"destructive"})}}),A=v({mutationFn:async({repository:s,issueNumber:n})=>await N("/api/development-agent/process",{method:"POST",body:JSON.stringify({repository:s,issueNumber:n})}),onSuccess:s=>{O.invalidateQueries({queryKey:["/api/development-agent/tasks"]}),i({title:"Development Started",description:"Automated development environment has been created"}),f(null)},onError:s=>{i({title:"Processing Failed",description:"Failed to start automated development",variant:"destructive"})}}),C=v({mutationFn:async({repository:s,issueNumber:n})=>await N("/api/development-agent/agent-opinion",{method:"POST",body:JSON.stringify({repository:s,issueNumber:n})}),onSuccess:s=>{i({title:"Agent Opinion Added",description:"The specialized agent has provided their perspective on this issue"})},onError:s=>{i({title:"Failed to Add Opinion",description:"Could not add agent opinion to the issue",variant:"destructive"})}}),j=v({mutationFn:async({taskId:s,approved:n})=>await N("/api/development-agent/approve",{method:"POST",body:JSON.stringify({taskId:s,approved:n})}),onSuccess:s=>{O.invalidateQueries({queryKey:["/api/development-agent/tasks"]}),i({title:s.success?"Task Approved":"Task Rejected",description:s.message})},onError:s=>{i({title:"Approval Failed",description:"Failed to process approval",variant:"destructive"})}}),Q=()=>{if(!a||!t){i({title:"Missing Information",description:"Please select a repository and an issue",variant:"destructive"});return}console.log("Analyzing issue:",a,t.number),w.mutate({repository:a,issueNumber:t.number})},U=()=>{if(!a||!t){i({title:"Missing Information",description:"Please select a repository and an issue",variant:"destructive"});return}console.log("Processing issue:",a,t.number),A.mutate({repository:a,issueNumber:t.number})},V=()=>{if(!a||!t){i({title:"Missing Information",description:"Please select a repository and an issue",variant:"destructive"});return}console.log("Getting agent opinion for:",a,t.number),C.mutate({repository:a,issueNumber:t.number})},$=s=>{switch(s){case"pending":return e.jsx(z,{className:"h-4 w-4 text-yellow-500"});case"in_progress":return e.jsx(oe,{className:"h-4 w-4 text-blue-500"});case"ready_for_review":return e.jsx(y,{className:"h-4 w-4 text-orange-500"});case"approved":return e.jsx(b,{className:"h-4 w-4 text-green-500"});case"completed":return e.jsx(b,{className:"h-4 w-4 text-green-500"});case"failed":return e.jsx(y,{className:"h-4 w-4 text-red-500"});default:return e.jsx(z,{className:"h-4 w-4 text-gray-500"})}},Z=s=>{switch(s){case"pending":return"bg-yellow-100 text-yellow-800";case"in_progress":return"bg-blue-100 text-blue-800";case"ready_for_review":return"bg-orange-100 text-orange-800";case"approved":return"bg-green-100 text-green-800";case"completed":return"bg-green-100 text-green-800";case"failed":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},q=s=>{switch(s){case"critical":return"bg-red-100 text-red-800";case"high":return"bg-orange-100 text-orange-800";case"medium":return"bg-yellow-100 text-yellow-800";case"low":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}};return e.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(k,{className:"h-8 w-8 text-blue-600"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Development Agent"}),e.jsx("p",{className:"text-gray-600",children:"Automated issue resolution and development environment creation"})]})]}),e.jsxs(X,{defaultValue:"create",className:"w-full",children:[e.jsxs(Y,{className:"grid w-full grid-cols-3",children:[e.jsx(T,{value:"create",children:"Create Task"}),e.jsx(T,{value:"tasks",children:"Active Tasks"}),e.jsx(T,{value:"analytics",children:"Analytics"})]}),e.jsx(R,{value:"create",className:"space-y-6",children:e.jsxs(l,{children:[e.jsx(o,{children:e.jsxs(m,{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"h-5 w-5"}),"Automated Issue Resolution"]})}),e.jsxs(c,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("div",{children:[e.jsx(g,{htmlFor:"repository",children:"Repository"}),e.jsxs(se,{value:a,onValueChange:s=>{G(s),f(null),F(null)},children:[e.jsx(te,{children:e.jsx(ae,{placeholder:"Select repository"})}),e.jsx(ie,{children:(_=u==null?void 0:u.repositories)==null?void 0:_.map(s=>e.jsx(re,{value:s,children:s},s))})]})]}),a&&e.jsxs("div",{children:[e.jsx(g,{htmlFor:"issue",children:"Available Issues"}),K?e.jsxs("div",{className:"text-center py-4",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),e.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Loading issues..."})]}):((L=h==null?void 0:h.issues)==null?void 0:L.length)===0?e.jsx("div",{className:"text-center py-4",children:e.jsx("p",{className:"text-gray-600",children:"No open issues found"})}):e.jsx("div",{className:"max-h-96 overflow-y-auto border rounded-md",children:(M=h==null?void 0:h.issues)==null?void 0:M.map(s=>e.jsx("div",{className:`p-4 border-b last:border-b-0 cursor-pointer hover:bg-gray-50 ${(t==null?void 0:t.id)===s.id?"bg-blue-50 border-blue-200":""}`,onClick:()=>f(s),children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsxs("h4",{className:"font-medium text-sm",children:["#",s.number]}),e.jsx(d,{className:s.suitable?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800",children:s.suitable?"Suitable":"Manual"}),e.jsx(d,{className:q(s.priority),children:s.priority}),e.jsx("a",{href:s.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 ml-2",onClick:n=>n.stopPropagation(),children:e.jsx(I,{className:"h-4 w-4"})})]}),e.jsx("p",{className:"text-sm font-medium text-gray-900 mb-1",children:s.title}),s.body&&e.jsx("p",{className:"text-xs text-gray-600 mb-2 line-clamp-3",children:s.body}),e.jsxs("div",{className:"flex items-center gap-3 text-xs text-gray-500",children:[e.jsxs("span",{children:[s.effort,"h effort"]}),e.jsx("span",{children:new Date(s.createdAt).toLocaleDateString()}),s.comments>0&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("i",{className:"fas fa-comment"}),s.comments]}),s.assignee&&e.jsxs("span",{children:["@",s.assignee]})]})]})})},s.id))})]})]}),t&&e.jsxs("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-md",children:[e.jsx("p",{className:"text-sm font-medium text-blue-900",children:"Selected Issue:"}),e.jsxs("p",{className:"text-sm text-blue-700",children:["#",t.number," - ",t.title]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(x,{onClick:Q,disabled:w.isPending||!a||!t,variant:"outline",children:w.isPending?"Analyzing...":"Analyze Issue"}),e.jsxs(x,{onClick:V,disabled:C.isPending||!a||!t,variant:"outline",children:[e.jsx(k,{className:"h-4 w-4 mr-2"}),C.isPending?"Getting Opinion...":"Get Agent Opinion"]}),e.jsx(x,{onClick:U,disabled:A.isPending||!a||!t,children:A.isPending?"Processing...":"Start Development"})]}),r&&e.jsxs(l,{className:"mt-4",children:[e.jsx(o,{children:e.jsx(m,{className:"text-lg",children:"Issue Analysis"})}),e.jsxs(c,{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{className:r.suitable?"bg-green-100 text-green-800":"bg-red-100 text-red-800",children:r.suitable?"Suitable for Automation":"Not Suitable"}),e.jsxs(d,{className:q(r.priority),children:[r.priority," priority"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(g,{className:"text-sm font-medium",children:"Estimated Effort"}),e.jsxs("p",{className:"text-sm text-gray-600",children:[r.effort," hours"]})]}),e.jsxs("div",{children:[e.jsx(g,{className:"text-sm font-medium",children:"Approach"}),e.jsx("p",{className:"text-sm text-gray-600",children:r.approach})]})]}),e.jsxs("div",{children:[e.jsx(g,{className:"text-sm font-medium",children:"Components"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:r.components.map(s=>e.jsx(d,{variant:"secondary",children:s},s))})]}),e.jsxs("div",{children:[e.jsx(g,{className:"text-sm font-medium",children:"Testing Requirements"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:r.testing.map(s=>e.jsx(d,{variant:"outline",children:s},s))})]}),!r.suitable&&e.jsxs(le,{children:[e.jsx(y,{className:"h-4 w-4"}),e.jsx(ce,{children:"This issue may require human creativity, complex decision-making, or has high complexity. Manual development is recommended."})]})]})]})]})]})}),e.jsx(R,{value:"tasks",className:"space-y-6",children:e.jsxs(l,{children:[e.jsx(o,{children:e.jsx(m,{children:"Development Tasks"})}),e.jsx(c,{children:J?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Loading tasks..."})]}):((D=p==null?void 0:p.tasks)==null?void 0:D.length)===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(k,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"No development tasks yet"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Create your first automated development task above"})]}):e.jsx("div",{className:"space-y-4",children:(E=p==null?void 0:p.tasks)==null?void 0:E.map(s=>e.jsx(l,{children:e.jsx(c,{className:"pt-6",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsxs("h3",{className:"font-semibold",children:[s.repository," #",s.issueNumber]}),e.jsxs(d,{className:Z(s.status),children:[$(s.status),s.status]})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600 mb-3",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(de,{className:"h-4 w-4"}),s.branch]}),e.jsxs("div",{children:["Created: ",new Date(s.createdAt).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex gap-2",children:[s.replitUrl&&e.jsxs(x,{size:"sm",variant:"outline",onClick:()=>window.open(s.replitUrl,"_blank"),children:[e.jsx(I,{className:"h-4 w-4 mr-1"}),"Open in Replit"]}),s.pullRequestUrl&&e.jsxs(x,{size:"sm",variant:"outline",onClick:()=>window.open(s.pullRequestUrl,"_blank"),children:[e.jsx(I,{className:"h-4 w-4 mr-1"}),"View PR"]}),s.status==="ready_for_review"&&e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(x,{size:"sm",onClick:()=>j.mutate({taskId:s.id,approved:!0}),disabled:j.isPending,children:[e.jsx(b,{className:"h-4 w-4 mr-1"}),"Approve & Merge"]}),e.jsxs(x,{size:"sm",variant:"destructive",onClick:()=>j.mutate({taskId:s.id,approved:!1}),disabled:j.isPending,children:[e.jsx(y,{className:"h-4 w-4 mr-1"}),"Reject"]})]})]})]})})})},s.id))})})]})}),e.jsxs(R,{value:"analytics",className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs(l,{children:[e.jsx(o,{children:e.jsxs(m,{className:"flex items-center gap-2",children:[e.jsx(ne,{className:"h-5 w-5"}),"Automation Rate"]})}),e.jsxs(c,{children:[e.jsx("div",{className:"text-2xl font-bold",children:"73%"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Issues suitable for automation"})]})]}),e.jsxs(l,{children:[e.jsx(o,{children:e.jsxs(m,{className:"flex items-center gap-2",children:[e.jsx(z,{className:"h-5 w-5"}),"Avg. Resolution Time"]})}),e.jsxs(c,{children:[e.jsx("div",{className:"text-2xl font-bold",children:"4.2h"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Average time to resolve"})]})]}),e.jsxs(l,{children:[e.jsx(o,{children:e.jsxs(m,{className:"flex items-center gap-2",children:[e.jsx(b,{className:"h-5 w-5"}),"Success Rate"]})}),e.jsxs(c,{children:[e.jsx("div",{className:"text-2xl font-bold",children:"89%"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Successful automated resolutions"})]})]})]}),e.jsxs(l,{children:[e.jsx(o,{children:e.jsx(m,{children:"Repository Performance"})}),e.jsx(c,{children:e.jsx("div",{className:"space-y-4",children:(B=u==null?void 0:u.repositories)==null?void 0:B.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:s}),e.jsx("p",{className:"text-sm text-gray-600",children:"3 issues automated this week"})]}),e.jsx(d,{variant:"outline",children:"Active"})]},s))})})]})]})]})]})}export{pe as default};
